--- 
title: "データサイエンスをはじめましょう   \n- Data Science for All -"
author: "鈴木寛（Hirosi Suzuki）"
date: "2023-08-08"
site: bookdown::bookdown_site
documentclass: bxjsbook #or bxjsreport
classoption: xelatex, ja=standard
bibliography: [book.bib, packages.bib]
url: https://icu-hsuzuki.github.io/ds4aj/
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  This is a lecture note using the bookdown package to write a book in Japanese.
  The HTML output format for this example is bookdown::bs4_book,
  set in the _output.yml file.
biblio-style: apalike
csl: chicago-fullnote-bibliography.csl
biblio-title: "参考文献"
---


# この文書について  {-} 



データサイエンスを始めてみませんか。

データサイエンスは、広い意味をもったことばで、一口に、学び始めると言っても、さまざまな始め方があると思います。本書では、そのひとつを提案するとともに、共に学んでいきたいと願って、書き始めました。

いろいろな方々や、利用方法を想定して、導入のような内容や、本書の中心をなす、R でのプログラミングを利用しなくても、ダッシュボードなどを利用することにより、データをさまざまな角度から見る経験をすること、スクリプトや、テンプレートを使って、一部を置き換えることで、データサイエンスを経験すること、基本的な R でのプログラミングを学んで、自分で、簡単なプログラムを書いて、分析をすること、さらに、こんなときは、どうしたら良いかなど、少し詳しい説明などを含んだ部分などです。

また、順次、例を提供する、ブログのようなものも書いていきたいと思います。この書を利用するために「データサイエンスを教えてみませんか」と、教える方のサポートも、書いていく予定です。

みなさんも一緒にデータサイエンスを学んでみませんか。

## 著者について {-}

著者は、大学の学生の時以来、数学を学び、大学で教え、2019年春に退職。それ以来、少しずつ、データサイエンスを学んでいます。

幸運にも、2019年9月の日本数学会教育委員会主催教育シンポジウムで、「文理共通して行う数理・データサイエンス教育」という題で、話す機会が与えられ、その後、あることが契機となり、2020年度から、毎年、冬学期（12月から2月）に、大学院一般向け（分野の指定なし）の授業、「研究者のためのデータ分析（Data Analysis for Researchers）」を担当しています。複数の教員で担当しますが、基本的な部分は、わたしが教え、応用について、他の先生がおしえています。受講生は20人程度で、殆どが、外国人。それも、多国籍で、多くても一国から三人程度。英語で教えています。

この授業の関係で親しくなった経済学の先生に依頼されて、いくつかのレベルの経済学の授業で、２・３時限、世界銀行の世界開発指標などを使った分析の入門を、特別講師として教えさせていただきました。このコースは日本語で教えました。

2023年3月に京都大学数理解析研究所で開かれた数学教育の会で、話す機会が与えられ、大学などで全学生向けに提供する「数理・データサイエンス・AI」について講演し、生成系AIの進化も踏まえて、どのようなことを学ぶ機会とすれば良いかについても、考えました。

「データサイエンスをはじめましょう」も、このような背景の下で書かれたものです。

コースで利用したものや、講演記録ににご興味のある方は、このページの下にもリンクがある、著者の[ホームページ](https://icu-hsuzuki.github.io/science/computer/learning/ds.html)を参照してください。

## コンピュータ言語について {-}

データサイエンスには、コンピュータを使います。コンピュータに指示をして、データを使いやすく変形したり、計算をしてもらったり、グラフを書いてもらったりします。そのためにコンピュータとのやりとりをする言語が必要です。さまざまな言語（プログラミング言語とも言います）が、使われますが、一番、使われているのは、Python と、R です。

「データサイエンスをはじめましょう」では、統計解析のために開発された R を使います。いずれは、python についても触れたいと思いますが、プログラミングの経験がない方も含めて、最初にデータサイエンスを学ぶには、R は最適だと考えています。特に、R Studio IDE（integrated development environment, 統合開発環境） で、R を簡単に使うことができます。さらに、簡単なものであれば、Posit Cloud で試したり、共有することも可能です。また、再現性（Reproducibility）や、なにを実行しているのかの説明を同時に記述すること（Literate Programming）は、非常に重要ですが、その記述も、R Markdown によって、可能になっています。これが、Excel や、Google Spread Sheet ではなく、R を推奨する理由でもあります。
この文書も、R Markdown の一つの形式の、bookdown を利用しています。最後に、Bookdown に関連して、膨大な数の、参考書も、無償で提供されており、オンラインで読むことができることも、R をお薦めする理由です。

ただし、日本語のものは、まだ十分とは言えない状況です。この文書を書き始めたのも、すこしでも、お役に立つことができればとの、気持ちが背景にあります。

もう一つ付け加えると、高校の教科書でも、一部、Python のスクリプトが使われ、大学で、全学生向けに、データサイエンスのコースを提供するときにも、Excel を使うか、Python を使うかが R と比較するとより一般的のように見えます。しかし、それは、教える側の都合が影響しているのではないでしょうか。急いでコースを提供するため、身近な Excel から始めることにしたり、データサイエンスなら、情報科学の教員がコースをデザインせざるを得ないことから、汎用性の高く、かつデータサイエンスでも、中心的な役割を果たす Python を選択すると言ったことです。

しかし、すべての人が、データサイエンスを学ぶ必要があるならば、文系の先生、そして、純粋数学を生業としてきたわたしのようなものも含めて、教えることに関わることは、とても大切だと思います。R は、社会科学系の分野で、最近特に使われています。分野ごとには、SPSS や、Stata や、MATLAB などが使われいるかもしれませんが、これらは、有償で、大学では、使えたとしても、一般の学生が卒業後も、これらのソフトを使えることは稀です。また、研究においても、最近は、さまざまな分野で、R がより一般的になっているとも聞きます。

百聞は一見にしかずで、例を見ていただくのがよいと思いますが、R では、非常に短い命令で、対話型で、すぐ結果が得られます。テンプレートを使って、一部だけ書き換えて使うことも可能で、その人のレベルにあった利用が可能だと思います。さらに、Shiny のような、ダッシュボード形式のものも、利用可能ですし、learnr のように、対話型の、練習問題を提供することも可能です。

少しずつ紹介していきたいと思います。

## 言語について {-}

ご覧の通り、本書は、日本語で書かれています。用語は、英語、あるいは、英語を追記、または、英語をカタカナにしただけのものを使用する可能性が大きいですが、説明は、極力、日本語で書いていく予定です。

しかし、基本的に、コード（プログラムの記述）には、日本語を使わないで書いていく予定です。とくに、初心者にとっては、日本語を含むコードの扱いは、負担になることが多いからです。最近は、コードの中で日本語を使用しても、ほとんど、問題は起きないように思います。そうであっても、世界の人の共通言語として、プログラム言語を学んでいくときには、日本語を使わないことは意義があると思います。世界中の人たちから、アイディアを学び、あるときは協力し、例を提供して、作業をしていくことが可能だからです。

少し慣れてきて、日本語のデータなどを扱うときには、コードにも日本語を使う必要ができていますから、日本語の利用についても、追って説明していきます。APPENDIX \@ref(japanese) を参照してください。

最初は、みなさんも、変数（variable）や、オブジェクト（object）に名前をつけるときは、半角英数を使い、日本語は、使わないようにすることをお勧めします。

## PDF、ePub 版について {-}

実は、PDF 版と、ePub 版も作成しています。しかし、扱いが異なるので、ある程度完成するまでは、ほとんど更新しない予定です。いずれ、これらも、更新したものを公開できると良いのですが。試験公開版は、下のリンクにあります。

* [PDF 版](https://icu-hsuzuki.github.io/ds4aj/ds4aj.pdf)
* [ePub 版](https://icu-hsuzuki.github.io/ds4aj/ds4aj.epub)

## 参考 {-}

この電子書籍以外にも、データ・サイエンスについて幾つかの文書をインターネット上に公開しています。わたしのホームページにリストしてありますので、ご興味のあるかたは、参考にしてください。

* [データサイエンスを学びませんか・データサイエンス教育](https://icu-hsuzuki.github.io/science/computer/learning/ds.html)

<!--chapter:end:index.Rmd-->

# はじめに {#introduction}



## データサイエンスとは

データサイエンスとはどのようなものでしょうか。いくつかの定義を紹介しますが、新しい分野し、非常に広い範囲の人たちが、データサイエンスに関係していることから、明確に定義することは、難しいように思います。

簡単に表現すると「データを活用するための科学」かなと、わたしは、考えています。皆さんが、これから、データサイエンスを学びながら、自分だったらどのように表現するか、考えてください。

「データを活用するための科学」には、三つのことばが含まれています。「データ」「活用するため」「科学」。一つ一つ、厳密な定義は難しいですが、データは、これから、皆さんがたくさん出会いますので、それまで置いておきましょう。「活用するため」と書きましたが、課題をみつけたり、その解決のための意思決定の根拠をさがしたりということでしょうか。分野は、さまざまですから、表現もまちまちかもしれません。最後に「科学」これも、簡単ではありませんが、わたしは、二つのことが大切だと考えています。一つは、反証可能性（falsifiability）、もう一つは再現可能性（reproducibility）です。反証可能性は、自分はそう信じるというような主観ではなく、正しいかどうかチェックすることができるという意味です。再現可能性は大体理解できると思いますが、データから得られる事実を、他のひとが操作をしても、同じ結果が得られるということです。そのためには、その「操作」が明確になっており、合理性も確保されていなければいけませんね。

これら二つの性質は、「活用するため」に、共通の客観的な基盤を保証するということだと思います。データサイエンスは、根拠を明確にした議論（evidence based, fact based）のために、欠かせないことで、多様な価値観の多様なひとたちが合意して課題に立ち向かっていくためには、必要不可欠なことだと思います。そのいみでも、これから、データサイエンスは、ますます、重要度がましていくと思います。

もう少し、踏み込んで、データサイエンスについて書いてみましょう。実際に、どのような作業が重視されているのかも、含まれています。

> Data Science: データ (Data) を活用して課題を発見・探求し、適切な解決策を探る意思決定のための科学（Decision Science）で、 エンピリカル（Empirical Study）すなわち、理論ではなく、実証性を特徴とする。 データから得られる特徴を表示するとともに、数理モデルを適用し・機械学習などで評価し・アルゴリズムを策定する数理的思考を通して得られた結果を、可視化などによってコミュニケーションをおこない、共有し、他者の意見を聞き理解する努力をしながら、さらに課題について、あらたにデータを活用して考え、検証し、適切な解決策がもたらす新たな課題も予測しながら、調整をはかる。

上に書いたのは、ひとつの表現ですが、AI^[どんどん進化していますから、答えを得た日付も加えておきます。一般的なことがらについてまとめて答えてくれるので、その意味で便利です。] にも表題の「データサイエンスとは」と聞いてみると、次のような答えをしてくれました。

**ChatGPT (2023.6.3)** 

> データサイエンス（Data Science）は、データを解析し、洞察を得るための科学的な手法やツールの開発と応用を含む、多様なスキルセットを組み合わせた領域です。データサイエンスは、統計学、機械学習、データマイニング、データ可視化などの技術や手法を利用して、大量のデータからパターンやトレンドを抽出し、意思決定に役立つ洞察を導き出すことを目指します。  
> 
> データサイエンスのプロセスは、データの収集、前処理、分析、モデリング、評価、展開などのステップで構成されます。最初に、関連するデータを収集し、必要な形式に整理するために前処理を行います。次に、統計的な手法や機械学習アルゴリズムを使用してデータを分析し、予測モデルやパターンを発見します。モデルのパフォーマンスを評価し、必要に応じて改善を行い、最終的に洞察をビジネスや科学の現場に適用することが目標です。  
> 
> データサイエンスは、さまざまな分野で活用されています。例えば、ビジネス分野では、マーケティングキャンペーンの最適化、顧客セグメンテーション、需要予測などに利用されます。医療分野では、病気の診断や治療計画の最適化、新薬の開発などに応用されます。また、交通や都市計画、環境保護、金融など、さまざまな領域でデータサイエンスの手法が活用されています。  
> 
> データサイエンスには、数学や統計学、プログラミング、データベース管理、機械学習、ビジュアル化などの幅広いスキルが必要です。また、データの解釈やビジネス理解、コミュニケーション能力も重要な要素です。データサイエンティストやデータアナリストは、これらのスキルを駆使して、データを活用し、意思決定のサポートや新たな知見の発見に貢献します。

ちょっと日本語がぎこちない感じもするので、英語での問いと答えも書いておきましょう。

**What is datascience?**

> Data science is a multidisciplinary field that involves using scientific methods and tools to analyze data and extract insights. It encompasses a wide range of skills, including statistics, machine learning, data mining, and data visualization, to explore and understand complex data sets.
>
> At its core, data science involves collecting, organizing, cleaning, and processing large volumes of data to uncover patterns, trends, and correlations. It applies various statistical techniques and algorithms to gain meaningful insights and make informed decisions. Data scientists employ exploratory data analysis, hypothesis testing, and predictive modeling to extract valuable information from data and generate actionable recommendations.
> 
> Data science finds applications in numerous industries and domains. It is widely used in business for market research, customer segmentation, demand forecasting, and personalized recommendations. In healthcare, data science aids in disease diagnosis, treatment optimization, and drug discovery. Other areas where data science is applied include transportation and urban planning, environmental conservation, finance, and social sciences.
> 
> To excel in data science, one needs a solid foundation in mathematics, statistics, programming, and data manipulation. Proficiency in programming languages such as Python or R is crucial for data manipulation and building models. Strong analytical skills, critical thinking, and the ability to communicate findings effectively are also essential for data scientists.
> 
> Data science is a rapidly evolving field, driven by advancements in technology and the increasing availability of data. It plays a crucial role in leveraging data assets to gain insights and make data-driven decisions in various industries.

学際的分野（multidisciplinary field）という言葉も使われています。かなりの広がりをもった分野です。

### なぜ、データサイエンスが最近注目されているのか

では、なぜ、最近、急に、データサイエンスが注目されるようになったのでしょうか。最初にも少し書きましたし、みなさんが、少しずつ学びながら、考えていただくのが一番よいと思いますが、いくつか理由があると思います。

個人的には、インターネットの普及や、さまざまなセンサーの普及にも助けられて、膨大なデータが得られるようになり、さらに、コンピュータの進化により、大きなデータであっても、それらを、扱うことができるようになったこと。それによって、複雑な問題であっても、その解決と意思決定に関して、データを使って根拠を明確にした（evidence based）議論を支援することが可能になったことだと考えています。

付け加えておかないといけないと考えていることがもう一つあります。それは、問題解決と書きましたが、課題と向き合うという表現でもよいと思います。これまでは、因果関係が単純な課題については、根拠をしめして、ある程度議論できましたが、実際の世の中の問題は、非常に多くの要素が相互に絡み合っており、それらを、調整すると、結果にも、さまざまな変化が生じるため、調整も非常に困難だと言うことも挙げられると思います。

それだけ複雑な課題と向き合うには、データを丁寧にみることがが必要で、その中で、さまざまな指標に関して評価値が高いものを選択することが可能になって来たと言うことです。

そのことが、もう一歩進んで、AI（Artificial Intelligence 人工知能）を支える技術に使われています。ここで使った、ChatGPT の GPT は、Generative Pre-trained Transformer の略ですが、LLM（Large Language Model）によって、自然なことばを生成できるような技術が実用段階に入っています。たとえば、「データサイエンスが最近注目されているのは...」とすると、この後に続く言葉として、評価値が高いものを、選択してれる。それを、さらに、調整して、応答とすることが可能になっているのです。

少し長いですが、もう少し、踏み込んで説明していますので、ChatGPT の応答を下に挙げておきましょう。

**ChatGPT (2023.6.3)** 

> データサイエンスが最近注目されている理由は、以下の要素によるものです。
> 
> 1. ビッグデータの増加: 近年、デジタル技術の進歩により、膨大な量のデータが生成されるようになりました。ウェブサイトのアクセスログ、ソーシャルメディアの投稿、センサーデータ、トランザクションデータなど、多様なソースから大量のデータが利用可能です。データサイエンスは、これらのビッグデータを活用して洞察を得ることができるため、需要が高まっています。
> 
> 2. 技術の進歩: データサイエンスを支える技術の進歩も、その注目を高めています。クラウドコンピューティングの発展やオープンソースのツールとライブラリの普及により、データの収集、処理、分析が容易になりました。さらに、機械学習や深層学習のアルゴリズムの改善や高速化も進んでおり、より高度な予測モデルやパターンの抽出が可能になっています。
> 
> 3. ビジネス価値の認識: データは企業にとって貴重な資産であり、データを活用することで競争優位を得ることができます。データサイエンスを活用することで、マーケットのニーズやトレンドを理解し、効果的なマーケティング戦略を立てることができます。顧客行動の予測やセグメンテーションを行い、顧客満足度や収益性を向上させることも可能です。
> 
> 4. 知識と人材の需要: データサイエンスの分野での知識とスキルを持つ人材への需要が高まっています。企業や組織は、データサイエンスの専門家を雇用して、データの分析と活用を行いたいと考えています。また、データサイエンスは学問としても注目を浴びており、大学や研究機関ではデータサイエンスに関連するプログラムや研究が増えています。
> 
> これらの要素により、データサイエンスはビジネスや科学の分野で重要な役割を果たしており、その注目度が高まっています。以下に、その具体的な理由をいくつか挙げます。
> 
> 5. 創新と競争力の追求: データサイエンスは新たなビジネスモデルや製品の開発に貢献します。データを活用して市場のトレンドや消費者のニーズを洞察し、それに基づいて新しいサービスや製品を開発することが可能です。企業はデータを駆使して競争力を高め、革新的なソリューションを提供することを求めています。
> 
> 6. 問題解決と意思決定の支援: データサイエンスは複雑な問題を解決し、意思決定をサポートする上で重要なツールとなっています。データの分析により、事実に基づいた洞察が得られ、ビジネス上の課題や機会を特定することができます。データサイエンスの手法はリスク評価や予測、最適化などにも応用され、効果的な戦略立案や意思決定を支援します。
> 
> 7. パーソナライズされた体験の提供: データサイエンスは顧客の行動や好みを理解し、パーソナライズされた体験を提供するための手段としても利用されます。顧客データや行動履歴を分析し、個別のニーズや関心に基づいたオファーや推奨を行うことで、顧客満足度や忠誠度を向上させることができます。
> 
> 8. 社会的なインパクトと公共政策への応用: データサイエンスは社会的な課題や公共政策の分析にも役立ちます。例えば、交通渋滞の予測や都市計画の最適化、犯罪予測や防犯対策の強化などにデータサイエンスが活用されています。データ駆動のアプローチは社会のさまざまな側面において効果的な解決策を提供する可能性があります。
> 
> これらの要素により、データサイエンスはビジネスや科学の分野で重要な役割を果たしており、その注目度が高まっています。以下に、その具体的な理由をいくつか挙げます。
> 
> 1. 自動化と効率化の追求: データサイエンスは、業務プロセスの自動化や効率化にも貢献します。データの分析と予測モデルの活用により、タスクの自動化や最適なリソースの割り当てが可能となります。これにより、人的な作業負荷を軽減し、生産性を向上させることができます。
> 
> 2. 組織内のデータ文化の普及: データサイエンスの注目度の高まりに伴い、企業や組織においてデータ文化の重要性が認識されています。データサイエンスの手法やアプローチを組織全体で活用し、データに基づいた意思決定や問題解決を行うことが求められています。組織内でのデータの収集、管理、分析の能力向上に取り組むことで、競争力を高めることができます。
> 
> 3. 専門化と職業の多様化: データサイエンスの注目度の高まりに伴い、関連する職業や専門化も増えています。データサイエンティスト、データアナリスト、機械学習エンジニアなどの役割が求められるようになりました。また、データサイエンスを支えるツールやプラットフォームの開発も進んでおり、それに関連する職業やスキルも増加しています。
> 
> 総じて、データサイエンスの注目度が高まっている理由は、データの増加、技術の進歩、ビジネス価値の認識、創新と競争力の追求、問題解決と意思決定の支援、パーソナライズされた体験の提供、社会的なインパクトと公共政策への応用、自動化と効率化の追求、組織内のデータ文化の普及、専門化と職業の多様化など、さまざまな要素が重なっています。
> 
> データサイエンスは、ビジネスや科学の領域でデータの価値を最大限に引き出すための力強いツールとなっており、今後もその重要性と注目度は高まっていくことが予想されます。

### なぜ、一人ひとりが、データサイエンスを、学ぶ必要があるのでしょうか

専門家に任せてはいけないのでしょうか。

個人的には、次のように考えています。非常に広い範囲の課題に関係している課題に、データサイエンスが使われるだけではなく、その背後にある、単純な、因果関係ではない、考え方を、理解する必要があることが挙げられると思います。

さらに、わたしが特に大切だと考えているのは、個人のコンピュータでも、十分に利用可能であること、パブリックデータとか、オープンデータと言われる、誰でも利用できるデータが、使いやすい形で、提供されていると言うことです。

**ChatGPT (2023.6.3)** 

> 一人ひとりがデータサイエンスを学ぶ必要がある理由は、以下のような点が挙げられます。
> 
> 1. データリテラシーの重要性: データは現代社会においてますます重要な役割を果たしています。データに基づく意思決定や問題解決は、個人の日常生活から組織や社会の活動まで広がっています。データサイエンスを学ぶことで、データを扱うスキルや知識を身につけることができます。データを理解し、適切に分析して活用する能力は、個人の能力向上や自己啓発にも繋がります。
> 
> 2. 個人の成長とキャリアの展望: データサイエンスは求人市場で高い需要があり、競争力のあるキャリアの一つとなっています。データサイエンスのスキルを持つことで、自身のキャリアの成長や就業機会の拡大が期待できます。データサイエンスの知識やスキルは、さまざまな職業や業界で役立つだけでなく、起業や独立の道も開ける可能性があります。
> 
> 3. 自己啓発と問題解決能力の向上: データサイエンスは、問題解決や意思決定において非常に有用なツールです。データサイエンスを学ぶことで、情報を分析し洞察を得る力や、パターンを見つける力、予測や最適化の能力を養うことができます。これにより、個人の問題解決能力や意思決定力が向上し、より効果的な選択や行動ができるようになります。
> 
> 専門家に任せることも重要ですが、一人ひとりがデータサイエンスの基本的な概念や手法を理解することは有益です。以下にその理由を説明します。
> 
> 4. データの信頼性と誤解の回避: データは私たちの日常生活やビジネスの意思決定に影響を与える重要な要素です。しかし、データの解釈や分析方法によっては誤解を招くこともあります。データサイエンスの知識を持つことで、データの信頼性を評価し、適切な解釈を行う能力が向上します。これにより、誤った結論や誤解に基づく意思決定を避けることができます。
> 
> 5. 自己管理とデータプライバシーの保護: 近年、個人のデータの重要性とプライバシーの問題が注目されています。データサイエンスを学ぶことで、自身のデータの管理方法やプライバシーの保護について理解し、適切な対策を取ることができます。データの収集や利用に対して主体的に関与し、自己管理の意識を持つことが重要です。
> 
> 6. クリティカルシンキングと問題解決能力の向上: データサイエンスの学習は、クリティカルシンキングや問題解決能力を向上させる助けとなります。データを扱い、分析するためには、情報を適切に評価し、論理的に考える必要があります。データサイエンスの学習は、証拠に基づく意思決定や論理的な議論のスキルを磨くのに役立ちます。
> 
> データサイエンスの専門家に相談することは重要ですが、一人ひとりが基本的なデータサイエンスの知識やスキルを身につけることで、自己啓発や問題解決能力の向上、データの信頼性の評価、プライバシーの保護などが可能となります。データサイエンスの学習は、個人の成長やキャリアの展望にもプラスの影響を与えることが期待されます。

### AI の活用

「データサイエンスをはじめましょう」では、AI も活用していきたいと思います。クリティカルシンキングのことも、書かれていますが、どうしても、人は、バイアスのかかった考えかたをしてしまいます。それは、経験も知識も限られていますし、単純な答えを受け入れたい傾向^[私はこれを、単純化バイアスと呼んでいます。遺伝子に組み込まれているのかもしれません。しかし、それに抗うのも、人間としてのたいせつな生き方のように思います。]ということもあるかもしれません。

そのために、まず、仲間に聞いてみる。そして、AI に聞いてみる。それらを踏まえて、さらに、課題や、問いを精緻なものにしていく。それが、まず、第一に大切だと考えるからです。

さらに、最近のAI は、人間の普通の言葉を理解して、コード（コンピュータに伝える言葉）を書くこともできるようになっています。そのような支援を有効に使うことで、プログラミングの訓練を受けていない人でも、データサイエンスを学ぶことができるようになって来ています。

翻訳にも活用することが可能で、長い文章の要約もかなり上手にしてくれるようになっています。

AI はまだ、発展途上で、ここに書いたことも、少し経つと、古くなってしまうことでしょう。しかし、少し長いスパンで考えると、AI 研究の目標値として、掲げられているのは、AGI (Artificial General Intelligence)、汎用人工知能。（人間が実現可能な）あらゆる知的作業を理解・学習・実行することができる人工知能ということです。しかし、課題も多くあります。課題について、AI に聞いてみると次のような回答をしてくれました。

**Q. 現在の General Artificial Intelligence の 課題をまとめてください。**

**GPT4**

現在の一般人工知能（General Artificial Intelligence, AGI）には、以下のような主要な課題があります。

1. 理解と推論の限界: 現在のAIは、人間のように世界を理解したり、複雑な推論を行う能力をまだ持っていません。これは、言語理解、感情理解、一般的な常識理解など、多くの問題領域に影響を与えます。

2. 教育データのバイアス: AIは学習データからパターンを学びますが、そのデータが偏っている場合、AIも偏った結果を出す可能性があります。これは、AIが人間の先入観や社会的な偏見を反映する可能性を示しています。

3. 説明可能性と透明性の欠如: AIの決定過程はしばしば「ブラックボックス」とされ、その理由は明らかにされていません。これは、AIの決定がなぜ行われたのか、どのような情報に基づいて行われたのかを理解するのを難しくしています。

4. 安全性とエチカルな問題: AIが自己学習や自己改良を行う能力が増すにつれて、その結果が予測不可能になる可能性があります。また、AIが人間の倫理観や法律を理解し、それに従うようにすることも大きな課題です。

5. リソースの要求: 大規模なAIモデルの訓練は、大量の計算リソースと電力を必要とします。これは環境に対する影響や、AI開発の費用効率に関わる問題です。

(2023.8.8)

たしかに、どれも、難しそうな課題ですね。みなさんは、これから、どのように、AI を活用し、どのように、向き合われるのでしょうか。

## 「データサイエンスを始めましょう」の特徴

### 学習者として想定しているのは

高等学校を卒業したひとたちを対象と想定して、書いていこうと思います。

### オープン・パブリックデータの活用

データサイエンスは、広い分野ですが、ここでは、オープンデータとか、パブリックデータと言われるものを主として活用していきます。

すでに、書いたように、それが可能になって来たこと。特に、世界に目をむけると、すばらしいサイトがたくさんあり、国際機関などが、膨大なデータを提供しているので、まずは、それを活用したいと思います。

### 世界のデータをみること

日本のデータも、使っていこうと思いますが、まずは、世界の中の課題をみることが必要だと思っています。扱いやすい、世界のデータがたくさんあるからも理由の一つです。

むろん、日本の課題から目を逸らすわけではありません。世界の中の日本を意識し、さらに、日本の課題にも目を向けていきたいと思います。

### 目標としていること

ここで扱う内容は限られていますが、データサイエンスの基本を身につけることで、ここで、取り上げる、オープンデータ、パブリックデータだけでなく、さまざまな課題にデータを通して、向き合うことができると考えています。

ここまで学べばというゴールはありません。日常的に、データを通して、課題に向き合う習慣が身についていければと願っています。

## 学習方法について

インターネット上で公開していますので、さまざまな方法で学んでいっていただきたいと思います。個人で学ぶことも可能で、実際に、それが可能なように、書いていく予定です。

しかし、おすすめは、何人かのグループ、または、大学などで一緒に学んでいくことです。それは、データサイエンスの目的でもある、問いを持ち、課題に取り組んでいくためには、さまざまな視点からの意見や、考え方が必要だからです。違って見方をたいせつにする訓練にもなります。

ひとつのグラフから、それぞれが違うことを発見することも多くあります。それを経験しながら、共に考えていく経験が貴重だと思うからです。

さらに、データの背景にあることを、想像したり、情報を得るときに、グループの一員として、AI に加わってもらうことも、有効だと思います。できれば、複数の AI に質問をするのが良いでしょう。

さまざまな課題に、向き合うときに、グループのメンバーや、AI は、多様な意見を言ってくれることと思います。

データを元にした議論の訓練をすることで、根拠を明確にした説明をする訓練もすることができます。そのためにも、グループで学ぶことは有益です。

コードも、AI は教えてくれますが、聞き方が適切ではないと、間違った回答が得られることもあります。それも、グループで議論することで、聞き方を変えていくことも可能かもしれません。

人の前で、発表する練習も、一連の学びの中に加えることをお勧めします。ぜひ、みなさんにあった、学びの場を協力して作っていってください。

## 参考

* [対話型 AI - Chat Bot について](https://icu-hsuzuki.github.io/ds_education/chatgpt.html#chatgpt)
  - AI の使い方や例について、書いてあります。参考にしてください。
  
* [Data Analysis for Researchers 2022](https://icu-hsuzuki.github.io/da4r2022/)
  - オープンデータを用いた、データ分析の授業のデジタルブック

<!--chapter:end:01-intro.Rmd-->

# 学ぶ内容　{#what2learn}

## データサイエンス入門

具体的なデータを利用して、データサインエスとは、どのようなものかをみていきながら、ここで学ぶことの概要を紹介します。オープン・パブリックデータとしては、世界銀行のデータを使います。さまざまなデータが公開され、簡単に取得できるようになっている現状も紹介します。コードの詳細には、こだわらず、データサイエンスの実際について、雰囲気を感じていただければと思います。

## 第一部　パブリックデータ

世界のさまざまな、パブリックデータの紹介をし、ダッシュボードと呼ばれる機能を活用して、データをみることをします。

世界銀行の世界開発指標（WDI）、国際連合（UN Data）、OECD、日本のデータ（e-Stat）を外観します。

ここでは、R は使わず、サイトが提供するデータを探したり、サイト内でグラフを作成したり、データを取得するには、どのような方法があるかなどを紹介したいと思います。

これらの機関内の機能を、ホームページ閲覧ソフト（Google Chrome, Edge, Safari など）で使うだけで、かなりの情報が得られることを、経験していただければと思います。

## 第二部　基本

R の基本を学びます。R は、もともと、統計解析ソフトとして、開発されたもので、さまざまな分野の研究者によって利用され、また、それぞれの分野に必要な機能を、パッケージという形で開発して発展してきた言語です。非常に多くのひとたちが、開発に加わったために、痒いところに手が届く、多くの機能が機能を、パッケージによって使いすることができるようになりました。しかし、他方、統一性は十分ではなく、プログラミング言語としての機能も十分ではないという欠点も生じました。

個人的には、それを一気に解決したのが、Hadley Wickham 等、その後、RStudio そして、現在の、Posit に引き継がれた、`tidyverse` というパッケージ群の開発です。他の研究者も、`tidyverse` の開発思想を受け継ぎ、発展冴える形で、開発をしているように思います。

そこで、Base R と呼ばれる、最初に読み込まれるシステムと、基本パッケージに、`tidyverse` を加えたものを基本として、極力、これらだけで、基本を学んでいきたいと思います。実際には、他のさまざまな便利なパッケージを使うことも、有用ですが、それは、後に回して、`tidyverse` を中心に学んでいきます。

`tidyverse` により、R は、プログラミング言語としても、一つの優秀な言語となったと思います。コーディングや、プログラミングと言われる、一つ一つのステップを構築し、それを繋げていくことを、学んでいきたいと思います。

もう一つ追加しておくのは、R Markdown の活用です。この、電子書籍も、R Markdown の一つの形式、bookdown を使って書いています。

データサイエンスを学ぶ上で、わたしが必要かつ不可欠と考えているのが、再現性（Reproducibility）と、なにを実行しているのかの説明を同時に記述すること（Literate Programming）です。
コードとともに、その結果を、その下に出力し、かつ、そのコードの説明も加え、さらに、それによって、何がわかるかも、同時に書いていくことによって、データサイエンスの目的を達成することができると考えているからです。

データサイエンスでは、最後のコミュニケーションまでがひとつのまとまりです。他の人に聞いてもらうために発表したり、読んでもらうために、レポートを作成することも、一連の流れに加えることが必須だと思います。

指導してくれるひとがいるときは、そのレポートをみてもらって、評価してもらったり、アドバイスを受けたりすることは不可欠でしょう。それには、そのレポートに、コードとともに結果も書かれており、さらに、それは、何のためで、そこから、何が得られるのかが書かれていることも必要です。

R Markdown の活用も、ともに学んでいきたいと思います。


## 第三部　国際機関などのデータの活用

R を使って、第一部で概観したデータを実際に分析する手法を学びます。

国際機関などでは、さまざまなデータを提供していますが、それぞれに特徴があり、データの形式や、データ取得の方法が異なります。それらを、少しずつ説明しながら、それぞれのデータを、すでに学んだことを応用しながら、分析する実際を経験していきたいと思います。

世界銀行の、世界開発指標（World Development Indicators）が、一番整っているので、まずは、世界開発指標から学びますが、世界銀行の他のデータや、国際連合のデータ、他の国際連合の機関が提供しているデータや、経済開発協力機構（OECD）や、Our World in Data、Euro Stat などと共に、日本のデータである、e-Stat の使い方も学びたいと思います。

国際機関だけではなく、他にも、オープン・パブリックデータを提供しているところがたくさんあります。少しずつその利用方法も含めて、紹介していきたいと思います。

## 第四部　探索的データ分析 Exploratory Data Analysis

データを分析していくには、基本的なステップがありますが、その一つ一つのステップについて、より詳しく学びます。

これまでに、紹介できなかったいくつかの手法についても、紹介していきたいと思います。

## 第五部　分析例

実際の分析例を加えていきたいと思います。

## 付録

技術的なコメントなど、幾つかのトピックについて書いていきます。

だいたい、このような構成を考えています。


<!--chapter:end:02-what2learn.Rmd-->

# はじめてのデータサイエンス {#first-example}

## データサイエンスの実際

データから情報を得るときには、大体次のような手順をとります。

1.  準備 Setup
2.  データを取得 Import data
3.  データ構造の確認 View data
4.  必要に応じて整形 Transform data
5.  視覚化 Visualize data
6.  データを理解 Understand data
7.  レポートなどにまとめる Communicate data

![](https://d33wubrfki0l68.cloudfront.net/795c039ba2520455d833b4034befc8cf360a70ba/558a5/diagrams/data-science-explore.png)

[はじめに](https://icu-hsuzuki.github.io/ds4aj/introduction.html#introduction)に書きましたが、基本的には、問いをもちデータを取得し、視覚化などを通して、データを理解し、さらに問いを深めるサイクルが、データサイエンスの核だと思います。

> R を使った分析の一つの例を、見て行きます。一つ一つのコード（コンピュータ・プログラム）の簡単な説明は、加えますが、あまりそれに捉われず、データサイエンスとは何かを考えながら、雰囲気を味わってください。

## R のパッケージを活用

### 準備 Setup

世界銀行（World Bank）の、世界開発指標（WDI: World Development Indicators）の一つの、GDP（Gross Domestic Product 国内総生産）のデータから始めます。GDP にも何種類かの尺度がありますが、次のものを見てみます。

-   NY.GDP.MKTP.CD: GDP (current US\$)[^03-first-example-1]

[^03-first-example-1]: GDP（Gross Domestic Product）とは、ある国のある期間（通常は1年）における、その国で生産されたすべての最終財・サービスの市場価値の総額を指します。これは国内総生産とも呼ばれます。GDPは、その国の経済力や活力を測る指標の1つとして広く用いられています。WDIのGDP (Current USD)は、各国のGDPを米ドルで表したものであり、通貨の価値が異なっても比較可能な形で国際比較ができます。ただし、GDPはあくまで市場価格を基準としているため、非市場活動や自然災害などの影響を受ける場合がある点に注意が必要です。
  
NY.GDP.MKTP.CD は、データコードと言われるもので、世界開発指標（WDI）には、一つづつ決まっています。

[World Development Indicators](https://datatopics.worldbank.org/world-development-indicators/) のサイトの下にある、Data Themes（テーマ）からテーマを選択し、下にスクロールすると、Code をみることができます。ちなみに、ここで利用する NY.GDP.MKTP.CD: GDP (current US\$) は、テーマの Economy（経済）の、一番上にあります。

経済用語の英語はよく知らないという方は、ブラウザー（Edge, Google Chrome, Safari など）の翻訳機能を使うのも良いでしょう。ただ、そのページの対話型の機能（interactive function）を利用するときは、翻訳機能をOFF にする必要がある場合もありますので、注意してください。

エラーメッセージを調べるときなどに、英語のほうが情報がたくさん得られますから、言語を、英語に変更しておきます。

R には、WDI のデータを取得する R のツール（パッケージ）`WDI` がありますから、それを使います。また、データを取り扱うための基本的なツール（パッケージ）`tidyverse` を使いますので、次のコードで、これらを読み込みます。


```r
Sys.setenv(LANG = "en")
library(tidyverse)
#> -- Attaching core tidyverse packages ---- tidyverse 2.0.0 --
#> v dplyr     1.1.2     v readr     2.1.4
#> v forcats   1.0.0     v stringr   1.5.0
#> v ggplot2   3.4.2     v tibble    3.2.1
#> v lubridate 1.9.2     v tidyr     1.3.0
#> v purrr     1.0.1     
#> -- Conflicts ---------------------- tidyverse_conflicts() --
#> x dplyr::filter() masks stats::filter()
#> x dplyr::lag()    masks stats::lag()
#> i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
library(WDI)
```

データを保存する場所を作成しておくことをお勧めします。保存しておくときは、このディレクトリを使います。


```r
dir.create("./data")
```

### データ取得 Import data

データを取得します。少し時間がかかります。取得したデータに、`df_gdp` などと、わかりやすい名前をつけます。`df` は `data frame` の略で、R で標準的なデータの形式です。


```r
df_gdp <- WDI(country = "all", 
              indicator = c(gdp = "NY.GDP.MKTP.CD"), 
              extra = TRUE)
```

このコードで、全ての国の GDP を取得できます。GDP の値は、`NY.GDP.MKTP.CD` という名前の列にありますが、覚えやすいように、gdp という名前に変更しておきます。`extra = TRUE` とすることによって、それぞれの国についての情報などが追加されます。

### データ構造の確認

最初の数行だけを見るには、`head(df_dgp)` とします。


```r
head(df_gdp)
#>       country iso2c iso3c year        gdp status
#> 1 Afghanistan    AF   AFG 1963  751111191       
#> 2 Afghanistan    AF   AFG 1962  546666678       
#> 3 Afghanistan    AF   AFG 1961  548888896       
#> 4 Afghanistan    AF   AFG 1960  537777811       
#> 5 Afghanistan    AF   AFG 2003 4539496563       
#> 6 Afghanistan    AF   AFG 2002 3854235264       
#>   lastupdated     region capital longitude latitude
#> 1  2023-07-25 South Asia   Kabul   69.1761  34.5228
#> 2  2023-07-25 South Asia   Kabul   69.1761  34.5228
#> 3  2023-07-25 South Asia   Kabul   69.1761  34.5228
#> 4  2023-07-25 South Asia   Kabul   69.1761  34.5228
#> 5  2023-07-25 South Asia   Kabul   69.1761  34.5228
#> 6  2023-07-25 South Asia   Kabul   69.1761  34.5228
#>       income lending
#> 1 Low income     IDA
#> 2 Low income     IDA
#> 3 Low income     IDA
#> 4 Low income     IDA
#> 5 Low income     IDA
#> 6 Low income     IDA
```

データの構造を見るときには、`str(df_gdp)` もよく使われます。今度は、列が縦に並んで表示されます。


```r
str(df_gdp)
#> 'data.frame':	16758 obs. of  13 variables:
#>  $ country    : chr  "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...
#>  $ iso2c      : chr  "AF" "AF" "AF" "AF" ...
#>  $ iso3c      : chr  "AFG" "AFG" "AFG" "AFG" ...
#>  $ year       : int  1963 1962 1961 1960 2003 2002 2001 2000 1995 1994 ...
#>  $ gdp        : num  7.51e+08 5.47e+08 5.49e+08 5.38e+08 4.54e+09 ...
#>   ..- attr(*, "label")= chr "GDP (current US$)"
#>  $ status     : chr  "" "" "" "" ...
#>  $ lastupdated: chr  "2023-07-25" "2023-07-25" "2023-07-25" "2023-07-25" ...
#>  $ region     : chr  "South Asia" "South Asia" "South Asia" "South Asia" ...
#>  $ capital    : chr  "Kabul" "Kabul" "Kabul" "Kabul" ...
#>  $ longitude  : chr  "69.1761" "69.1761" "69.1761" "69.1761" ...
#>  $ latitude   : chr  "34.5228" "34.5228" "34.5228" "34.5228" ...
#>  $ income     : chr  "Low income" "Low income" "Low income" "Low income" ...
#>  $ lending    : chr  "IDA" "IDA" "IDA" "IDA" ...
```

概要 (`summary(df_gdp)`) からもある程度わかります。


```r
summary(df_gdp) 
#>    country             iso2c              iso3c          
#>  Length:16758       Length:16758       Length:16758      
#>  Class :character   Class :character   Class :character  
#>  Mode  :character   Mode  :character   Mode  :character  
#>                                                          
#>                                                          
#>                                                          
#>                                                          
#>       year           gdp               status         
#>  Min.   :1960   Min.   :8.825e+06   Length:16758      
#>  1st Qu.:1975   1st Qu.:2.523e+09   Class :character  
#>  Median :1991   Median :1.843e+10   Mode  :character  
#>  Mean   :1991   Mean   :1.207e+12                     
#>  3rd Qu.:2007   3rd Qu.:2.244e+11                     
#>  Max.   :2022   Max.   :1.006e+14                     
#>                 NA's   :3393                          
#>  lastupdated           region            capital         
#>  Length:16758       Length:16758       Length:16758      
#>  Class :character   Class :character   Class :character  
#>  Mode  :character   Mode  :character   Mode  :character  
#>                                                          
#>                                                          
#>                                                          
#>                                                          
#>   longitude           latitude            income         
#>  Length:16758       Length:16758       Length:16758      
#>  Class :character   Class :character   Class :character  
#>  Mode  :character   Mode  :character   Mode  :character  
#>                                                          
#>                                                          
#>                                                          
#>                                                          
#>    lending         
#>  Length:16758      
#>  Class :character  
#>  Mode  :character  
#>                    
#>                    
#>                    
#> 
```

国のリストをみてみましょう。とても長いリストの中には、地域名も含まれています。


```r
df_gdp %>% distinct(country) %>% pull()
#>   [1] "Afghanistan"                                         
#>   [2] "Africa Eastern and Southern"                         
#>   [3] "Africa Western and Central"                          
#>   [4] "Albania"                                             
#>   [5] "Algeria"                                             
#>   [6] "American Samoa"                                      
#>   [7] "Andorra"                                             
#>   [8] "Angola"                                              
#>   [9] "Antigua and Barbuda"                                 
#>  [10] "Arab World"                                          
#>  [11] "Argentina"                                           
#>  [12] "Armenia"                                             
#>  [13] "Aruba"                                               
#>  [14] "Australia"                                           
#>  [15] "Austria"                                             
#>  [16] "Azerbaijan"                                          
#>  [17] "Bahamas, The"                                        
#>  [18] "Bahrain"                                             
#>  [19] "Bangladesh"                                          
#>  [20] "Barbados"                                            
#>  [21] "Belarus"                                             
#>  [22] "Belgium"                                             
#>  [23] "Belize"                                              
#>  [24] "Benin"                                               
#>  [25] "Bermuda"                                             
#>  [26] "Bhutan"                                              
#>  [27] "Bolivia"                                             
#>  [28] "Bosnia and Herzegovina"                              
#>  [29] "Botswana"                                            
#>  [30] "Brazil"                                              
#>  [31] "British Virgin Islands"                              
#>  [32] "Brunei Darussalam"                                   
#>  [33] "Bulgaria"                                            
#>  [34] "Burkina Faso"                                        
#>  [35] "Burundi"                                             
#>  [36] "Cabo Verde"                                          
#>  [37] "Cambodia"                                            
#>  [38] "Cameroon"                                            
#>  [39] "Canada"                                              
#>  [40] "Caribbean small states"                              
#>  [41] "Cayman Islands"                                      
#>  [42] "Central African Republic"                            
#>  [43] "Central Europe and the Baltics"                      
#>  [44] "Chad"                                                
#>  [45] "Channel Islands"                                     
#>  [46] "Chile"                                               
#>  [47] "China"                                               
#>  [48] "Colombia"                                            
#>  [49] "Comoros"                                             
#>  [50] "Congo, Dem. Rep."                                    
#>  [51] "Congo, Rep."                                         
#>  [52] "Costa Rica"                                          
#>  [53] "Cote d'Ivoire"                                       
#>  [54] "Croatia"                                             
#>  [55] "Cuba"                                                
#>  [56] "Curacao"                                             
#>  [57] "Cyprus"                                              
#>  [58] "Czechia"                                             
#>  [59] "Denmark"                                             
#>  [60] "Djibouti"                                            
#>  [61] "Dominica"                                            
#>  [62] "Dominican Republic"                                  
#>  [63] "Early-demographic dividend"                          
#>  [64] "East Asia & Pacific"                                 
#>  [65] "East Asia & Pacific (excluding high income)"         
#>  [66] "East Asia & Pacific (IDA & IBRD countries)"          
#>  [67] "Ecuador"                                             
#>  [68] "Egypt, Arab Rep."                                    
#>  [69] "El Salvador"                                         
#>  [70] "Equatorial Guinea"                                   
#>  [71] "Eritrea"                                             
#>  [72] "Estonia"                                             
#>  [73] "Eswatini"                                            
#>  [74] "Ethiopia"                                            
#>  [75] "Euro area"                                           
#>  [76] "Europe & Central Asia"                               
#>  [77] "Europe & Central Asia (excluding high income)"       
#>  [78] "Europe & Central Asia (IDA & IBRD countries)"        
#>  [79] "European Union"                                      
#>  [80] "Faroe Islands"                                       
#>  [81] "Fiji"                                                
#>  [82] "Finland"                                             
#>  [83] "Fragile and conflict affected situations"            
#>  [84] "France"                                              
#>  [85] "French Polynesia"                                    
#>  [86] "Gabon"                                               
#>  [87] "Gambia, The"                                         
#>  [88] "Georgia"                                             
#>  [89] "Germany"                                             
#>  [90] "Ghana"                                               
#>  [91] "Gibraltar"                                           
#>  [92] "Greece"                                              
#>  [93] "Greenland"                                           
#>  [94] "Grenada"                                             
#>  [95] "Guam"                                                
#>  [96] "Guatemala"                                           
#>  [97] "Guinea"                                              
#>  [98] "Guinea-Bissau"                                       
#>  [99] "Guyana"                                              
#> [100] "Haiti"                                               
#> [101] "Heavily indebted poor countries (HIPC)"              
#> [102] "High income"                                         
#> [103] "Honduras"                                            
#> [104] "Hong Kong SAR, China"                                
#> [105] "Hungary"                                             
#> [106] "IBRD only"                                           
#> [107] "Iceland"                                             
#> [108] "IDA & IBRD total"                                    
#> [109] "IDA blend"                                           
#> [110] "IDA only"                                            
#> [111] "IDA total"                                           
#> [112] "India"                                               
#> [113] "Indonesia"                                           
#> [114] "Iran, Islamic Rep."                                  
#> [115] "Iraq"                                                
#> [116] "Ireland"                                             
#> [117] "Isle of Man"                                         
#> [118] "Israel"                                              
#> [119] "Italy"                                               
#> [120] "Jamaica"                                             
#> [121] "Japan"                                               
#> [122] "Jordan"                                              
#> [123] "Kazakhstan"                                          
#> [124] "Kenya"                                               
#> [125] "Kiribati"                                            
#> [126] "Korea, Dem. People's Rep."                           
#> [127] "Korea, Rep."                                         
#> [128] "Kosovo"                                              
#> [129] "Kuwait"                                              
#> [130] "Kyrgyz Republic"                                     
#> [131] "Lao PDR"                                             
#> [132] "Late-demographic dividend"                           
#> [133] "Latin America & Caribbean"                           
#> [134] "Latin America & Caribbean (excluding high income)"   
#> [135] "Latin America & the Caribbean (IDA & IBRD countries)"
#> [136] "Latvia"                                              
#> [137] "Least developed countries: UN classification"        
#> [138] "Lebanon"                                             
#> [139] "Lesotho"                                             
#> [140] "Liberia"                                             
#> [141] "Libya"                                               
#> [142] "Liechtenstein"                                       
#> [143] "Lithuania"                                           
#> [144] "Low & middle income"                                 
#> [145] "Low income"                                          
#> [146] "Lower middle income"                                 
#> [147] "Luxembourg"                                          
#> [148] "Macao SAR, China"                                    
#> [149] "Madagascar"                                          
#> [150] "Malawi"                                              
#> [151] "Malaysia"                                            
#> [152] "Maldives"                                            
#> [153] "Mali"                                                
#> [154] "Malta"                                               
#> [155] "Marshall Islands"                                    
#> [156] "Mauritania"                                          
#> [157] "Mauritius"                                           
#> [158] "Mexico"                                              
#> [159] "Micronesia, Fed. Sts."                               
#> [160] "Middle East & North Africa"                          
#> [161] "Middle East & North Africa (excluding high income)"  
#> [162] "Middle East & North Africa (IDA & IBRD countries)"   
#> [163] "Middle income"                                       
#> [164] "Moldova"                                             
#> [165] "Monaco"                                              
#> [166] "Mongolia"                                            
#> [167] "Montenegro"                                          
#> [168] "Morocco"                                             
#> [169] "Mozambique"                                          
#> [170] "Myanmar"                                             
#> [171] "Namibia"                                             
#> [172] "Nauru"                                               
#> [173] "Nepal"                                               
#> [174] "Netherlands"                                         
#> [175] "New Caledonia"                                       
#> [176] "New Zealand"                                         
#> [177] "Nicaragua"                                           
#> [178] "Niger"                                               
#> [179] "Nigeria"                                             
#> [180] "North America"                                       
#> [181] "North Macedonia"                                     
#> [182] "Northern Mariana Islands"                            
#> [183] "Norway"                                              
#> [184] "Not classified"                                      
#> [185] "OECD members"                                        
#> [186] "Oman"                                                
#> [187] "Other small states"                                  
#> [188] "Pacific island small states"                         
#> [189] "Pakistan"                                            
#> [190] "Palau"                                               
#> [191] "Panama"                                              
#> [192] "Papua New Guinea"                                    
#> [193] "Paraguay"                                            
#> [194] "Peru"                                                
#> [195] "Philippines"                                         
#> [196] "Poland"                                              
#> [197] "Portugal"                                            
#> [198] "Post-demographic dividend"                           
#> [199] "Pre-demographic dividend"                            
#> [200] "Puerto Rico"                                         
#> [201] "Qatar"                                               
#> [202] "Romania"                                             
#> [203] "Russian Federation"                                  
#> [204] "Rwanda"                                              
#> [205] "Samoa"                                               
#> [206] "San Marino"                                          
#> [207] "Sao Tome and Principe"                               
#> [208] "Saudi Arabia"                                        
#> [209] "Senegal"                                             
#> [210] "Serbia"                                              
#> [211] "Seychelles"                                          
#> [212] "Sierra Leone"                                        
#> [213] "Singapore"                                           
#> [214] "Sint Maarten (Dutch part)"                           
#> [215] "Slovak Republic"                                     
#> [216] "Slovenia"                                            
#> [217] "Small states"                                        
#> [218] "Solomon Islands"                                     
#> [219] "Somalia"                                             
#> [220] "South Africa"                                        
#> [221] "South Asia"                                          
#> [222] "South Asia (IDA & IBRD)"                             
#> [223] "South Sudan"                                         
#> [224] "Spain"                                               
#> [225] "Sri Lanka"                                           
#> [226] "St. Kitts and Nevis"                                 
#> [227] "St. Lucia"                                           
#> [228] "St. Martin (French part)"                            
#> [229] "St. Vincent and the Grenadines"                      
#> [230] "Sub-Saharan Africa"                                  
#> [231] "Sub-Saharan Africa (excluding high income)"          
#> [232] "Sub-Saharan Africa (IDA & IBRD countries)"           
#> [233] "Sudan"                                               
#> [234] "Suriname"                                            
#> [235] "Sweden"                                              
#> [236] "Switzerland"                                         
#> [237] "Syrian Arab Republic"                                
#> [238] "Tajikistan"                                          
#> [239] "Tanzania"                                            
#> [240] "Thailand"                                            
#> [241] "Timor-Leste"                                         
#> [242] "Togo"                                                
#> [243] "Tonga"                                               
#> [244] "Trinidad and Tobago"                                 
#> [245] "Tunisia"                                             
#> [246] "Turkiye"                                             
#> [247] "Turkmenistan"                                        
#> [248] "Turks and Caicos Islands"                            
#> [249] "Tuvalu"                                              
#> [250] "Uganda"                                              
#> [251] "Ukraine"                                             
#> [252] "United Arab Emirates"                                
#> [253] "United Kingdom"                                      
#> [254] "United States"                                       
#> [255] "Upper middle income"                                 
#> [256] "Uruguay"                                             
#> [257] "Uzbekistan"                                          
#> [258] "Vanuatu"                                             
#> [259] "Venezuela, RB"                                       
#> [260] "Vietnam"                                             
#> [261] "Virgin Islands (U.S.)"                               
#> [262] "West Bank and Gaza"                                  
#> [263] "World"                                               
#> [264] "Yemen, Rep."                                         
#> [265] "Zambia"                                              
#> [266] "Zimbabwe"
```

今回は下のように、`%>%`（パイプと呼びます） で繋げてコードを書きました。

```         
df_gdp %>% distinct(country) %>% pull()
```

最初は、データ、その中の、異なる国を選択して、書き出してくださいというものです。

これは、

```         
pull(distinct(df_gdp, country))
```

と同じです。どんどん、かっこの中に入れ子になって複雑になるので、一つ一つのステップを、順に書いたものが、最初のものになります。

```         
df_gdp %>% head()
df_gdp %>% str()
```

なども可能です。かっこの中に最初に入るものが直前のもの、ここでは、データになっています。

### 必要に応じて整形 Transform data

変数が多いので、日本の部分だけ `filter` を使って選択します。country が Japan と一致する場合のみを選択するときは、`==` を使います。数値ではないので、引用符をつけます。半角を使ってください。


```r
df_gdp %>% filter(country == "Japan")
#>    country iso2c iso3c year          gdp status lastupdated
#> 1    Japan    JP   JPN 2022 4.231141e+12         2023-07-25
#> 2    Japan    JP   JPN 2021 5.005537e+12         2023-07-25
#> 3    Japan    JP   JPN 2020 5.048790e+12         2023-07-25
#> 4    Japan    JP   JPN 2019 5.117994e+12         2023-07-25
#> 5    Japan    JP   JPN 2018 5.040881e+12         2023-07-25
#> 6    Japan    JP   JPN 2017 4.930837e+12         2023-07-25
#> 7    Japan    JP   JPN 2016 5.003678e+12         2023-07-25
#> 8    Japan    JP   JPN 2015 4.444931e+12         2023-07-25
#> 9    Japan    JP   JPN 2014 4.896994e+12         2023-07-25
#> 10   Japan    JP   JPN 2013 5.212328e+12         2023-07-25
#> 11   Japan    JP   JPN 2012 6.272363e+12         2023-07-25
#> 12   Japan    JP   JPN 2011 6.233147e+12         2023-07-25
#> 13   Japan    JP   JPN 2010 5.759072e+12         2023-07-25
#> 14   Japan    JP   JPN 2009 5.289494e+12         2023-07-25
#> 15   Japan    JP   JPN 2008 5.106679e+12         2023-07-25
#> 16   Japan    JP   JPN 2007 4.579750e+12         2023-07-25
#> 17   Japan    JP   JPN 2006 4.601663e+12         2023-07-25
#> 18   Japan    JP   JPN 2005 4.831467e+12         2023-07-25
#> 19   Japan    JP   JPN 2004 4.893116e+12         2023-07-25
#> 20   Japan    JP   JPN 2003 4.519563e+12         2023-07-25
#> 21   Japan    JP   JPN 2002 4.182845e+12         2023-07-25
#> 22   Japan    JP   JPN 2001 4.374710e+12         2023-07-25
#> 23   Japan    JP   JPN 2000 4.968359e+12         2023-07-25
#> 24   Japan    JP   JPN 1999 4.635982e+12         2023-07-25
#> 25   Japan    JP   JPN 1998 4.098363e+12         2023-07-25
#> 26   Japan    JP   JPN 1997 4.492450e+12         2023-07-25
#> 27   Japan    JP   JPN 1996 4.923393e+12         2023-07-25
#> 28   Japan    JP   JPN 1995 5.545565e+12         2023-07-25
#> 29   Japan    JP   JPN 1994 4.998797e+12         2023-07-25
#> 30   Japan    JP   JPN 1993 4.454144e+12         2023-07-25
#> 31   Japan    JP   JPN 1992 3.908808e+12         2023-07-25
#> 32   Japan    JP   JPN 1991 3.584421e+12         2023-07-25
#> 33   Japan    JP   JPN 1990 3.132818e+12         2023-07-25
#> 34   Japan    JP   JPN 1989 3.054914e+12         2023-07-25
#> 35   Japan    JP   JPN 1988 3.071684e+12         2023-07-25
#> 36   Japan    JP   JPN 1987 2.532809e+12         2023-07-25
#> 37   Japan    JP   JPN 1986 2.078953e+12         2023-07-25
#> 38   Japan    JP   JPN 1985 1.398893e+12         2023-07-25
#> 39   Japan    JP   JPN 1984 1.318382e+12         2023-07-25
#> 40   Japan    JP   JPN 1983 1.243324e+12         2023-07-25
#> 41   Japan    JP   JPN 1982 1.134518e+12         2023-07-25
#> 42   Japan    JP   JPN 1981 1.218989e+12         2023-07-25
#> 43   Japan    JP   JPN 1980 1.105386e+12         2023-07-25
#> 44   Japan    JP   JPN 1979 1.055012e+12         2023-07-25
#> 45   Japan    JP   JPN 1978 1.013612e+12         2023-07-25
#> 46   Japan    JP   JPN 1977 7.214118e+11         2023-07-25
#> 47   Japan    JP   JPN 1976 5.861619e+11         2023-07-25
#> 48   Japan    JP   JPN 1975 5.215419e+11         2023-07-25
#> 49   Japan    JP   JPN 1974 4.796260e+11         2023-07-25
#> 50   Japan    JP   JPN 1973 4.320827e+11         2023-07-25
#> 51   Japan    JP   JPN 1972 3.180313e+11         2023-07-25
#> 52   Japan    JP   JPN 1971 2.401518e+11         2023-07-25
#> 53   Japan    JP   JPN 1970 2.126092e+11         2023-07-25
#> 54   Japan    JP   JPN 1969 1.722042e+11         2023-07-25
#> 55   Japan    JP   JPN 1968 1.466011e+11         2023-07-25
#> 56   Japan    JP   JPN 1967 1.237819e+11         2023-07-25
#> 57   Japan    JP   JPN 1966 1.056281e+11         2023-07-25
#> 58   Japan    JP   JPN 1965 9.095028e+10         2023-07-25
#> 59   Japan    JP   JPN 1964 8.174901e+10         2023-07-25
#> 60   Japan    JP   JPN 1963 6.949813e+10         2023-07-25
#> 61   Japan    JP   JPN 1962 6.072302e+10         2023-07-25
#> 62   Japan    JP   JPN 1961 5.350862e+10         2023-07-25
#> 63   Japan    JP   JPN 1960 4.430734e+10         2023-07-25
#>                 region capital longitude latitude
#> 1  East Asia & Pacific   Tokyo    139.77    35.67
#> 2  East Asia & Pacific   Tokyo    139.77    35.67
#> 3  East Asia & Pacific   Tokyo    139.77    35.67
#> 4  East Asia & Pacific   Tokyo    139.77    35.67
#> 5  East Asia & Pacific   Tokyo    139.77    35.67
#> 6  East Asia & Pacific   Tokyo    139.77    35.67
#> 7  East Asia & Pacific   Tokyo    139.77    35.67
#> 8  East Asia & Pacific   Tokyo    139.77    35.67
#> 9  East Asia & Pacific   Tokyo    139.77    35.67
#> 10 East Asia & Pacific   Tokyo    139.77    35.67
#> 11 East Asia & Pacific   Tokyo    139.77    35.67
#> 12 East Asia & Pacific   Tokyo    139.77    35.67
#> 13 East Asia & Pacific   Tokyo    139.77    35.67
#> 14 East Asia & Pacific   Tokyo    139.77    35.67
#> 15 East Asia & Pacific   Tokyo    139.77    35.67
#> 16 East Asia & Pacific   Tokyo    139.77    35.67
#> 17 East Asia & Pacific   Tokyo    139.77    35.67
#> 18 East Asia & Pacific   Tokyo    139.77    35.67
#> 19 East Asia & Pacific   Tokyo    139.77    35.67
#> 20 East Asia & Pacific   Tokyo    139.77    35.67
#> 21 East Asia & Pacific   Tokyo    139.77    35.67
#> 22 East Asia & Pacific   Tokyo    139.77    35.67
#> 23 East Asia & Pacific   Tokyo    139.77    35.67
#> 24 East Asia & Pacific   Tokyo    139.77    35.67
#> 25 East Asia & Pacific   Tokyo    139.77    35.67
#> 26 East Asia & Pacific   Tokyo    139.77    35.67
#> 27 East Asia & Pacific   Tokyo    139.77    35.67
#> 28 East Asia & Pacific   Tokyo    139.77    35.67
#> 29 East Asia & Pacific   Tokyo    139.77    35.67
#> 30 East Asia & Pacific   Tokyo    139.77    35.67
#> 31 East Asia & Pacific   Tokyo    139.77    35.67
#> 32 East Asia & Pacific   Tokyo    139.77    35.67
#> 33 East Asia & Pacific   Tokyo    139.77    35.67
#> 34 East Asia & Pacific   Tokyo    139.77    35.67
#> 35 East Asia & Pacific   Tokyo    139.77    35.67
#> 36 East Asia & Pacific   Tokyo    139.77    35.67
#> 37 East Asia & Pacific   Tokyo    139.77    35.67
#> 38 East Asia & Pacific   Tokyo    139.77    35.67
#> 39 East Asia & Pacific   Tokyo    139.77    35.67
#> 40 East Asia & Pacific   Tokyo    139.77    35.67
#> 41 East Asia & Pacific   Tokyo    139.77    35.67
#> 42 East Asia & Pacific   Tokyo    139.77    35.67
#> 43 East Asia & Pacific   Tokyo    139.77    35.67
#> 44 East Asia & Pacific   Tokyo    139.77    35.67
#> 45 East Asia & Pacific   Tokyo    139.77    35.67
#> 46 East Asia & Pacific   Tokyo    139.77    35.67
#> 47 East Asia & Pacific   Tokyo    139.77    35.67
#> 48 East Asia & Pacific   Tokyo    139.77    35.67
#> 49 East Asia & Pacific   Tokyo    139.77    35.67
#> 50 East Asia & Pacific   Tokyo    139.77    35.67
#> 51 East Asia & Pacific   Tokyo    139.77    35.67
#> 52 East Asia & Pacific   Tokyo    139.77    35.67
#> 53 East Asia & Pacific   Tokyo    139.77    35.67
#> 54 East Asia & Pacific   Tokyo    139.77    35.67
#> 55 East Asia & Pacific   Tokyo    139.77    35.67
#> 56 East Asia & Pacific   Tokyo    139.77    35.67
#> 57 East Asia & Pacific   Tokyo    139.77    35.67
#> 58 East Asia & Pacific   Tokyo    139.77    35.67
#> 59 East Asia & Pacific   Tokyo    139.77    35.67
#> 60 East Asia & Pacific   Tokyo    139.77    35.67
#> 61 East Asia & Pacific   Tokyo    139.77    35.67
#> 62 East Asia & Pacific   Tokyo    139.77    35.67
#> 63 East Asia & Pacific   Tokyo    139.77    35.67
#>         income        lending
#> 1  High income Not classified
#> 2  High income Not classified
#> 3  High income Not classified
#> 4  High income Not classified
#> 5  High income Not classified
#> 6  High income Not classified
#> 7  High income Not classified
#> 8  High income Not classified
#> 9  High income Not classified
#> 10 High income Not classified
#> 11 High income Not classified
#> 12 High income Not classified
#> 13 High income Not classified
#> 14 High income Not classified
#> 15 High income Not classified
#> 16 High income Not classified
#> 17 High income Not classified
#> 18 High income Not classified
#> 19 High income Not classified
#> 20 High income Not classified
#> 21 High income Not classified
#> 22 High income Not classified
#> 23 High income Not classified
#> 24 High income Not classified
#> 25 High income Not classified
#> 26 High income Not classified
#> 27 High income Not classified
#> 28 High income Not classified
#> 29 High income Not classified
#> 30 High income Not classified
#> 31 High income Not classified
#> 32 High income Not classified
#> 33 High income Not classified
#> 34 High income Not classified
#> 35 High income Not classified
#> 36 High income Not classified
#> 37 High income Not classified
#> 38 High income Not classified
#> 39 High income Not classified
#> 40 High income Not classified
#> 41 High income Not classified
#> 42 High income Not classified
#> 43 High income Not classified
#> 44 High income Not classified
#> 45 High income Not classified
#> 46 High income Not classified
#> 47 High income Not classified
#> 48 High income Not classified
#> 49 High income Not classified
#> 50 High income Not classified
#> 51 High income Not classified
#> 52 High income Not classified
#> 53 High income Not classified
#> 54 High income Not classified
#> 55 High income Not classified
#> 56 High income Not classified
#> 57 High income Not classified
#> 58 High income Not classified
#> 59 High income Not classified
#> 60 High income Not classified
#> 61 High income Not classified
#> 62 High income Not classified
#> 63 High income Not classified
```


```r
df_gdp %>% filter(country == "Japan") %>% head(2)
#>   country iso2c iso3c year          gdp status lastupdated
#> 1   Japan    JP   JPN 2022 4.231141e+12         2023-07-25
#> 2   Japan    JP   JPN 2021 5.005537e+12         2023-07-25
#>                region capital longitude latitude
#> 1 East Asia & Pacific   Tokyo    139.77    35.67
#> 2 East Asia & Pacific   Tokyo    139.77    35.67
#>        income        lending
#> 1 High income Not classified
#> 2 High income Not classified
```

２行目の、gdp の、4.940878e+12 は、Scientific notation と言われるもので、 $$4.940878 \times 10^{12} = 4,940,887,800,000$$ を意味します。`e+3` は千（thousand）、`e+6` は百万（million）、`e+9` は、10億（billion）、`e+12` は、兆（trillion）ですから、日本の、2021 年の GDP は、約5兆ドルとなります。

### 視覚化 data visualization

#### Fig 1. 日本のGDP の経年変化を折線グラフ（line graph）


```r
df_gdp %>% filter(country == "Japan") %>%
  ggplot(aes(x = year, y = gdp)) + geom_line()
```

![](03-first-example_files/figure-latex/unnamed-chunk-10-1.pdf)<!-- --> 

```         
df_gdp %>% filter(country == "Japan") %>%
  ggplot(aes(x = year, y = gdp)) + geom_line()
```

日本を選択したときに、それに名前をつけておいて、それを使うこともできますが、名前がどんどん増えるので、それに続けて、コードを書いていく方法をとっています。

`ggplot(aes(x = year, y = gdp)) + geom_line()`

の部分が、グラフを描く部分で、「x 軸を、year、y 軸を、gdp として、それを、折線グラフで描いてください」というコードです。

Warning: [38;5;238mRemoved 1 row containing missing values

と表示されています。値がない年があることを言っています。2022年のデータがないことがわかっていますから、最初から削除してこくことも可能です。

### データの理解 Understand data

視覚化によって見えてくることがいくつもありますね。どんなことがわかりますか。気づいたこと（observation）をあげてみましょう。

コードを描くことではなく、この部分が、データサイエンスの核の部分です。気づいたことを列挙してみましょう。

### さまざまな視覚化

#### Fig 2. 各年ごとのデータの数

`summary(df_gdp)` で、データ自体は、1960年から2022年までのようですが、日本も、2022年のデータはありませんでしたから、年によって、どの程度データがあるか、調べてみます。


```r
df_gdp %>% drop_na(gdp) %>% ggplot(aes(x = year)) + geom_bar()
```

![](03-first-example_files/figure-latex/unnamed-chunk-11-1.pdf)<!-- --> 

```         
df_gdp %>% drop_na(gdp) %>% ggplot(aes(x = year)) + geom_bar()
```

バー・グラフを使いますが、`gdp` の値が、欠損値（NA: not available）のデータを削除してから、グラフを描きます。

#### 2021年のGDPの降順での表示（１）

最新の2021年のデータはすべてあるわけではなさそうですが、`gdp` の値が大きい順に並べてみましょう。


```r
df_gdp %>% filter(year == 2021) %>% drop_na(gdp) %>% arrange(desc(gdp))
#>                                                  country
#> 1                                                  World
#> 2                                            High income
#> 3                                           OECD members
#> 4                              Post-demographic dividend
#> 5                                       IDA & IBRD total
#> 6                                    Low & middle income
#> 7                                          Middle income
#> 8                                              IBRD only
#> 9                                    East Asia & Pacific
#> 10                                   Upper middle income
#> 11                             Late-demographic dividend
#> 12                                         North America
#> 13                                 Europe & Central Asia
#> 14                                         United States
#> 15           East Asia & Pacific (excluding high income)
#> 16            East Asia & Pacific (IDA & IBRD countries)
#> 17                                                 China
#> 18                                        European Union
#> 19                                             Euro area
#> 20                            Early-demographic dividend
#> 21                                   Lower middle income
#> 22                             Latin America & Caribbean
#> 23  Latin America & the Caribbean (IDA & IBRD countries)
#> 24                                                 Japan
#> 25     Latin America & Caribbean (excluding high income)
#> 26          Europe & Central Asia (IDA & IBRD countries)
#> 27                                               Germany
#> 28                                            South Asia
#> 29                               South Asia (IDA & IBRD)
#> 30                            Middle East & North Africa
#> 31         Europe & Central Asia (excluding high income)
#> 32                                                 India
#> 33                                        United Kingdom
#> 34                                                France
#> 35                                            Arab World
#> 36                                             IDA total
#> 37                                                 Italy
#> 38                                                Canada
#> 39                                    Sub-Saharan Africa
#> 40             Sub-Saharan Africa (IDA & IBRD countries)
#> 41            Sub-Saharan Africa (excluding high income)
#> 42                        Central Europe and the Baltics
#> 43                                    Russian Federation
#> 44                                           Korea, Rep.
#> 45              Fragile and conflict affected situations
#> 46                                                Brazil
#> 47                                             Australia
#> 48                                              IDA only
#> 49    Middle East & North Africa (excluding high income)
#> 50     Middle East & North Africa (IDA & IBRD countries)
#> 51                              Pre-demographic dividend
#> 52                                                 Spain
#> 53                                                Mexico
#> 54          Least developed countries: UN classification
#> 55                                             Indonesia
#> 56                                             IDA blend
#> 57                           Africa Eastern and Southern
#> 58                                           Netherlands
#> 59                Heavily indebted poor countries (HIPC)
#> 60                                          Saudi Arabia
#> 61                            Africa Western and Central
#> 62                                               Turkiye
#> 63                                           Switzerland
#> 64                                                Poland
#> 65                                                Sweden
#> 66                                               Belgium
#> 67                                          Small states
#> 68                                              Thailand
#> 69                                               Ireland
#> 70                                                Norway
#> 71                                                Israel
#> 72                                             Argentina
#> 73                                               Austria
#> 74                                            Low income
#> 75                                    Other small states
#> 76                                               Nigeria
#> 77                                      Egypt, Arab Rep.
#> 78                                             Singapore
#> 79                                          South Africa
#> 80                                            Bangladesh
#> 81                                  United Arab Emirates
#> 82                                               Denmark
#> 83                                           Philippines
#> 84                                              Malaysia
#> 85                                  Hong Kong SAR, China
#> 86                                               Vietnam
#> 87                                    Iran, Islamic Rep.
#> 88                                              Pakistan
#> 89                                              Colombia
#> 90                                                 Chile
#> 91                                               Finland
#> 92                                               Romania
#> 93                                               Czechia
#> 94                                           New Zealand
#> 95                                              Portugal
#> 96                                                  Peru
#> 97                                                Greece
#> 98                                                  Iraq
#> 99                                               Ukraine
#> 100                                           Kazakhstan
#> 101                                              Hungary
#> 102                                                Qatar
#> 103                                              Algeria
#> 104                                              Morocco
#> 105                                               Kuwait
#> 106                                      Slovak Republic
#> 107                                             Ethiopia
#> 108                                                Kenya
#> 109                                          Puerto Rico
#> 110                                              Ecuador
#> 111                                   Dominican Republic
#> 112                                            Sri Lanka
#> 113                                                 Oman
#> 114                                            Guatemala
#> 115                                           Luxembourg
#> 116                                             Bulgaria
#> 117                                                Ghana
#> 118                               Caribbean small states
#> 119                                        Cote d'Ivoire
#> 120                                             Tanzania
#> 121                                              Belarus
#> 122                                           Uzbekistan
#> 123                                              Croatia
#> 124                                               Panama
#> 125                                            Lithuania
#> 126                                               Angola
#> 127                                              Myanmar
#> 128                                           Costa Rica
#> 129                                               Serbia
#> 130                                             Slovenia
#> 131                                              Uruguay
#> 132                                     Congo, Dem. Rep.
#> 133                                           Azerbaijan
#> 134                                              Tunisia
#> 135                                             Cameroon
#> 136                                               Jordan
#> 137                                               Uganda
#> 138                                              Bolivia
#> 139                                             Paraguay
#> 140                                                Libya
#> 141                                               Latvia
#> 142                                              Bahrain
#> 143                                              Estonia
#> 144                                                Nepal
#> 145                                                Sudan
#> 146                                     Macao SAR, China
#> 147                                          El Salvador
#> 148                                             Honduras
#> 149                                               Cyprus
#> 150                                             Zimbabwe
#> 151                                              Senegal
#> 152                                             Cambodia
#> 153                                     Papua New Guinea
#> 154                                              Iceland
#> 155                                  Trinidad and Tobago
#> 156                               Bosnia and Herzegovina
#> 157                                              Lebanon
#> 158                                               Zambia
#> 159                                                Haiti
#> 160                                                Gabon
#> 161                                         Burkina Faso
#> 162                                                 Mali
#> 163                                              Lao PDR
#> 164                                             Botswana
#> 165                                              Georgia
#> 166                                   West Bank and Gaza
#> 167                                              Albania
#> 168                                                Malta
#> 169                                                Benin
#> 170                                               Guinea
#> 171                                           Mozambique
#> 172                                             Mongolia
#> 173                                                Niger
#> 174                                              Jamaica
#> 175                                          Afghanistan
#> 176                                           Madagascar
#> 177                                            Nicaragua
#> 178                                    Brunei Darussalam
#> 179                                              Armenia
#> 180                                      North Macedonia
#> 181                                              Moldova
#> 182                                          Congo, Rep.
#> 183                                               Malawi
#> 184                                              Namibia
#> 185                                    Equatorial Guinea
#> 186                                                 Chad
#> 187                                      Channel Islands
#> 188                                         Bahamas, The
#> 189                                            Mauritius
#> 190                                               Rwanda
#> 191                                        New Caledonia
#> 192                                           Mauritania
#> 193                          Pacific island small states
#> 194                                               Kosovo
#> 195                                           Tajikistan
#> 196                                      Kyrgyz Republic
#> 197                                               Monaco
#> 198                                                 Togo
#> 199                                               Guyana
#> 200                                              Somalia
#> 201                                        Liechtenstein
#> 202                                              Bermuda
#> 203                                                 Guam
#> 204                                     French Polynesia
#> 205                                       Cayman Islands
#> 206                                           Montenegro
#> 207                                             Maldives
#> 208                                             Barbados
#> 209                                             Eswatini
#> 210                                                 Fiji
#> 211                                         Sierra Leone
#> 212                                        Faroe Islands
#> 213                                          Timor-Leste
#> 214                                              Liberia
#> 215                                             Djibouti
#> 216                                              Andorra
#> 217                                            Greenland
#> 218                                                Aruba
#> 219                                             Suriname
#> 220                                              Burundi
#> 221                                              Curacao
#> 222                                               Bhutan
#> 223                             Central African Republic
#> 224                                               Belize
#> 225                                              Lesotho
#> 226                                           Cabo Verde
#> 227                                          Gambia, The
#> 228                                           San Marino
#> 229                                            St. Lucia
#> 230                                        Guinea-Bissau
#> 231                                      Solomon Islands
#> 232                                  Antigua and Barbuda
#> 233                            Sint Maarten (Dutch part)
#> 234                                              Comoros
#> 235                                           Seychelles
#> 236                                              Grenada
#> 237                             Turks and Caicos Islands
#> 238                                              Vanuatu
#> 239                       St. Vincent and the Grenadines
#> 240                                  St. Kitts and Nevis
#> 241                                                Samoa
#> 242                                       American Samoa
#> 243                                             Dominica
#> 244                                Sao Tome and Principe
#> 245                                                Tonga
#> 246                                Micronesia, Fed. Sts.
#> 247                                     Marshall Islands
#> 248                                             Kiribati
#> 249                                                Palau
#> 250                                                Nauru
#> 251                                               Tuvalu
#>     iso2c iso3c year          gdp status lastupdated
#> 1      1W   WLD 2021 9.688240e+13         2023-07-25
#> 2      XD       2021 6.001671e+13         2023-07-25
#> 3      OE   OED 2021 5.836393e+13         2023-07-25
#> 4      V4   PST 2021 5.509086e+13         2023-07-25
#> 5      ZT   IBT 2021 3.824618e+13         2023-07-25
#> 6      XO   LMY 2021 3.653729e+13         2023-07-25
#> 7      XP   MIC 2021 3.606615e+13         2023-07-25
#> 8      XF   IBD 2021 3.561558e+13         2023-07-25
#> 9      Z4   EAS 2021 3.109557e+13         2023-07-25
#> 10     XT       2021 2.847514e+13         2023-07-25
#> 11     V3   LTE 2021 2.682750e+13         2023-07-25
#> 12     XU   NAC 2021 2.532369e+13         2023-07-25
#> 13     Z7   ECS 2021 2.515388e+13         2023-07-25
#> 14     US   USA 2021 2.331508e+13         2023-07-25
#> 15     4E   EAP 2021 2.083735e+13         2023-07-25
#> 16     T4   TEA 2021 2.081135e+13         2023-07-25
#> 17     CN   CHN 2021 1.782046e+13         2023-07-25
#> 18     EU   EUU 2021 1.718787e+13         2023-07-25
#> 19     XC   EMU 2021 1.457089e+13         2023-07-25
#> 20     V2   EAR 2021 1.267419e+13         2023-07-25
#> 21     XN       2021 7.592013e+12         2023-07-25
#> 22     ZJ   LCN 2021 5.510524e+12         2023-07-25
#> 23     T2   TLA 2021 5.238234e+12         2023-07-25
#> 24     JP   JPN 2021 5.005537e+12         2023-07-25
#> 25     XJ   LAC 2021 4.624162e+12         2023-07-25
#> 26     T7   TEC 2021 4.615368e+12         2023-07-25
#> 27     DE   DEU 2021 4.259935e+12         2023-07-25
#> 28     8S   SAS 2021 4.062784e+12         2023-07-25
#> 29     T5   TSA 2021 4.062784e+12         2023-07-25
#> 30     ZQ   MEA 2021 3.740993e+12         2023-07-25
#> 31     7E   ECA 2021 3.581678e+12         2023-07-25
#> 32     IN   IND 2021 3.150307e+12         2023-07-25
#> 33     GB   GBR 2021 3.122480e+12         2023-07-25
#> 34     FR   FRA 2021 2.957880e+12         2023-07-25
#> 35     1A   ARB 2021 2.928456e+12         2023-07-25
#> 36     XG   IDA 2021 2.630947e+12         2023-07-25
#> 37     IT   ITA 2021 2.114356e+12         2023-07-25
#> 38     CA   CAN 2021 2.001487e+12         2023-07-25
#> 39     ZG   SSF 2021 1.926458e+12         2023-07-25
#> 40     T6   TSS 2021 1.926458e+12         2023-07-25
#> 41     ZF   SSA 2021 1.925171e+12         2023-07-25
#> 42     B8   CEB 2021 1.905555e+12         2023-07-25
#> 43     RU   RUS 2021 1.836892e+12         2023-07-25
#> 44     KR   KOR 2021 1.810956e+12         2023-07-25
#> 45     F1   FCS 2021 1.782738e+12         2023-07-25
#> 46     BR   BRA 2021 1.649623e+12         2023-07-25
#> 47     AU   AUS 2021 1.552703e+12         2023-07-25
#> 48     XI   IDX 2021 1.534884e+12         2023-07-25
#> 49     XQ   MNA 2021 1.507014e+12         2023-07-25
#> 50     T3   TMN 2021 1.488906e+12         2023-07-25
#> 51     V1   PRE 2021 1.429588e+12         2023-07-25
#> 52     ES   ESP 2021 1.427381e+12         2023-07-25
#> 53     MX   MEX 2021 1.272839e+12         2023-07-25
#> 54     XL   LDC 2021 1.266463e+12         2023-07-25
#> 55     ID   IDN 2021 1.186505e+12         2023-07-25
#> 56     XH   IDB 2021 1.096039e+12         2023-07-25
#> 57     ZH   AFE 2021 1.081998e+12         2023-07-25
#> 58     NL   NLD 2021 1.011799e+12         2023-07-25
#> 59     XE   HPC 2021 8.987718e+11         2023-07-25
#> 60     SA   SAU 2021 8.685859e+11         2023-07-25
#> 61     ZI   AFW 2021 8.444597e+11         2023-07-25
#> 62     TR   TUR 2021 8.190345e+11         2023-07-25
#> 63     CH   CHE 2021 8.006402e+11         2023-07-25
#> 64     PL   POL 2021 6.794419e+11         2023-07-25
#> 65     SE   SWE 2021 6.368562e+11         2023-07-25
#> 66     BE   BEL 2021 5.943520e+11         2023-07-25
#> 67     S1   SST 2021 5.408338e+11         2023-07-25
#> 68     TH   THA 2021 5.055681e+11         2023-07-25
#> 69     IE   IRL 2021 5.041826e+11         2023-07-25
#> 70     NO   NOR 2021 4.902934e+11         2023-07-25
#> 71     IL   ISR 2021 4.885265e+11         2023-07-25
#> 72     AR   ARG 2021 4.872271e+11         2023-07-25
#> 73     AT   AUT 2021 4.803684e+11         2023-07-25
#> 74     XM       2021 4.678769e+11         2023-07-25
#> 75     S4   OSS 2021 4.556851e+11         2023-07-25
#> 76     NG   NGA 2021 4.408336e+11         2023-07-25
#> 77     EG   EGY 2021 4.246718e+11         2023-07-25
#> 78     SG   SGP 2021 4.237970e+11         2023-07-25
#> 79     ZA   ZAF 2021 4.190156e+11         2023-07-25
#> 80     BD   BGD 2021 4.162648e+11         2023-07-25
#> 81     AE   ARE 2021 4.150216e+11         2023-07-25
#> 82     DK   DNK 2021 3.983033e+11         2023-07-25
#> 83     PH   PHL 2021 3.940874e+11         2023-07-25
#> 84     MY   MYS 2021 3.729811e+11         2023-07-25
#> 85     HK   HKG 2021 3.689114e+11         2023-07-25
#> 86     VN   VNM 2021 3.661376e+11         2023-07-25
#> 87     IR   IRN 2021 3.590969e+11         2023-07-25
#> 88     PK   PAK 2021 3.482625e+11         2023-07-25
#> 89     CO   COL 2021 3.185118e+11         2023-07-25
#> 90     CL   CHL 2021 3.167136e+11         2023-07-25
#> 91     FI   FIN 2021 2.963876e+11         2023-07-25
#> 92     RO   ROU 2021 2.854047e+11         2023-07-25
#> 93     CZ   CZE 2021 2.817912e+11         2023-07-25
#> 94     NZ   NZL 2021 2.555517e+11         2023-07-25
#> 95     PT   PRT 2021 2.539828e+11         2023-07-25
#> 96     PE   PER 2021 2.237178e+11         2023-07-25
#> 97     GR   GRC 2021 2.148739e+11         2023-07-25
#> 98     IQ   IRQ 2021 2.076916e+11         2023-07-25
#> 99     UA   UKR 2021 1.997659e+11         2023-07-25
#> 100    KZ   KAZ 2021 1.971123e+11         2023-07-25
#> 101    HU   HUN 2021 1.822754e+11         2023-07-25
#> 102    QA   QAT 2021 1.796771e+11         2023-07-25
#> 103    DZ   DZA 2021 1.634722e+11         2023-07-25
#> 104    MA   MAR 2021 1.428666e+11         2023-07-25
#> 105    KW   KWT 2021 1.367974e+11         2023-07-25
#> 106    SK   SVK 2021 1.186566e+11         2023-07-25
#> 107    ET   ETH 2021 1.112619e+11         2023-07-25
#> 108    KE   KEN 2021 1.097037e+11         2023-07-25
#> 109    PR   PRI 2021 1.063689e+11         2023-07-25
#> 110    EC   ECU 2021 1.061659e+11         2023-07-25
#> 111    DO   DOM 2021 9.424343e+10         2023-07-25
#> 112    LK   LKA 2021 8.849654e+10         2023-07-25
#> 113    OM   OMN 2021 8.819198e+10         2023-07-25
#> 114    GT   GTM 2021 8.605308e+10         2023-07-25
#> 115    LU   LUX 2021 8.550624e+10         2023-07-25
#> 116    BG   BGR 2021 8.406140e+10         2023-07-25
#> 117    GH   GHA 2021 7.915641e+10         2023-07-25
#> 118    S3   CSS 2021 7.567280e+10         2023-07-25
#> 119    CI   CIV 2021 7.181108e+10         2023-07-25
#> 120    TZ   TZA 2021 7.065563e+10         2023-07-25
#> 121    BY   BLR 2021 6.967375e+10         2023-07-25
#> 122    UZ   UZB 2021 6.960061e+10         2023-07-25
#> 123    HR   HRV 2021 6.884367e+10         2023-07-25
#> 124    PA   PAN 2021 6.740674e+10         2023-07-25
#> 125    LT   LTU 2021 6.641499e+10         2023-07-25
#> 126    AO   AGO 2021 6.568544e+10         2023-07-25
#> 127    MM   MMR 2021 6.512477e+10         2023-07-25
#> 128    CR   CRI 2021 6.461648e+10         2023-07-25
#> 129    RS   SRB 2021 6.308202e+10         2023-07-25
#> 130    SI   SVN 2021 6.174859e+10         2023-07-25
#> 131    UY   URY 2021 6.141227e+10         2023-07-25
#> 132    CD   COD 2021 5.535097e+10         2023-07-25
#> 133    AZ   AZE 2021 5.482541e+10         2023-07-25
#> 134    TN   TUN 2021 4.668730e+10         2023-07-25
#> 135    CM   CMR 2021 4.533829e+10         2023-07-25
#> 136    JO   JOR 2021 4.511632e+10         2023-07-25
#> 137    UG   UGA 2021 4.051024e+10         2023-07-25
#> 138    BO   BOL 2021 4.040821e+10         2023-07-25
#> 139    PY   PRY 2021 3.995090e+10         2023-07-25
#> 140    LY   LBY 2021 3.979842e+10         2023-07-25
#> 141    LV   LVA 2021 3.972538e+10         2023-07-25
#> 142    BH   BHR 2021 3.930340e+10         2023-07-25
#> 143    EE   EST 2021 3.719117e+10         2023-07-25
#> 144    NP   NPL 2021 3.692484e+10         2023-07-25
#> 145    SD   SDN 2021 3.422951e+10         2023-07-25
#> 146    MO   MAC 2021 3.012380e+10         2023-07-25
#> 147    SV   SLV 2021 2.945124e+10         2023-07-25
#> 148    HN   HND 2021 2.848872e+10         2023-07-25
#> 149    CY   CYP 2021 2.840806e+10         2023-07-25
#> 150    ZW   ZWE 2021 2.837124e+10         2023-07-25
#> 151    SN   SEN 2021 2.756914e+10         2023-07-25
#> 152    KH   KHM 2021 2.696106e+10         2023-07-25
#> 153    PG   PNG 2021 2.631166e+10         2023-07-25
#> 154    IS   ISL 2021 2.555264e+10         2023-07-25
#> 155    TT   TTO 2021 2.446020e+10         2023-07-25
#> 156    BA   BIH 2021 2.364957e+10         2023-07-25
#> 157    LB   LBN 2021 2.313194e+10         2023-07-25
#> 158    ZM   ZMB 2021 2.214765e+10         2023-07-25
#> 159    HT   HTI 2021 2.087741e+10         2023-07-25
#> 160    GA   GAB 2021 2.021795e+10         2023-07-25
#> 161    BF   BFA 2021 1.973762e+10         2023-07-25
#> 162    ML   MLI 2021 1.930946e+10         2023-07-25
#> 163    LA   LAO 2021 1.882715e+10         2023-07-25
#> 164    BW   BWA 2021 1.873707e+10         2023-07-25
#> 165    GE   GEO 2021 1.862937e+10         2023-07-25
#> 166    PS   PSE 2021 1.810900e+10         2023-07-25
#> 167    AL   ALB 2021 1.793057e+10         2023-07-25
#> 168    MT   MLT 2021 1.774338e+10         2023-07-25
#> 169    BJ   BEN 2021 1.769008e+10         2023-07-25
#> 170    GN   GIN 2021 1.609182e+10         2023-07-25
#> 171    MZ   MOZ 2021 1.577676e+10         2023-07-25
#> 172    MN   MNG 2021 1.528644e+10         2023-07-25
#> 173    NE   NER 2021 1.491500e+10         2023-07-25
#> 174    JM   JAM 2021 1.465759e+10         2023-07-25
#> 175    AF   AFG 2021 1.458314e+10         2023-07-25
#> 176    MG   MDG 2021 1.455475e+10         2023-07-25
#> 177    NI   NIC 2021 1.414585e+10         2023-07-25
#> 178    BN   BRN 2021 1.400650e+10         2023-07-25
#> 179    AM   ARM 2021 1.386141e+10         2023-07-25
#> 180    MK   MKD 2021 1.382505e+10         2023-07-25
#> 181    MD   MDA 2021 1.369223e+10         2023-07-25
#> 182    CG   COG 2021 1.336623e+10         2023-07-25
#> 183    MW   MWI 2021 1.260233e+10         2023-07-25
#> 184    NA   NAM 2021 1.244629e+10         2023-07-25
#> 185    GQ   GNQ 2021 1.226939e+10         2023-07-25
#> 186    TD   TCD 2021 1.177998e+10         2023-07-25
#> 187    JG   CHI 2021 1.173566e+10         2023-07-25
#> 188    BS   BHS 2021 1.152760e+10         2023-07-25
#> 189    MU   MUS 2021 1.147643e+10         2023-07-25
#> 190    RW   RWA 2021 1.105528e+10         2023-07-25
#> 191    NC   NCL 2021 1.007135e+10         2023-07-25
#> 192    MR   MRT 2021 9.996240e+09         2023-07-25
#> 193    S2   PSS 2021 9.475965e+09         2023-07-25
#> 194    XK   XKX 2021 9.412034e+09         2023-07-25
#> 195    TJ   TJK 2021 8.937805e+09         2023-07-25
#> 196    KG   KGZ 2021 8.740682e+09         2023-07-25
#> 197    MC   MCO 2021 8.596157e+09         2023-07-25
#> 198    TG   TGO 2021 8.334047e+09         2023-07-25
#> 199    GY   GUY 2021 8.044499e+09         2023-07-25
#> 200    SO   SOM 2021 7.628000e+09         2023-07-25
#> 201    LI   LIE 2021 7.186429e+09         2023-07-25
#> 202    BM   BMU 2021 7.127200e+09         2023-07-25
#> 203    GU   GUM 2021 6.123000e+09         2023-07-25
#> 204    PF   PYF 2021 6.080359e+09         2023-07-25
#> 205    KY   CYM 2021 6.028374e+09         2023-07-25
#> 206    ME   MNE 2021 5.861431e+09         2023-07-25
#> 207    MV   MDV 2021 5.405557e+09         2023-07-25
#> 208    BB   BRB 2021 4.843800e+09         2023-07-25
#> 209    SZ   SWZ 2021 4.748702e+09         2023-07-25
#> 210    FJ   FJI 2021 4.296235e+09         2023-07-25
#> 211    SL   SLE 2021 4.249235e+09         2023-07-25
#> 212    FO   FRO 2021 3.649879e+09         2023-07-25
#> 213    TL   TLS 2021 3.621222e+09         2023-07-25
#> 214    LR   LBR 2021 3.509000e+09         2023-07-25
#> 215    DJ   DJI 2021 3.372287e+09         2023-07-25
#> 216    AD   AND 2021 3.325145e+09         2023-07-25
#> 217    GL   GRL 2021 3.235816e+09         2023-07-25
#> 218    AW   ABW 2021 3.126019e+09         2023-07-25
#> 219    SR   SUR 2021 2.984706e+09         2023-07-25
#> 220    BI   BDI 2021 2.775799e+09         2023-07-25
#> 221    CW   CUW 2021 2.699612e+09         2023-07-25
#> 222    BT   BTN 2021 2.539551e+09         2023-07-25
#> 223    CF   CAF 2021 2.516498e+09         2023-07-25
#> 224    BZ   BLZ 2021 2.491500e+09         2023-07-25
#> 225    LS   LSO 2021 2.373416e+09         2023-07-25
#> 226    CV   CPV 2021 2.091742e+09         2023-07-25
#> 227    GM   GMB 2021 2.038415e+09         2023-07-25
#> 228    SM   SMR 2021 1.855383e+09         2023-07-25
#> 229    LC   LCA 2021 1.691259e+09         2023-07-25
#> 230    GW   GNB 2021 1.638518e+09         2023-07-25
#> 231    SB   SLB 2021 1.580304e+09         2023-07-25
#> 232    AG   ATG 2021 1.560519e+09         2023-07-25
#> 233    SX   SXM 2021 1.384637e+09         2023-07-25
#> 234    KM   COM 2021 1.296089e+09         2023-07-25
#> 235    SC   SYC 2021 1.286688e+09         2023-07-25
#> 236    GD   GRD 2021 1.122800e+09         2023-07-25
#> 237    TC   TCA 2021 1.044779e+09         2023-07-25
#> 238    VU   VUT 2021 9.716361e+08         2023-07-25
#> 239    VC   VCT 2021 8.722261e+08         2023-07-25
#> 240    KN   KNA 2021 8.608444e+08         2023-07-25
#> 241    WS   WSM 2021 8.438508e+08         2023-07-25
#> 242    AS   ASM 2021 7.090000e+08         2023-07-25
#> 243    DM   DMA 2021 5.552667e+08         2023-07-25
#> 244    ST   STP 2021 5.266538e+08         2023-07-25
#> 245    TO   TON 2021 4.692281e+08         2023-07-25
#> 246    FM   FSM 2021 4.040289e+08         2023-07-25
#> 247    MH   MHL 2021 2.595387e+08         2023-07-25
#> 248    KI   KIR 2021 2.276100e+08         2023-07-25
#> 249    PW   PLW 2021 2.178000e+08         2023-07-25
#> 250    NR   NRU 2021 1.455366e+08         2023-07-25
#> 251    TV   TUV 2021 6.019637e+07         2023-07-25
#>                         region             capital
#> 1                   Aggregates                    
#> 2                         <NA>                <NA>
#> 3                   Aggregates                    
#> 4                   Aggregates                    
#> 5                   Aggregates                    
#> 6                   Aggregates                    
#> 7                   Aggregates                    
#> 8                   Aggregates                    
#> 9                   Aggregates                    
#> 10                        <NA>                <NA>
#> 11                  Aggregates                    
#> 12                  Aggregates                    
#> 13                  Aggregates                    
#> 14               North America     Washington D.C.
#> 15                  Aggregates                    
#> 16                  Aggregates                    
#> 17         East Asia & Pacific             Beijing
#> 18                  Aggregates                    
#> 19                  Aggregates                    
#> 20                  Aggregates                    
#> 21                        <NA>                <NA>
#> 22                        <NA>                <NA>
#> 23                  Aggregates                    
#> 24         East Asia & Pacific               Tokyo
#> 25                  Aggregates                    
#> 26                  Aggregates                    
#> 27       Europe & Central Asia              Berlin
#> 28                  Aggregates                    
#> 29                  Aggregates                    
#> 30                  Aggregates                    
#> 31                  Aggregates                    
#> 32                  South Asia           New Delhi
#> 33       Europe & Central Asia              London
#> 34       Europe & Central Asia               Paris
#> 35                  Aggregates                    
#> 36                  Aggregates                    
#> 37       Europe & Central Asia                Rome
#> 38               North America              Ottawa
#> 39                        <NA>                <NA>
#> 40                  Aggregates                    
#> 41                  Aggregates                    
#> 42                  Aggregates                    
#> 43       Europe & Central Asia              Moscow
#> 44         East Asia & Pacific               Seoul
#> 45                  Aggregates                    
#> 46   Latin America & Caribbean            Brasilia
#> 47         East Asia & Pacific            Canberra
#> 48                  Aggregates                    
#> 49                  Aggregates                    
#> 50                  Aggregates                    
#> 51                  Aggregates                    
#> 52       Europe & Central Asia              Madrid
#> 53   Latin America & Caribbean         Mexico City
#> 54                  Aggregates                    
#> 55         East Asia & Pacific             Jakarta
#> 56                  Aggregates                    
#> 57                  Aggregates                    
#> 58       Europe & Central Asia           Amsterdam
#> 59                  Aggregates                    
#> 60  Middle East & North Africa              Riyadh
#> 61                  Aggregates                    
#> 62       Europe & Central Asia              Ankara
#> 63       Europe & Central Asia                Bern
#> 64       Europe & Central Asia              Warsaw
#> 65       Europe & Central Asia           Stockholm
#> 66       Europe & Central Asia            Brussels
#> 67                  Aggregates                    
#> 68         East Asia & Pacific             Bangkok
#> 69       Europe & Central Asia              Dublin
#> 70       Europe & Central Asia                Oslo
#> 71  Middle East & North Africa                    
#> 72   Latin America & Caribbean        Buenos Aires
#> 73       Europe & Central Asia              Vienna
#> 74                        <NA>                <NA>
#> 75                  Aggregates                    
#> 76          Sub-Saharan Africa               Abuja
#> 77  Middle East & North Africa               Cairo
#> 78         East Asia & Pacific           Singapore
#> 79          Sub-Saharan Africa            Pretoria
#> 80                  South Asia               Dhaka
#> 81  Middle East & North Africa           Abu Dhabi
#> 82       Europe & Central Asia          Copenhagen
#> 83         East Asia & Pacific              Manila
#> 84         East Asia & Pacific        Kuala Lumpur
#> 85         East Asia & Pacific                    
#> 86         East Asia & Pacific               Hanoi
#> 87  Middle East & North Africa              Tehran
#> 88                  South Asia           Islamabad
#> 89   Latin America & Caribbean              Bogota
#> 90   Latin America & Caribbean            Santiago
#> 91       Europe & Central Asia            Helsinki
#> 92       Europe & Central Asia           Bucharest
#> 93                        <NA>                <NA>
#> 94         East Asia & Pacific          Wellington
#> 95       Europe & Central Asia              Lisbon
#> 96   Latin America & Caribbean                Lima
#> 97       Europe & Central Asia              Athens
#> 98  Middle East & North Africa             Baghdad
#> 99       Europe & Central Asia                Kiev
#> 100      Europe & Central Asia              Astana
#> 101      Europe & Central Asia            Budapest
#> 102 Middle East & North Africa                Doha
#> 103 Middle East & North Africa             Algiers
#> 104 Middle East & North Africa               Rabat
#> 105 Middle East & North Africa         Kuwait City
#> 106      Europe & Central Asia          Bratislava
#> 107         Sub-Saharan Africa         Addis Ababa
#> 108         Sub-Saharan Africa             Nairobi
#> 109  Latin America & Caribbean            San Juan
#> 110  Latin America & Caribbean               Quito
#> 111  Latin America & Caribbean       Santo Domingo
#> 112                 South Asia             Colombo
#> 113 Middle East & North Africa              Muscat
#> 114  Latin America & Caribbean      Guatemala City
#> 115      Europe & Central Asia          Luxembourg
#> 116      Europe & Central Asia               Sofia
#> 117         Sub-Saharan Africa               Accra
#> 118                 Aggregates                    
#> 119         Sub-Saharan Africa        Yamoussoukro
#> 120         Sub-Saharan Africa              Dodoma
#> 121      Europe & Central Asia               Minsk
#> 122      Europe & Central Asia            Tashkent
#> 123      Europe & Central Asia              Zagreb
#> 124  Latin America & Caribbean         Panama City
#> 125      Europe & Central Asia             Vilnius
#> 126         Sub-Saharan Africa              Luanda
#> 127        East Asia & Pacific           Naypyidaw
#> 128  Latin America & Caribbean            San Jose
#> 129      Europe & Central Asia            Belgrade
#> 130      Europe & Central Asia           Ljubljana
#> 131  Latin America & Caribbean          Montevideo
#> 132         Sub-Saharan Africa            Kinshasa
#> 133      Europe & Central Asia                Baku
#> 134 Middle East & North Africa               Tunis
#> 135         Sub-Saharan Africa             Yaounde
#> 136 Middle East & North Africa               Amman
#> 137         Sub-Saharan Africa             Kampala
#> 138  Latin America & Caribbean              La Paz
#> 139  Latin America & Caribbean            Asuncion
#> 140 Middle East & North Africa             Tripoli
#> 141      Europe & Central Asia                Riga
#> 142 Middle East & North Africa              Manama
#> 143      Europe & Central Asia             Tallinn
#> 144                 South Asia           Kathmandu
#> 145         Sub-Saharan Africa            Khartoum
#> 146        East Asia & Pacific                    
#> 147  Latin America & Caribbean        San Salvador
#> 148  Latin America & Caribbean         Tegucigalpa
#> 149      Europe & Central Asia             Nicosia
#> 150         Sub-Saharan Africa              Harare
#> 151         Sub-Saharan Africa               Dakar
#> 152        East Asia & Pacific          Phnom Penh
#> 153        East Asia & Pacific        Port Moresby
#> 154      Europe & Central Asia           Reykjavik
#> 155  Latin America & Caribbean       Port-of-Spain
#> 156      Europe & Central Asia            Sarajevo
#> 157 Middle East & North Africa              Beirut
#> 158         Sub-Saharan Africa              Lusaka
#> 159  Latin America & Caribbean      Port-au-Prince
#> 160         Sub-Saharan Africa          Libreville
#> 161         Sub-Saharan Africa         Ouagadougou
#> 162         Sub-Saharan Africa              Bamako
#> 163        East Asia & Pacific           Vientiane
#> 164         Sub-Saharan Africa            Gaborone
#> 165      Europe & Central Asia             Tbilisi
#> 166 Middle East & North Africa                    
#> 167      Europe & Central Asia              Tirane
#> 168 Middle East & North Africa            Valletta
#> 169         Sub-Saharan Africa          Porto-Novo
#> 170         Sub-Saharan Africa             Conakry
#> 171         Sub-Saharan Africa              Maputo
#> 172        East Asia & Pacific         Ulaanbaatar
#> 173         Sub-Saharan Africa              Niamey
#> 174  Latin America & Caribbean            Kingston
#> 175                 South Asia               Kabul
#> 176         Sub-Saharan Africa        Antananarivo
#> 177  Latin America & Caribbean             Managua
#> 178        East Asia & Pacific Bandar Seri Begawan
#> 179      Europe & Central Asia             Yerevan
#> 180      Europe & Central Asia              Skopje
#> 181      Europe & Central Asia            Chisinau
#> 182         Sub-Saharan Africa         Brazzaville
#> 183         Sub-Saharan Africa            Lilongwe
#> 184         Sub-Saharan Africa            Windhoek
#> 185         Sub-Saharan Africa              Malabo
#> 186         Sub-Saharan Africa           N'Djamena
#> 187      Europe & Central Asia                    
#> 188  Latin America & Caribbean              Nassau
#> 189         Sub-Saharan Africa          Port Louis
#> 190         Sub-Saharan Africa              Kigali
#> 191        East Asia & Pacific             Noum'ea
#> 192         Sub-Saharan Africa          Nouakchott
#> 193                 Aggregates                    
#> 194      Europe & Central Asia            Pristina
#> 195      Europe & Central Asia            Dushanbe
#> 196      Europe & Central Asia             Bishkek
#> 197      Europe & Central Asia              Monaco
#> 198         Sub-Saharan Africa                Lome
#> 199  Latin America & Caribbean          Georgetown
#> 200         Sub-Saharan Africa           Mogadishu
#> 201      Europe & Central Asia               Vaduz
#> 202              North America            Hamilton
#> 203        East Asia & Pacific               Agana
#> 204        East Asia & Pacific             Papeete
#> 205  Latin America & Caribbean         George Town
#> 206      Europe & Central Asia           Podgorica
#> 207                 South Asia                Male
#> 208  Latin America & Caribbean          Bridgetown
#> 209         Sub-Saharan Africa             Mbabane
#> 210        East Asia & Pacific                Suva
#> 211         Sub-Saharan Africa            Freetown
#> 212      Europe & Central Asia            Torshavn
#> 213        East Asia & Pacific                Dili
#> 214         Sub-Saharan Africa            Monrovia
#> 215 Middle East & North Africa            Djibouti
#> 216      Europe & Central Asia    Andorra la Vella
#> 217      Europe & Central Asia                Nuuk
#> 218  Latin America & Caribbean          Oranjestad
#> 219  Latin America & Caribbean          Paramaribo
#> 220         Sub-Saharan Africa           Bujumbura
#> 221  Latin America & Caribbean          Willemstad
#> 222                 South Asia             Thimphu
#> 223         Sub-Saharan Africa              Bangui
#> 224  Latin America & Caribbean            Belmopan
#> 225         Sub-Saharan Africa              Maseru
#> 226         Sub-Saharan Africa               Praia
#> 227         Sub-Saharan Africa              Banjul
#> 228      Europe & Central Asia          San Marino
#> 229  Latin America & Caribbean            Castries
#> 230         Sub-Saharan Africa              Bissau
#> 231        East Asia & Pacific             Honiara
#> 232  Latin America & Caribbean        Saint John's
#> 233  Latin America & Caribbean         Philipsburg
#> 234         Sub-Saharan Africa              Moroni
#> 235         Sub-Saharan Africa            Victoria
#> 236  Latin America & Caribbean      Saint George's
#> 237  Latin America & Caribbean          Grand Turk
#> 238        East Asia & Pacific           Port-Vila
#> 239  Latin America & Caribbean           Kingstown
#> 240  Latin America & Caribbean          Basseterre
#> 241        East Asia & Pacific                Apia
#> 242        East Asia & Pacific           Pago Pago
#> 243  Latin America & Caribbean              Roseau
#> 244         Sub-Saharan Africa            Sao Tome
#> 245        East Asia & Pacific          Nuku'alofa
#> 246        East Asia & Pacific             Palikir
#> 247        East Asia & Pacific              Majuro
#> 248        East Asia & Pacific              Tarawa
#> 249        East Asia & Pacific               Koror
#> 250        East Asia & Pacific      Yaren District
#> 251        East Asia & Pacific            Funafuti
#>      longitude   latitude              income
#> 1                                  Aggregates
#> 2         <NA>       <NA>                <NA>
#> 3                                  Aggregates
#> 4                                  Aggregates
#> 5                                  Aggregates
#> 6                                  Aggregates
#> 7                                  Aggregates
#> 8                                  Aggregates
#> 9                                  Aggregates
#> 10        <NA>       <NA>                <NA>
#> 11                                 Aggregates
#> 12                                 Aggregates
#> 13                                 Aggregates
#> 14     -77.032    38.8895         High income
#> 15                                 Aggregates
#> 16                                 Aggregates
#> 17     116.286    40.0495 Upper middle income
#> 18                                 Aggregates
#> 19                                 Aggregates
#> 20                                 Aggregates
#> 21        <NA>       <NA>                <NA>
#> 22        <NA>       <NA>                <NA>
#> 23                                 Aggregates
#> 24      139.77      35.67         High income
#> 25                                 Aggregates
#> 26                                 Aggregates
#> 27     13.4115    52.5235         High income
#> 28                                 Aggregates
#> 29                                 Aggregates
#> 30                                 Aggregates
#> 31                                 Aggregates
#> 32      77.225    28.6353 Lower middle income
#> 33   -0.126236    51.5002         High income
#> 34     2.35097    48.8566         High income
#> 35                                 Aggregates
#> 36                                 Aggregates
#> 37     12.4823    41.8955         High income
#> 38    -75.6919    45.4215         High income
#> 39        <NA>       <NA>                <NA>
#> 40                                 Aggregates
#> 41                                 Aggregates
#> 42                                 Aggregates
#> 43     37.6176    55.7558 Upper middle income
#> 44     126.957    37.5323         High income
#> 45                                 Aggregates
#> 46    -47.9292   -15.7801 Upper middle income
#> 47     149.129    -35.282         High income
#> 48                                 Aggregates
#> 49                                 Aggregates
#> 50                                 Aggregates
#> 51                                 Aggregates
#> 52    -3.70327    40.4167         High income
#> 53    -99.1276     19.427 Upper middle income
#> 54                                 Aggregates
#> 55      106.83   -6.19752 Lower middle income
#> 56                                 Aggregates
#> 57                                 Aggregates
#> 58     4.89095    52.3738         High income
#> 59                                 Aggregates
#> 60     46.6977    24.6748         High income
#> 61                                 Aggregates
#> 62     32.3606    39.7153 Upper middle income
#> 63     7.44821     46.948         High income
#> 64       21.02      52.26         High income
#> 65     18.0645    59.3327         High income
#> 66     4.36761    50.8371         High income
#> 67                                 Aggregates
#> 68     100.521    13.7308 Upper middle income
#> 69    -6.26749    53.3441         High income
#> 70     10.7387    59.9138         High income
#> 71     35.2035    31.7717         High income
#> 72    -58.4173   -34.6118 Upper middle income
#> 73     16.3798    48.2201         High income
#> 74        <NA>       <NA>                <NA>
#> 75                                 Aggregates
#> 76     7.48906    9.05804 Lower middle income
#> 77     31.2461    30.0982 Lower middle income
#> 78      103.85    1.28941         High income
#> 79     28.1871    -25.746 Upper middle income
#> 80     90.4113    23.7055 Lower middle income
#> 81     54.3705    24.4764         High income
#> 82     12.5681    55.6763         High income
#> 83     121.035    14.5515 Lower middle income
#> 84     101.684    3.12433 Upper middle income
#> 85     114.109    22.3964         High income
#> 86     105.825    21.0069 Lower middle income
#> 87     51.4447    35.6878 Lower middle income
#> 88        72.8    30.5167 Lower middle income
#> 89     -74.082    4.60987 Upper middle income
#> 90    -70.6475    -33.475         High income
#> 91     24.9525    60.1608         High income
#> 92     26.0979    44.4479         High income
#> 93        <NA>       <NA>                <NA>
#> 94     174.776   -41.2865         High income
#> 95    -9.13552    38.7072         High income
#> 96    -77.0465   -12.0931 Upper middle income
#> 97     23.7166    37.9792         High income
#> 98      44.394    33.3302 Upper middle income
#> 99     30.5038    50.4536 Lower middle income
#> 100    71.4382    51.1879 Upper middle income
#> 101    19.0408    47.4984         High income
#> 102    51.5082    25.2948         High income
#> 103    3.05097    36.7397 Lower middle income
#> 104    -6.8704    33.9905 Lower middle income
#> 105    47.9824    29.3721         High income
#> 106    17.1073    48.1484         High income
#> 107    38.7468    9.02274          Low income
#> 108    36.8126   -1.27975 Lower middle income
#> 109        -66      18.23         High income
#> 110   -78.5243  -0.229498 Upper middle income
#> 111   -69.8908     18.479 Upper middle income
#> 112    79.8528    6.92148 Lower middle income
#> 113    58.5874    23.6105         High income
#> 114   -90.5328    14.6248 Upper middle income
#> 115     6.1296      49.61         High income
#> 116    23.3238    42.7105 Upper middle income
#> 117   -0.20795    5.57045 Lower middle income
#> 118                                Aggregates
#> 119    -4.0305      5.332 Lower middle income
#> 120    35.7382   -6.17486 Lower middle income
#> 121    27.5766    53.9678 Upper middle income
#> 122     69.269    41.3052 Lower middle income
#> 123    15.9614    45.8069         High income
#> 124   -79.5188    8.99427         High income
#> 125    25.2799    54.6896         High income
#> 126     13.242   -8.81155 Lower middle income
#> 127    95.9562     21.914 Lower middle income
#> 128   -84.0089    9.63701 Upper middle income
#> 129    20.4656    44.8024 Upper middle income
#> 130    14.5044    46.0546         High income
#> 131   -56.0675   -34.8941         High income
#> 132    15.3222     -4.325          Low income
#> 133    49.8932    40.3834 Upper middle income
#> 134      10.21    36.7899 Lower middle income
#> 135    11.5174     3.8721 Lower middle income
#> 136    35.9263    31.9497 Upper middle income
#> 137    32.5729   0.314269          Low income
#> 138   -66.1936   -13.9908 Lower middle income
#> 139   -57.6362   -25.3005 Upper middle income
#> 140    13.1072    32.8578 Upper middle income
#> 141    24.1048    56.9465         High income
#> 142    50.5354    26.1921         High income
#> 143    24.7586    59.4392         High income
#> 144    85.3157    27.6939 Lower middle income
#> 145    32.5363    15.5932          Low income
#> 146     113.55    22.1667         High income
#> 147   -89.2073    13.7034 Lower middle income
#> 148   -87.4667    15.1333 Lower middle income
#> 149    33.3736    35.1676         High income
#> 150    31.0672   -17.8312 Lower middle income
#> 151   -17.4734    14.7247 Lower middle income
#> 152    104.874    11.5556 Lower middle income
#> 153    147.194   -9.47357 Lower middle income
#> 154   -21.8952    64.1353         High income
#> 155   -61.4789    10.6596         High income
#> 156    18.4214    43.8607 Upper middle income
#> 157    35.5134    33.8872 Lower middle income
#> 158    28.2937   -15.3982          Low income
#> 159   -72.3288    18.5392 Lower middle income
#> 160    9.45162    0.38832 Upper middle income
#> 161   -1.53395    12.3605          Low income
#> 162   -7.50034    13.5667          Low income
#> 163    102.177    18.5826 Lower middle income
#> 164    25.9201   -24.6544 Upper middle income
#> 165     44.793      41.71 Upper middle income
#> 166                       Lower middle income
#> 167    19.8172    41.3317 Upper middle income
#> 168    14.5189    35.9042         High income
#> 169     2.6323     6.4779 Lower middle income
#> 170      -13.7    9.51667          Low income
#> 171    32.5713   -25.9664          Low income
#> 172    106.937    47.9129 Lower middle income
#> 173     2.1073     13.514          Low income
#> 174    -76.792    17.9927 Upper middle income
#> 175    69.1761    34.5228          Low income
#> 176    45.7167   -20.4667          Low income
#> 177   -86.2734    12.1475 Lower middle income
#> 178    114.946    4.94199         High income
#> 179     44.509    40.1596 Upper middle income
#> 180    21.4361    42.0024 Upper middle income
#> 181    28.8497    47.0167 Upper middle income
#> 182    15.2662    -4.2767 Lower middle income
#> 183    33.7703   -13.9899          Low income
#> 184    17.0931   -22.5648 Upper middle income
#> 185     8.7741     3.7523 Upper middle income
#> 186    15.0445    12.1048          Low income
#> 187                               High income
#> 188    -77.339    25.0661         High income
#> 189    57.4977   -20.1605 Upper middle income
#> 190    30.0587   -1.95325          Low income
#> 191    166.464   -22.2677         High income
#> 192   -15.9824    18.2367 Lower middle income
#> 193                                Aggregates
#> 194     20.926     42.565 Upper middle income
#> 195    68.7864    38.5878 Lower middle income
#> 196    74.6057    42.8851 Lower middle income
#> 197    7.41891    43.7325         High income
#> 198     1.2255     6.1228          Low income
#> 199   -58.1548    6.80461 Upper middle income
#> 200    45.3254    2.07515          Low income
#> 201    9.52148    47.1411         High income
#> 202    -64.706    32.3293         High income
#> 203    144.794    13.4443         High income
#> 204    -149.57    -17.535         High income
#> 205   -81.3857    19.3022         High income
#> 206    19.2595    42.4602 Upper middle income
#> 207    73.5109     4.1742 Upper middle income
#> 208   -59.6105    13.0935         High income
#> 209    31.4659   -26.5225 Lower middle income
#> 210    178.399   -18.1149 Upper middle income
#> 211   -13.2134     8.4821          Low income
#> 212   -6.91181    61.8926         High income
#> 213    125.567   -8.56667 Lower middle income
#> 214   -10.7957    6.30039          Low income
#> 215    43.1425    11.5806 Lower middle income
#> 216     1.5218    42.5075         High income
#> 217   -51.7214    64.1836         High income
#> 218   -70.0167    12.5167         High income
#> 219   -55.1679     5.8232 Upper middle income
#> 220    29.3639    -3.3784          Low income
#> 221                               High income
#> 222    89.6177    27.5768 Lower middle income
#> 223    21.6407    5.63056          Low income
#> 224   -88.7713    17.2534 Upper middle income
#> 225    27.7167   -29.5208 Lower middle income
#> 226   -23.5087    14.9218 Lower middle income
#> 227   -16.5885    13.4495          Low income
#> 228    12.4486    43.9322         High income
#> 229   -60.9832         14 Upper middle income
#> 230   -15.1804    11.8037          Low income
#> 231    159.949   -9.42676 Lower middle income
#> 232   -61.8456    17.1175         High income
#> 233                               High income
#> 234    43.2418   -11.6986 Lower middle income
#> 235    55.4466    -4.6309         High income
#> 236   -61.7449    12.0653 Upper middle income
#> 237 -71.141389 21.4602778         High income
#> 238    168.321   -17.7404 Lower middle income
#> 239   -61.2653    13.2035 Upper middle income
#> 240   -62.7309       17.3         High income
#> 241   -171.752   -13.8314 Lower middle income
#> 242   -170.691   -14.2846 Upper middle income
#> 243     -61.39    15.2976 Upper middle income
#> 244     6.6071    0.20618 Lower middle income
#> 245   -175.216    -21.136 Upper middle income
#> 246    158.185    6.91771 Lower middle income
#> 247    171.135    7.11046 Upper middle income
#> 248    172.979    1.32905 Lower middle income
#> 249    134.479    7.34194 Upper middle income
#> 250 166.920867    -0.5477         High income
#> 251 179.089567 -8.6314877 Upper middle income
#>            lending
#> 1       Aggregates
#> 2             <NA>
#> 3       Aggregates
#> 4       Aggregates
#> 5       Aggregates
#> 6       Aggregates
#> 7       Aggregates
#> 8       Aggregates
#> 9       Aggregates
#> 10            <NA>
#> 11      Aggregates
#> 12      Aggregates
#> 13      Aggregates
#> 14  Not classified
#> 15      Aggregates
#> 16      Aggregates
#> 17            IBRD
#> 18      Aggregates
#> 19      Aggregates
#> 20      Aggregates
#> 21            <NA>
#> 22            <NA>
#> 23      Aggregates
#> 24  Not classified
#> 25      Aggregates
#> 26      Aggregates
#> 27  Not classified
#> 28      Aggregates
#> 29      Aggregates
#> 30      Aggregates
#> 31      Aggregates
#> 32            IBRD
#> 33  Not classified
#> 34  Not classified
#> 35      Aggregates
#> 36      Aggregates
#> 37  Not classified
#> 38  Not classified
#> 39            <NA>
#> 40      Aggregates
#> 41      Aggregates
#> 42      Aggregates
#> 43            IBRD
#> 44  Not classified
#> 45      Aggregates
#> 46            IBRD
#> 47  Not classified
#> 48      Aggregates
#> 49      Aggregates
#> 50      Aggregates
#> 51      Aggregates
#> 52  Not classified
#> 53            IBRD
#> 54      Aggregates
#> 55            IBRD
#> 56      Aggregates
#> 57      Aggregates
#> 58  Not classified
#> 59      Aggregates
#> 60  Not classified
#> 61      Aggregates
#> 62            IBRD
#> 63  Not classified
#> 64            IBRD
#> 65  Not classified
#> 66  Not classified
#> 67      Aggregates
#> 68            IBRD
#> 69  Not classified
#> 70  Not classified
#> 71  Not classified
#> 72            IBRD
#> 73  Not classified
#> 74            <NA>
#> 75      Aggregates
#> 76           Blend
#> 77            IBRD
#> 78  Not classified
#> 79            IBRD
#> 80             IDA
#> 81  Not classified
#> 82  Not classified
#> 83            IBRD
#> 84            IBRD
#> 85  Not classified
#> 86            IBRD
#> 87            IBRD
#> 88           Blend
#> 89            IBRD
#> 90            IBRD
#> 91  Not classified
#> 92            IBRD
#> 93            <NA>
#> 94  Not classified
#> 95  Not classified
#> 96            IBRD
#> 97  Not classified
#> 98            IBRD
#> 99            IBRD
#> 100           IBRD
#> 101 Not classified
#> 102 Not classified
#> 103           IBRD
#> 104           IBRD
#> 105 Not classified
#> 106 Not classified
#> 107            IDA
#> 108          Blend
#> 109 Not classified
#> 110           IBRD
#> 111           IBRD
#> 112           IBRD
#> 113 Not classified
#> 114           IBRD
#> 115 Not classified
#> 116           IBRD
#> 117            IDA
#> 118     Aggregates
#> 119            IDA
#> 120            IDA
#> 121           IBRD
#> 122          Blend
#> 123           IBRD
#> 124           IBRD
#> 125 Not classified
#> 126           IBRD
#> 127            IDA
#> 128           IBRD
#> 129           IBRD
#> 130 Not classified
#> 131           IBRD
#> 132            IDA
#> 133           IBRD
#> 134           IBRD
#> 135          Blend
#> 136           IBRD
#> 137            IDA
#> 138           IBRD
#> 139           IBRD
#> 140           IBRD
#> 141 Not classified
#> 142 Not classified
#> 143 Not classified
#> 144            IDA
#> 145            IDA
#> 146 Not classified
#> 147           IBRD
#> 148            IDA
#> 149 Not classified
#> 150          Blend
#> 151            IDA
#> 152            IDA
#> 153          Blend
#> 154 Not classified
#> 155           IBRD
#> 156           IBRD
#> 157           IBRD
#> 158            IDA
#> 159            IDA
#> 160           IBRD
#> 161            IDA
#> 162            IDA
#> 163            IDA
#> 164           IBRD
#> 165           IBRD
#> 166 Not classified
#> 167           IBRD
#> 168 Not classified
#> 169            IDA
#> 170            IDA
#> 171            IDA
#> 172           IBRD
#> 173            IDA
#> 174           IBRD
#> 175            IDA
#> 176            IDA
#> 177            IDA
#> 178 Not classified
#> 179           IBRD
#> 180           IBRD
#> 181           IBRD
#> 182          Blend
#> 183            IDA
#> 184           IBRD
#> 185           IBRD
#> 186            IDA
#> 187 Not classified
#> 188 Not classified
#> 189           IBRD
#> 190            IDA
#> 191 Not classified
#> 192            IDA
#> 193     Aggregates
#> 194            IDA
#> 195            IDA
#> 196            IDA
#> 197 Not classified
#> 198            IDA
#> 199            IDA
#> 200            IDA
#> 201 Not classified
#> 202 Not classified
#> 203 Not classified
#> 204 Not classified
#> 205 Not classified
#> 206           IBRD
#> 207            IDA
#> 208 Not classified
#> 209           IBRD
#> 210          Blend
#> 211            IDA
#> 212 Not classified
#> 213          Blend
#> 214            IDA
#> 215            IDA
#> 216 Not classified
#> 217 Not classified
#> 218 Not classified
#> 219           IBRD
#> 220            IDA
#> 221 Not classified
#> 222            IDA
#> 223            IDA
#> 224           IBRD
#> 225            IDA
#> 226          Blend
#> 227            IDA
#> 228 Not classified
#> 229          Blend
#> 230            IDA
#> 231            IDA
#> 232           IBRD
#> 233 Not classified
#> 234            IDA
#> 235           IBRD
#> 236          Blend
#> 237 Not classified
#> 238            IDA
#> 239          Blend
#> 240           IBRD
#> 241            IDA
#> 242 Not classified
#> 243          Blend
#> 244            IDA
#> 245            IDA
#> 246            IDA
#> 247            IDA
#> 248            IDA
#> 249           IBRD
#> 250           IBRD
#> 251            IDA
```

#### 2021年のGDPの降順での表示（２）

最初に、World と表示され、グループや、カテゴリーのデータもあるようですから、それを、まず、削除することが必要です。`region` の列を見ると、World などは、Aggregates となっているので、そのようなものを削除すればよさそうです。数値の大きい順に並べたいので、`desc` 降順（descending order）にします。


```r
df_gdp %>% filter(year == 2021, region != "Aggregates") %>% 
  drop_na(gdp) %>% arrange(desc(gdp))
#>                            country iso2c iso3c year
#> 1                    United States    US   USA 2021
#> 2                            China    CN   CHN 2021
#> 3                            Japan    JP   JPN 2021
#> 4                          Germany    DE   DEU 2021
#> 5                            India    IN   IND 2021
#> 6                   United Kingdom    GB   GBR 2021
#> 7                           France    FR   FRA 2021
#> 8                            Italy    IT   ITA 2021
#> 9                           Canada    CA   CAN 2021
#> 10              Russian Federation    RU   RUS 2021
#> 11                     Korea, Rep.    KR   KOR 2021
#> 12                          Brazil    BR   BRA 2021
#> 13                       Australia    AU   AUS 2021
#> 14                           Spain    ES   ESP 2021
#> 15                          Mexico    MX   MEX 2021
#> 16                       Indonesia    ID   IDN 2021
#> 17                     Netherlands    NL   NLD 2021
#> 18                    Saudi Arabia    SA   SAU 2021
#> 19                         Turkiye    TR   TUR 2021
#> 20                     Switzerland    CH   CHE 2021
#> 21                          Poland    PL   POL 2021
#> 22                          Sweden    SE   SWE 2021
#> 23                         Belgium    BE   BEL 2021
#> 24                        Thailand    TH   THA 2021
#> 25                         Ireland    IE   IRL 2021
#> 26                          Norway    NO   NOR 2021
#> 27                          Israel    IL   ISR 2021
#> 28                       Argentina    AR   ARG 2021
#> 29                         Austria    AT   AUT 2021
#> 30                         Nigeria    NG   NGA 2021
#> 31                Egypt, Arab Rep.    EG   EGY 2021
#> 32                       Singapore    SG   SGP 2021
#> 33                    South Africa    ZA   ZAF 2021
#> 34                      Bangladesh    BD   BGD 2021
#> 35            United Arab Emirates    AE   ARE 2021
#> 36                         Denmark    DK   DNK 2021
#> 37                     Philippines    PH   PHL 2021
#> 38                        Malaysia    MY   MYS 2021
#> 39            Hong Kong SAR, China    HK   HKG 2021
#> 40                         Vietnam    VN   VNM 2021
#> 41              Iran, Islamic Rep.    IR   IRN 2021
#> 42                        Pakistan    PK   PAK 2021
#> 43                        Colombia    CO   COL 2021
#> 44                           Chile    CL   CHL 2021
#> 45                         Finland    FI   FIN 2021
#> 46                         Romania    RO   ROU 2021
#> 47                     New Zealand    NZ   NZL 2021
#> 48                        Portugal    PT   PRT 2021
#> 49                            Peru    PE   PER 2021
#> 50                          Greece    GR   GRC 2021
#> 51                            Iraq    IQ   IRQ 2021
#> 52                         Ukraine    UA   UKR 2021
#> 53                      Kazakhstan    KZ   KAZ 2021
#> 54                         Hungary    HU   HUN 2021
#> 55                           Qatar    QA   QAT 2021
#> 56                         Algeria    DZ   DZA 2021
#> 57                         Morocco    MA   MAR 2021
#> 58                          Kuwait    KW   KWT 2021
#> 59                 Slovak Republic    SK   SVK 2021
#> 60                        Ethiopia    ET   ETH 2021
#> 61                           Kenya    KE   KEN 2021
#> 62                     Puerto Rico    PR   PRI 2021
#> 63                         Ecuador    EC   ECU 2021
#> 64              Dominican Republic    DO   DOM 2021
#> 65                       Sri Lanka    LK   LKA 2021
#> 66                            Oman    OM   OMN 2021
#> 67                       Guatemala    GT   GTM 2021
#> 68                      Luxembourg    LU   LUX 2021
#> 69                        Bulgaria    BG   BGR 2021
#> 70                           Ghana    GH   GHA 2021
#> 71                   Cote d'Ivoire    CI   CIV 2021
#> 72                        Tanzania    TZ   TZA 2021
#> 73                         Belarus    BY   BLR 2021
#> 74                      Uzbekistan    UZ   UZB 2021
#> 75                         Croatia    HR   HRV 2021
#> 76                          Panama    PA   PAN 2021
#> 77                       Lithuania    LT   LTU 2021
#> 78                          Angola    AO   AGO 2021
#> 79                         Myanmar    MM   MMR 2021
#> 80                      Costa Rica    CR   CRI 2021
#> 81                          Serbia    RS   SRB 2021
#> 82                        Slovenia    SI   SVN 2021
#> 83                         Uruguay    UY   URY 2021
#> 84                Congo, Dem. Rep.    CD   COD 2021
#> 85                      Azerbaijan    AZ   AZE 2021
#> 86                         Tunisia    TN   TUN 2021
#> 87                        Cameroon    CM   CMR 2021
#> 88                          Jordan    JO   JOR 2021
#> 89                          Uganda    UG   UGA 2021
#> 90                         Bolivia    BO   BOL 2021
#> 91                        Paraguay    PY   PRY 2021
#> 92                           Libya    LY   LBY 2021
#> 93                          Latvia    LV   LVA 2021
#> 94                         Bahrain    BH   BHR 2021
#> 95                         Estonia    EE   EST 2021
#> 96                           Nepal    NP   NPL 2021
#> 97                           Sudan    SD   SDN 2021
#> 98                Macao SAR, China    MO   MAC 2021
#> 99                     El Salvador    SV   SLV 2021
#> 100                       Honduras    HN   HND 2021
#> 101                         Cyprus    CY   CYP 2021
#> 102                       Zimbabwe    ZW   ZWE 2021
#> 103                        Senegal    SN   SEN 2021
#> 104                       Cambodia    KH   KHM 2021
#> 105               Papua New Guinea    PG   PNG 2021
#> 106                        Iceland    IS   ISL 2021
#> 107            Trinidad and Tobago    TT   TTO 2021
#> 108         Bosnia and Herzegovina    BA   BIH 2021
#> 109                        Lebanon    LB   LBN 2021
#> 110                         Zambia    ZM   ZMB 2021
#> 111                          Haiti    HT   HTI 2021
#> 112                          Gabon    GA   GAB 2021
#> 113                   Burkina Faso    BF   BFA 2021
#> 114                           Mali    ML   MLI 2021
#> 115                        Lao PDR    LA   LAO 2021
#> 116                       Botswana    BW   BWA 2021
#> 117                        Georgia    GE   GEO 2021
#> 118             West Bank and Gaza    PS   PSE 2021
#> 119                        Albania    AL   ALB 2021
#> 120                          Malta    MT   MLT 2021
#> 121                          Benin    BJ   BEN 2021
#> 122                         Guinea    GN   GIN 2021
#> 123                     Mozambique    MZ   MOZ 2021
#> 124                       Mongolia    MN   MNG 2021
#> 125                          Niger    NE   NER 2021
#> 126                        Jamaica    JM   JAM 2021
#> 127                    Afghanistan    AF   AFG 2021
#> 128                     Madagascar    MG   MDG 2021
#> 129                      Nicaragua    NI   NIC 2021
#> 130              Brunei Darussalam    BN   BRN 2021
#> 131                        Armenia    AM   ARM 2021
#> 132                North Macedonia    MK   MKD 2021
#> 133                        Moldova    MD   MDA 2021
#> 134                    Congo, Rep.    CG   COG 2021
#> 135                         Malawi    MW   MWI 2021
#> 136                        Namibia    NA   NAM 2021
#> 137              Equatorial Guinea    GQ   GNQ 2021
#> 138                           Chad    TD   TCD 2021
#> 139                Channel Islands    JG   CHI 2021
#> 140                   Bahamas, The    BS   BHS 2021
#> 141                      Mauritius    MU   MUS 2021
#> 142                         Rwanda    RW   RWA 2021
#> 143                  New Caledonia    NC   NCL 2021
#> 144                     Mauritania    MR   MRT 2021
#> 145                         Kosovo    XK   XKX 2021
#> 146                     Tajikistan    TJ   TJK 2021
#> 147                Kyrgyz Republic    KG   KGZ 2021
#> 148                         Monaco    MC   MCO 2021
#> 149                           Togo    TG   TGO 2021
#> 150                         Guyana    GY   GUY 2021
#> 151                        Somalia    SO   SOM 2021
#> 152                  Liechtenstein    LI   LIE 2021
#> 153                        Bermuda    BM   BMU 2021
#> 154                           Guam    GU   GUM 2021
#> 155               French Polynesia    PF   PYF 2021
#> 156                 Cayman Islands    KY   CYM 2021
#> 157                     Montenegro    ME   MNE 2021
#> 158                       Maldives    MV   MDV 2021
#> 159                       Barbados    BB   BRB 2021
#> 160                       Eswatini    SZ   SWZ 2021
#> 161                           Fiji    FJ   FJI 2021
#> 162                   Sierra Leone    SL   SLE 2021
#> 163                  Faroe Islands    FO   FRO 2021
#> 164                    Timor-Leste    TL   TLS 2021
#> 165                        Liberia    LR   LBR 2021
#> 166                       Djibouti    DJ   DJI 2021
#> 167                        Andorra    AD   AND 2021
#> 168                      Greenland    GL   GRL 2021
#> 169                          Aruba    AW   ABW 2021
#> 170                       Suriname    SR   SUR 2021
#> 171                        Burundi    BI   BDI 2021
#> 172                        Curacao    CW   CUW 2021
#> 173                         Bhutan    BT   BTN 2021
#> 174       Central African Republic    CF   CAF 2021
#> 175                         Belize    BZ   BLZ 2021
#> 176                        Lesotho    LS   LSO 2021
#> 177                     Cabo Verde    CV   CPV 2021
#> 178                    Gambia, The    GM   GMB 2021
#> 179                     San Marino    SM   SMR 2021
#> 180                      St. Lucia    LC   LCA 2021
#> 181                  Guinea-Bissau    GW   GNB 2021
#> 182                Solomon Islands    SB   SLB 2021
#> 183            Antigua and Barbuda    AG   ATG 2021
#> 184      Sint Maarten (Dutch part)    SX   SXM 2021
#> 185                        Comoros    KM   COM 2021
#> 186                     Seychelles    SC   SYC 2021
#> 187                        Grenada    GD   GRD 2021
#> 188       Turks and Caicos Islands    TC   TCA 2021
#> 189                        Vanuatu    VU   VUT 2021
#> 190 St. Vincent and the Grenadines    VC   VCT 2021
#> 191            St. Kitts and Nevis    KN   KNA 2021
#> 192                          Samoa    WS   WSM 2021
#> 193                 American Samoa    AS   ASM 2021
#> 194                       Dominica    DM   DMA 2021
#> 195          Sao Tome and Principe    ST   STP 2021
#> 196                          Tonga    TO   TON 2021
#> 197          Micronesia, Fed. Sts.    FM   FSM 2021
#> 198               Marshall Islands    MH   MHL 2021
#> 199                       Kiribati    KI   KIR 2021
#> 200                          Palau    PW   PLW 2021
#> 201                          Nauru    NR   NRU 2021
#> 202                         Tuvalu    TV   TUV 2021
#>              gdp status lastupdated
#> 1   2.331508e+13         2023-07-25
#> 2   1.782046e+13         2023-07-25
#> 3   5.005537e+12         2023-07-25
#> 4   4.259935e+12         2023-07-25
#> 5   3.150307e+12         2023-07-25
#> 6   3.122480e+12         2023-07-25
#> 7   2.957880e+12         2023-07-25
#> 8   2.114356e+12         2023-07-25
#> 9   2.001487e+12         2023-07-25
#> 10  1.836892e+12         2023-07-25
#> 11  1.810956e+12         2023-07-25
#> 12  1.649623e+12         2023-07-25
#> 13  1.552703e+12         2023-07-25
#> 14  1.427381e+12         2023-07-25
#> 15  1.272839e+12         2023-07-25
#> 16  1.186505e+12         2023-07-25
#> 17  1.011799e+12         2023-07-25
#> 18  8.685859e+11         2023-07-25
#> 19  8.190345e+11         2023-07-25
#> 20  8.006402e+11         2023-07-25
#> 21  6.794419e+11         2023-07-25
#> 22  6.368562e+11         2023-07-25
#> 23  5.943520e+11         2023-07-25
#> 24  5.055681e+11         2023-07-25
#> 25  5.041826e+11         2023-07-25
#> 26  4.902934e+11         2023-07-25
#> 27  4.885265e+11         2023-07-25
#> 28  4.872271e+11         2023-07-25
#> 29  4.803684e+11         2023-07-25
#> 30  4.408336e+11         2023-07-25
#> 31  4.246718e+11         2023-07-25
#> 32  4.237970e+11         2023-07-25
#> 33  4.190156e+11         2023-07-25
#> 34  4.162648e+11         2023-07-25
#> 35  4.150216e+11         2023-07-25
#> 36  3.983033e+11         2023-07-25
#> 37  3.940874e+11         2023-07-25
#> 38  3.729811e+11         2023-07-25
#> 39  3.689114e+11         2023-07-25
#> 40  3.661376e+11         2023-07-25
#> 41  3.590969e+11         2023-07-25
#> 42  3.482625e+11         2023-07-25
#> 43  3.185118e+11         2023-07-25
#> 44  3.167136e+11         2023-07-25
#> 45  2.963876e+11         2023-07-25
#> 46  2.854047e+11         2023-07-25
#> 47  2.555517e+11         2023-07-25
#> 48  2.539828e+11         2023-07-25
#> 49  2.237178e+11         2023-07-25
#> 50  2.148739e+11         2023-07-25
#> 51  2.076916e+11         2023-07-25
#> 52  1.997659e+11         2023-07-25
#> 53  1.971123e+11         2023-07-25
#> 54  1.822754e+11         2023-07-25
#> 55  1.796771e+11         2023-07-25
#> 56  1.634722e+11         2023-07-25
#> 57  1.428666e+11         2023-07-25
#> 58  1.367974e+11         2023-07-25
#> 59  1.186566e+11         2023-07-25
#> 60  1.112619e+11         2023-07-25
#> 61  1.097037e+11         2023-07-25
#> 62  1.063689e+11         2023-07-25
#> 63  1.061659e+11         2023-07-25
#> 64  9.424343e+10         2023-07-25
#> 65  8.849654e+10         2023-07-25
#> 66  8.819198e+10         2023-07-25
#> 67  8.605308e+10         2023-07-25
#> 68  8.550624e+10         2023-07-25
#> 69  8.406140e+10         2023-07-25
#> 70  7.915641e+10         2023-07-25
#> 71  7.181108e+10         2023-07-25
#> 72  7.065563e+10         2023-07-25
#> 73  6.967375e+10         2023-07-25
#> 74  6.960061e+10         2023-07-25
#> 75  6.884367e+10         2023-07-25
#> 76  6.740674e+10         2023-07-25
#> 77  6.641499e+10         2023-07-25
#> 78  6.568544e+10         2023-07-25
#> 79  6.512477e+10         2023-07-25
#> 80  6.461648e+10         2023-07-25
#> 81  6.308202e+10         2023-07-25
#> 82  6.174859e+10         2023-07-25
#> 83  6.141227e+10         2023-07-25
#> 84  5.535097e+10         2023-07-25
#> 85  5.482541e+10         2023-07-25
#> 86  4.668730e+10         2023-07-25
#> 87  4.533829e+10         2023-07-25
#> 88  4.511632e+10         2023-07-25
#> 89  4.051024e+10         2023-07-25
#> 90  4.040821e+10         2023-07-25
#> 91  3.995090e+10         2023-07-25
#> 92  3.979842e+10         2023-07-25
#> 93  3.972538e+10         2023-07-25
#> 94  3.930340e+10         2023-07-25
#> 95  3.719117e+10         2023-07-25
#> 96  3.692484e+10         2023-07-25
#> 97  3.422951e+10         2023-07-25
#> 98  3.012380e+10         2023-07-25
#> 99  2.945124e+10         2023-07-25
#> 100 2.848872e+10         2023-07-25
#> 101 2.840806e+10         2023-07-25
#> 102 2.837124e+10         2023-07-25
#> 103 2.756914e+10         2023-07-25
#> 104 2.696106e+10         2023-07-25
#> 105 2.631166e+10         2023-07-25
#> 106 2.555264e+10         2023-07-25
#> 107 2.446020e+10         2023-07-25
#> 108 2.364957e+10         2023-07-25
#> 109 2.313194e+10         2023-07-25
#> 110 2.214765e+10         2023-07-25
#> 111 2.087741e+10         2023-07-25
#> 112 2.021795e+10         2023-07-25
#> 113 1.973762e+10         2023-07-25
#> 114 1.930946e+10         2023-07-25
#> 115 1.882715e+10         2023-07-25
#> 116 1.873707e+10         2023-07-25
#> 117 1.862937e+10         2023-07-25
#> 118 1.810900e+10         2023-07-25
#> 119 1.793057e+10         2023-07-25
#> 120 1.774338e+10         2023-07-25
#> 121 1.769008e+10         2023-07-25
#> 122 1.609182e+10         2023-07-25
#> 123 1.577676e+10         2023-07-25
#> 124 1.528644e+10         2023-07-25
#> 125 1.491500e+10         2023-07-25
#> 126 1.465759e+10         2023-07-25
#> 127 1.458314e+10         2023-07-25
#> 128 1.455475e+10         2023-07-25
#> 129 1.414585e+10         2023-07-25
#> 130 1.400650e+10         2023-07-25
#> 131 1.386141e+10         2023-07-25
#> 132 1.382505e+10         2023-07-25
#> 133 1.369223e+10         2023-07-25
#> 134 1.336623e+10         2023-07-25
#> 135 1.260233e+10         2023-07-25
#> 136 1.244629e+10         2023-07-25
#> 137 1.226939e+10         2023-07-25
#> 138 1.177998e+10         2023-07-25
#> 139 1.173566e+10         2023-07-25
#> 140 1.152760e+10         2023-07-25
#> 141 1.147643e+10         2023-07-25
#> 142 1.105528e+10         2023-07-25
#> 143 1.007135e+10         2023-07-25
#> 144 9.996240e+09         2023-07-25
#> 145 9.412034e+09         2023-07-25
#> 146 8.937805e+09         2023-07-25
#> 147 8.740682e+09         2023-07-25
#> 148 8.596157e+09         2023-07-25
#> 149 8.334047e+09         2023-07-25
#> 150 8.044499e+09         2023-07-25
#> 151 7.628000e+09         2023-07-25
#> 152 7.186429e+09         2023-07-25
#> 153 7.127200e+09         2023-07-25
#> 154 6.123000e+09         2023-07-25
#> 155 6.080359e+09         2023-07-25
#> 156 6.028374e+09         2023-07-25
#> 157 5.861431e+09         2023-07-25
#> 158 5.405557e+09         2023-07-25
#> 159 4.843800e+09         2023-07-25
#> 160 4.748702e+09         2023-07-25
#> 161 4.296235e+09         2023-07-25
#> 162 4.249235e+09         2023-07-25
#> 163 3.649879e+09         2023-07-25
#> 164 3.621222e+09         2023-07-25
#> 165 3.509000e+09         2023-07-25
#> 166 3.372287e+09         2023-07-25
#> 167 3.325145e+09         2023-07-25
#> 168 3.235816e+09         2023-07-25
#> 169 3.126019e+09         2023-07-25
#> 170 2.984706e+09         2023-07-25
#> 171 2.775799e+09         2023-07-25
#> 172 2.699612e+09         2023-07-25
#> 173 2.539551e+09         2023-07-25
#> 174 2.516498e+09         2023-07-25
#> 175 2.491500e+09         2023-07-25
#> 176 2.373416e+09         2023-07-25
#> 177 2.091742e+09         2023-07-25
#> 178 2.038415e+09         2023-07-25
#> 179 1.855383e+09         2023-07-25
#> 180 1.691259e+09         2023-07-25
#> 181 1.638518e+09         2023-07-25
#> 182 1.580304e+09         2023-07-25
#> 183 1.560519e+09         2023-07-25
#> 184 1.384637e+09         2023-07-25
#> 185 1.296089e+09         2023-07-25
#> 186 1.286688e+09         2023-07-25
#> 187 1.122800e+09         2023-07-25
#> 188 1.044779e+09         2023-07-25
#> 189 9.716361e+08         2023-07-25
#> 190 8.722261e+08         2023-07-25
#> 191 8.608444e+08         2023-07-25
#> 192 8.438508e+08         2023-07-25
#> 193 7.090000e+08         2023-07-25
#> 194 5.552667e+08         2023-07-25
#> 195 5.266538e+08         2023-07-25
#> 196 4.692281e+08         2023-07-25
#> 197 4.040289e+08         2023-07-25
#> 198 2.595387e+08         2023-07-25
#> 199 2.276100e+08         2023-07-25
#> 200 2.178000e+08         2023-07-25
#> 201 1.455366e+08         2023-07-25
#> 202 6.019637e+07         2023-07-25
#>                         region             capital
#> 1                North America     Washington D.C.
#> 2          East Asia & Pacific             Beijing
#> 3          East Asia & Pacific               Tokyo
#> 4        Europe & Central Asia              Berlin
#> 5                   South Asia           New Delhi
#> 6        Europe & Central Asia              London
#> 7        Europe & Central Asia               Paris
#> 8        Europe & Central Asia                Rome
#> 9                North America              Ottawa
#> 10       Europe & Central Asia              Moscow
#> 11         East Asia & Pacific               Seoul
#> 12   Latin America & Caribbean            Brasilia
#> 13         East Asia & Pacific            Canberra
#> 14       Europe & Central Asia              Madrid
#> 15   Latin America & Caribbean         Mexico City
#> 16         East Asia & Pacific             Jakarta
#> 17       Europe & Central Asia           Amsterdam
#> 18  Middle East & North Africa              Riyadh
#> 19       Europe & Central Asia              Ankara
#> 20       Europe & Central Asia                Bern
#> 21       Europe & Central Asia              Warsaw
#> 22       Europe & Central Asia           Stockholm
#> 23       Europe & Central Asia            Brussels
#> 24         East Asia & Pacific             Bangkok
#> 25       Europe & Central Asia              Dublin
#> 26       Europe & Central Asia                Oslo
#> 27  Middle East & North Africa                    
#> 28   Latin America & Caribbean        Buenos Aires
#> 29       Europe & Central Asia              Vienna
#> 30          Sub-Saharan Africa               Abuja
#> 31  Middle East & North Africa               Cairo
#> 32         East Asia & Pacific           Singapore
#> 33          Sub-Saharan Africa            Pretoria
#> 34                  South Asia               Dhaka
#> 35  Middle East & North Africa           Abu Dhabi
#> 36       Europe & Central Asia          Copenhagen
#> 37         East Asia & Pacific              Manila
#> 38         East Asia & Pacific        Kuala Lumpur
#> 39         East Asia & Pacific                    
#> 40         East Asia & Pacific               Hanoi
#> 41  Middle East & North Africa              Tehran
#> 42                  South Asia           Islamabad
#> 43   Latin America & Caribbean              Bogota
#> 44   Latin America & Caribbean            Santiago
#> 45       Europe & Central Asia            Helsinki
#> 46       Europe & Central Asia           Bucharest
#> 47         East Asia & Pacific          Wellington
#> 48       Europe & Central Asia              Lisbon
#> 49   Latin America & Caribbean                Lima
#> 50       Europe & Central Asia              Athens
#> 51  Middle East & North Africa             Baghdad
#> 52       Europe & Central Asia                Kiev
#> 53       Europe & Central Asia              Astana
#> 54       Europe & Central Asia            Budapest
#> 55  Middle East & North Africa                Doha
#> 56  Middle East & North Africa             Algiers
#> 57  Middle East & North Africa               Rabat
#> 58  Middle East & North Africa         Kuwait City
#> 59       Europe & Central Asia          Bratislava
#> 60          Sub-Saharan Africa         Addis Ababa
#> 61          Sub-Saharan Africa             Nairobi
#> 62   Latin America & Caribbean            San Juan
#> 63   Latin America & Caribbean               Quito
#> 64   Latin America & Caribbean       Santo Domingo
#> 65                  South Asia             Colombo
#> 66  Middle East & North Africa              Muscat
#> 67   Latin America & Caribbean      Guatemala City
#> 68       Europe & Central Asia          Luxembourg
#> 69       Europe & Central Asia               Sofia
#> 70          Sub-Saharan Africa               Accra
#> 71          Sub-Saharan Africa        Yamoussoukro
#> 72          Sub-Saharan Africa              Dodoma
#> 73       Europe & Central Asia               Minsk
#> 74       Europe & Central Asia            Tashkent
#> 75       Europe & Central Asia              Zagreb
#> 76   Latin America & Caribbean         Panama City
#> 77       Europe & Central Asia             Vilnius
#> 78          Sub-Saharan Africa              Luanda
#> 79         East Asia & Pacific           Naypyidaw
#> 80   Latin America & Caribbean            San Jose
#> 81       Europe & Central Asia            Belgrade
#> 82       Europe & Central Asia           Ljubljana
#> 83   Latin America & Caribbean          Montevideo
#> 84          Sub-Saharan Africa            Kinshasa
#> 85       Europe & Central Asia                Baku
#> 86  Middle East & North Africa               Tunis
#> 87          Sub-Saharan Africa             Yaounde
#> 88  Middle East & North Africa               Amman
#> 89          Sub-Saharan Africa             Kampala
#> 90   Latin America & Caribbean              La Paz
#> 91   Latin America & Caribbean            Asuncion
#> 92  Middle East & North Africa             Tripoli
#> 93       Europe & Central Asia                Riga
#> 94  Middle East & North Africa              Manama
#> 95       Europe & Central Asia             Tallinn
#> 96                  South Asia           Kathmandu
#> 97          Sub-Saharan Africa            Khartoum
#> 98         East Asia & Pacific                    
#> 99   Latin America & Caribbean        San Salvador
#> 100  Latin America & Caribbean         Tegucigalpa
#> 101      Europe & Central Asia             Nicosia
#> 102         Sub-Saharan Africa              Harare
#> 103         Sub-Saharan Africa               Dakar
#> 104        East Asia & Pacific          Phnom Penh
#> 105        East Asia & Pacific        Port Moresby
#> 106      Europe & Central Asia           Reykjavik
#> 107  Latin America & Caribbean       Port-of-Spain
#> 108      Europe & Central Asia            Sarajevo
#> 109 Middle East & North Africa              Beirut
#> 110         Sub-Saharan Africa              Lusaka
#> 111  Latin America & Caribbean      Port-au-Prince
#> 112         Sub-Saharan Africa          Libreville
#> 113         Sub-Saharan Africa         Ouagadougou
#> 114         Sub-Saharan Africa              Bamako
#> 115        East Asia & Pacific           Vientiane
#> 116         Sub-Saharan Africa            Gaborone
#> 117      Europe & Central Asia             Tbilisi
#> 118 Middle East & North Africa                    
#> 119      Europe & Central Asia              Tirane
#> 120 Middle East & North Africa            Valletta
#> 121         Sub-Saharan Africa          Porto-Novo
#> 122         Sub-Saharan Africa             Conakry
#> 123         Sub-Saharan Africa              Maputo
#> 124        East Asia & Pacific         Ulaanbaatar
#> 125         Sub-Saharan Africa              Niamey
#> 126  Latin America & Caribbean            Kingston
#> 127                 South Asia               Kabul
#> 128         Sub-Saharan Africa        Antananarivo
#> 129  Latin America & Caribbean             Managua
#> 130        East Asia & Pacific Bandar Seri Begawan
#> 131      Europe & Central Asia             Yerevan
#> 132      Europe & Central Asia              Skopje
#> 133      Europe & Central Asia            Chisinau
#> 134         Sub-Saharan Africa         Brazzaville
#> 135         Sub-Saharan Africa            Lilongwe
#> 136         Sub-Saharan Africa            Windhoek
#> 137         Sub-Saharan Africa              Malabo
#> 138         Sub-Saharan Africa           N'Djamena
#> 139      Europe & Central Asia                    
#> 140  Latin America & Caribbean              Nassau
#> 141         Sub-Saharan Africa          Port Louis
#> 142         Sub-Saharan Africa              Kigali
#> 143        East Asia & Pacific             Noum'ea
#> 144         Sub-Saharan Africa          Nouakchott
#> 145      Europe & Central Asia            Pristina
#> 146      Europe & Central Asia            Dushanbe
#> 147      Europe & Central Asia             Bishkek
#> 148      Europe & Central Asia              Monaco
#> 149         Sub-Saharan Africa                Lome
#> 150  Latin America & Caribbean          Georgetown
#> 151         Sub-Saharan Africa           Mogadishu
#> 152      Europe & Central Asia               Vaduz
#> 153              North America            Hamilton
#> 154        East Asia & Pacific               Agana
#> 155        East Asia & Pacific             Papeete
#> 156  Latin America & Caribbean         George Town
#> 157      Europe & Central Asia           Podgorica
#> 158                 South Asia                Male
#> 159  Latin America & Caribbean          Bridgetown
#> 160         Sub-Saharan Africa             Mbabane
#> 161        East Asia & Pacific                Suva
#> 162         Sub-Saharan Africa            Freetown
#> 163      Europe & Central Asia            Torshavn
#> 164        East Asia & Pacific                Dili
#> 165         Sub-Saharan Africa            Monrovia
#> 166 Middle East & North Africa            Djibouti
#> 167      Europe & Central Asia    Andorra la Vella
#> 168      Europe & Central Asia                Nuuk
#> 169  Latin America & Caribbean          Oranjestad
#> 170  Latin America & Caribbean          Paramaribo
#> 171         Sub-Saharan Africa           Bujumbura
#> 172  Latin America & Caribbean          Willemstad
#> 173                 South Asia             Thimphu
#> 174         Sub-Saharan Africa              Bangui
#> 175  Latin America & Caribbean            Belmopan
#> 176         Sub-Saharan Africa              Maseru
#> 177         Sub-Saharan Africa               Praia
#> 178         Sub-Saharan Africa              Banjul
#> 179      Europe & Central Asia          San Marino
#> 180  Latin America & Caribbean            Castries
#> 181         Sub-Saharan Africa              Bissau
#> 182        East Asia & Pacific             Honiara
#> 183  Latin America & Caribbean        Saint John's
#> 184  Latin America & Caribbean         Philipsburg
#> 185         Sub-Saharan Africa              Moroni
#> 186         Sub-Saharan Africa            Victoria
#> 187  Latin America & Caribbean      Saint George's
#> 188  Latin America & Caribbean          Grand Turk
#> 189        East Asia & Pacific           Port-Vila
#> 190  Latin America & Caribbean           Kingstown
#> 191  Latin America & Caribbean          Basseterre
#> 192        East Asia & Pacific                Apia
#> 193        East Asia & Pacific           Pago Pago
#> 194  Latin America & Caribbean              Roseau
#> 195         Sub-Saharan Africa            Sao Tome
#> 196        East Asia & Pacific          Nuku'alofa
#> 197        East Asia & Pacific             Palikir
#> 198        East Asia & Pacific              Majuro
#> 199        East Asia & Pacific              Tarawa
#> 200        East Asia & Pacific               Koror
#> 201        East Asia & Pacific      Yaren District
#> 202        East Asia & Pacific            Funafuti
#>      longitude   latitude              income
#> 1      -77.032    38.8895         High income
#> 2      116.286    40.0495 Upper middle income
#> 3       139.77      35.67         High income
#> 4      13.4115    52.5235         High income
#> 5       77.225    28.6353 Lower middle income
#> 6    -0.126236    51.5002         High income
#> 7      2.35097    48.8566         High income
#> 8      12.4823    41.8955         High income
#> 9     -75.6919    45.4215         High income
#> 10     37.6176    55.7558 Upper middle income
#> 11     126.957    37.5323         High income
#> 12    -47.9292   -15.7801 Upper middle income
#> 13     149.129    -35.282         High income
#> 14    -3.70327    40.4167         High income
#> 15    -99.1276     19.427 Upper middle income
#> 16      106.83   -6.19752 Lower middle income
#> 17     4.89095    52.3738         High income
#> 18     46.6977    24.6748         High income
#> 19     32.3606    39.7153 Upper middle income
#> 20     7.44821     46.948         High income
#> 21       21.02      52.26         High income
#> 22     18.0645    59.3327         High income
#> 23     4.36761    50.8371         High income
#> 24     100.521    13.7308 Upper middle income
#> 25    -6.26749    53.3441         High income
#> 26     10.7387    59.9138         High income
#> 27     35.2035    31.7717         High income
#> 28    -58.4173   -34.6118 Upper middle income
#> 29     16.3798    48.2201         High income
#> 30     7.48906    9.05804 Lower middle income
#> 31     31.2461    30.0982 Lower middle income
#> 32      103.85    1.28941         High income
#> 33     28.1871    -25.746 Upper middle income
#> 34     90.4113    23.7055 Lower middle income
#> 35     54.3705    24.4764         High income
#> 36     12.5681    55.6763         High income
#> 37     121.035    14.5515 Lower middle income
#> 38     101.684    3.12433 Upper middle income
#> 39     114.109    22.3964         High income
#> 40     105.825    21.0069 Lower middle income
#> 41     51.4447    35.6878 Lower middle income
#> 42        72.8    30.5167 Lower middle income
#> 43     -74.082    4.60987 Upper middle income
#> 44    -70.6475    -33.475         High income
#> 45     24.9525    60.1608         High income
#> 46     26.0979    44.4479         High income
#> 47     174.776   -41.2865         High income
#> 48    -9.13552    38.7072         High income
#> 49    -77.0465   -12.0931 Upper middle income
#> 50     23.7166    37.9792         High income
#> 51      44.394    33.3302 Upper middle income
#> 52     30.5038    50.4536 Lower middle income
#> 53     71.4382    51.1879 Upper middle income
#> 54     19.0408    47.4984         High income
#> 55     51.5082    25.2948         High income
#> 56     3.05097    36.7397 Lower middle income
#> 57     -6.8704    33.9905 Lower middle income
#> 58     47.9824    29.3721         High income
#> 59     17.1073    48.1484         High income
#> 60     38.7468    9.02274          Low income
#> 61     36.8126   -1.27975 Lower middle income
#> 62         -66      18.23         High income
#> 63    -78.5243  -0.229498 Upper middle income
#> 64    -69.8908     18.479 Upper middle income
#> 65     79.8528    6.92148 Lower middle income
#> 66     58.5874    23.6105         High income
#> 67    -90.5328    14.6248 Upper middle income
#> 68      6.1296      49.61         High income
#> 69     23.3238    42.7105 Upper middle income
#> 70    -0.20795    5.57045 Lower middle income
#> 71     -4.0305      5.332 Lower middle income
#> 72     35.7382   -6.17486 Lower middle income
#> 73     27.5766    53.9678 Upper middle income
#> 74      69.269    41.3052 Lower middle income
#> 75     15.9614    45.8069         High income
#> 76    -79.5188    8.99427         High income
#> 77     25.2799    54.6896         High income
#> 78      13.242   -8.81155 Lower middle income
#> 79     95.9562     21.914 Lower middle income
#> 80    -84.0089    9.63701 Upper middle income
#> 81     20.4656    44.8024 Upper middle income
#> 82     14.5044    46.0546         High income
#> 83    -56.0675   -34.8941         High income
#> 84     15.3222     -4.325          Low income
#> 85     49.8932    40.3834 Upper middle income
#> 86       10.21    36.7899 Lower middle income
#> 87     11.5174     3.8721 Lower middle income
#> 88     35.9263    31.9497 Upper middle income
#> 89     32.5729   0.314269          Low income
#> 90    -66.1936   -13.9908 Lower middle income
#> 91    -57.6362   -25.3005 Upper middle income
#> 92     13.1072    32.8578 Upper middle income
#> 93     24.1048    56.9465         High income
#> 94     50.5354    26.1921         High income
#> 95     24.7586    59.4392         High income
#> 96     85.3157    27.6939 Lower middle income
#> 97     32.5363    15.5932          Low income
#> 98      113.55    22.1667         High income
#> 99    -89.2073    13.7034 Lower middle income
#> 100   -87.4667    15.1333 Lower middle income
#> 101    33.3736    35.1676         High income
#> 102    31.0672   -17.8312 Lower middle income
#> 103   -17.4734    14.7247 Lower middle income
#> 104    104.874    11.5556 Lower middle income
#> 105    147.194   -9.47357 Lower middle income
#> 106   -21.8952    64.1353         High income
#> 107   -61.4789    10.6596         High income
#> 108    18.4214    43.8607 Upper middle income
#> 109    35.5134    33.8872 Lower middle income
#> 110    28.2937   -15.3982          Low income
#> 111   -72.3288    18.5392 Lower middle income
#> 112    9.45162    0.38832 Upper middle income
#> 113   -1.53395    12.3605          Low income
#> 114   -7.50034    13.5667          Low income
#> 115    102.177    18.5826 Lower middle income
#> 116    25.9201   -24.6544 Upper middle income
#> 117     44.793      41.71 Upper middle income
#> 118                       Lower middle income
#> 119    19.8172    41.3317 Upper middle income
#> 120    14.5189    35.9042         High income
#> 121     2.6323     6.4779 Lower middle income
#> 122      -13.7    9.51667          Low income
#> 123    32.5713   -25.9664          Low income
#> 124    106.937    47.9129 Lower middle income
#> 125     2.1073     13.514          Low income
#> 126    -76.792    17.9927 Upper middle income
#> 127    69.1761    34.5228          Low income
#> 128    45.7167   -20.4667          Low income
#> 129   -86.2734    12.1475 Lower middle income
#> 130    114.946    4.94199         High income
#> 131     44.509    40.1596 Upper middle income
#> 132    21.4361    42.0024 Upper middle income
#> 133    28.8497    47.0167 Upper middle income
#> 134    15.2662    -4.2767 Lower middle income
#> 135    33.7703   -13.9899          Low income
#> 136    17.0931   -22.5648 Upper middle income
#> 137     8.7741     3.7523 Upper middle income
#> 138    15.0445    12.1048          Low income
#> 139                               High income
#> 140    -77.339    25.0661         High income
#> 141    57.4977   -20.1605 Upper middle income
#> 142    30.0587   -1.95325          Low income
#> 143    166.464   -22.2677         High income
#> 144   -15.9824    18.2367 Lower middle income
#> 145     20.926     42.565 Upper middle income
#> 146    68.7864    38.5878 Lower middle income
#> 147    74.6057    42.8851 Lower middle income
#> 148    7.41891    43.7325         High income
#> 149     1.2255     6.1228          Low income
#> 150   -58.1548    6.80461 Upper middle income
#> 151    45.3254    2.07515          Low income
#> 152    9.52148    47.1411         High income
#> 153    -64.706    32.3293         High income
#> 154    144.794    13.4443         High income
#> 155    -149.57    -17.535         High income
#> 156   -81.3857    19.3022         High income
#> 157    19.2595    42.4602 Upper middle income
#> 158    73.5109     4.1742 Upper middle income
#> 159   -59.6105    13.0935         High income
#> 160    31.4659   -26.5225 Lower middle income
#> 161    178.399   -18.1149 Upper middle income
#> 162   -13.2134     8.4821          Low income
#> 163   -6.91181    61.8926         High income
#> 164    125.567   -8.56667 Lower middle income
#> 165   -10.7957    6.30039          Low income
#> 166    43.1425    11.5806 Lower middle income
#> 167     1.5218    42.5075         High income
#> 168   -51.7214    64.1836         High income
#> 169   -70.0167    12.5167         High income
#> 170   -55.1679     5.8232 Upper middle income
#> 171    29.3639    -3.3784          Low income
#> 172                               High income
#> 173    89.6177    27.5768 Lower middle income
#> 174    21.6407    5.63056          Low income
#> 175   -88.7713    17.2534 Upper middle income
#> 176    27.7167   -29.5208 Lower middle income
#> 177   -23.5087    14.9218 Lower middle income
#> 178   -16.5885    13.4495          Low income
#> 179    12.4486    43.9322         High income
#> 180   -60.9832         14 Upper middle income
#> 181   -15.1804    11.8037          Low income
#> 182    159.949   -9.42676 Lower middle income
#> 183   -61.8456    17.1175         High income
#> 184                               High income
#> 185    43.2418   -11.6986 Lower middle income
#> 186    55.4466    -4.6309         High income
#> 187   -61.7449    12.0653 Upper middle income
#> 188 -71.141389 21.4602778         High income
#> 189    168.321   -17.7404 Lower middle income
#> 190   -61.2653    13.2035 Upper middle income
#> 191   -62.7309       17.3         High income
#> 192   -171.752   -13.8314 Lower middle income
#> 193   -170.691   -14.2846 Upper middle income
#> 194     -61.39    15.2976 Upper middle income
#> 195     6.6071    0.20618 Lower middle income
#> 196   -175.216    -21.136 Upper middle income
#> 197    158.185    6.91771 Lower middle income
#> 198    171.135    7.11046 Upper middle income
#> 199    172.979    1.32905 Lower middle income
#> 200    134.479    7.34194 Upper middle income
#> 201 166.920867    -0.5477         High income
#> 202 179.089567 -8.6314877 Upper middle income
#>            lending
#> 1   Not classified
#> 2             IBRD
#> 3   Not classified
#> 4   Not classified
#> 5             IBRD
#> 6   Not classified
#> 7   Not classified
#> 8   Not classified
#> 9   Not classified
#> 10            IBRD
#> 11  Not classified
#> 12            IBRD
#> 13  Not classified
#> 14  Not classified
#> 15            IBRD
#> 16            IBRD
#> 17  Not classified
#> 18  Not classified
#> 19            IBRD
#> 20  Not classified
#> 21            IBRD
#> 22  Not classified
#> 23  Not classified
#> 24            IBRD
#> 25  Not classified
#> 26  Not classified
#> 27  Not classified
#> 28            IBRD
#> 29  Not classified
#> 30           Blend
#> 31            IBRD
#> 32  Not classified
#> 33            IBRD
#> 34             IDA
#> 35  Not classified
#> 36  Not classified
#> 37            IBRD
#> 38            IBRD
#> 39  Not classified
#> 40            IBRD
#> 41            IBRD
#> 42           Blend
#> 43            IBRD
#> 44            IBRD
#> 45  Not classified
#> 46            IBRD
#> 47  Not classified
#> 48  Not classified
#> 49            IBRD
#> 50  Not classified
#> 51            IBRD
#> 52            IBRD
#> 53            IBRD
#> 54  Not classified
#> 55  Not classified
#> 56            IBRD
#> 57            IBRD
#> 58  Not classified
#> 59  Not classified
#> 60             IDA
#> 61           Blend
#> 62  Not classified
#> 63            IBRD
#> 64            IBRD
#> 65            IBRD
#> 66  Not classified
#> 67            IBRD
#> 68  Not classified
#> 69            IBRD
#> 70             IDA
#> 71             IDA
#> 72             IDA
#> 73            IBRD
#> 74           Blend
#> 75            IBRD
#> 76            IBRD
#> 77  Not classified
#> 78            IBRD
#> 79             IDA
#> 80            IBRD
#> 81            IBRD
#> 82  Not classified
#> 83            IBRD
#> 84             IDA
#> 85            IBRD
#> 86            IBRD
#> 87           Blend
#> 88            IBRD
#> 89             IDA
#> 90            IBRD
#> 91            IBRD
#> 92            IBRD
#> 93  Not classified
#> 94  Not classified
#> 95  Not classified
#> 96             IDA
#> 97             IDA
#> 98  Not classified
#> 99            IBRD
#> 100            IDA
#> 101 Not classified
#> 102          Blend
#> 103            IDA
#> 104            IDA
#> 105          Blend
#> 106 Not classified
#> 107           IBRD
#> 108           IBRD
#> 109           IBRD
#> 110            IDA
#> 111            IDA
#> 112           IBRD
#> 113            IDA
#> 114            IDA
#> 115            IDA
#> 116           IBRD
#> 117           IBRD
#> 118 Not classified
#> 119           IBRD
#> 120 Not classified
#> 121            IDA
#> 122            IDA
#> 123            IDA
#> 124           IBRD
#> 125            IDA
#> 126           IBRD
#> 127            IDA
#> 128            IDA
#> 129            IDA
#> 130 Not classified
#> 131           IBRD
#> 132           IBRD
#> 133           IBRD
#> 134          Blend
#> 135            IDA
#> 136           IBRD
#> 137           IBRD
#> 138            IDA
#> 139 Not classified
#> 140 Not classified
#> 141           IBRD
#> 142            IDA
#> 143 Not classified
#> 144            IDA
#> 145            IDA
#> 146            IDA
#> 147            IDA
#> 148 Not classified
#> 149            IDA
#> 150            IDA
#> 151            IDA
#> 152 Not classified
#> 153 Not classified
#> 154 Not classified
#> 155 Not classified
#> 156 Not classified
#> 157           IBRD
#> 158            IDA
#> 159 Not classified
#> 160           IBRD
#> 161          Blend
#> 162            IDA
#> 163 Not classified
#> 164          Blend
#> 165            IDA
#> 166            IDA
#> 167 Not classified
#> 168 Not classified
#> 169 Not classified
#> 170           IBRD
#> 171            IDA
#> 172 Not classified
#> 173            IDA
#> 174            IDA
#> 175           IBRD
#> 176            IDA
#> 177          Blend
#> 178            IDA
#> 179 Not classified
#> 180          Blend
#> 181            IDA
#> 182            IDA
#> 183           IBRD
#> 184 Not classified
#> 185            IDA
#> 186           IBRD
#> 187          Blend
#> 188 Not classified
#> 189            IDA
#> 190          Blend
#> 191           IBRD
#> 192            IDA
#> 193 Not classified
#> 194          Blend
#> 195            IDA
#> 196            IDA
#> 197            IDA
#> 198            IDA
#> 199            IDA
#> 200           IBRD
#> 201           IBRD
#> 202            IDA
```

これは、グラフではありませんが、これも一つの視覚化とも考えられないことはありません。

上位７カ国は、United States, China, Japan, Germany, India, United Kingdom, France であることがわかりました。8番目は、Italy でここまでが、GDP が 2兆ドルを越している国となります。

#### Fig 3. 2021年時のGDP上位7カ国のGDP経年変化


```r
df_gdp %>% filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR")) %>%
  ggplot(aes(x = year, y = gdp, col = iso2c)) + geom_line()
#> Warning: Removed 10 rows containing missing values
#> (`geom_line()`).
```

![](03-first-example_files/figure-latex/unnamed-chunk-14-1.pdf)<!-- --> 

```         
df_gdp %>% filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR")) %>%
  ggplot(aes(x = year, y = gdp, col = iso2c)) + geom_line()
```

ここでは、最初に、`filter` を使って、7カ国のデータを選択しています。 そのときには、`%in%` として、国名を、combine するといういみで、`c()` とひとまとめにします。数字ではなく、文字なので、引用符で囲んでいます。この場合は、single quote でも構いませんが、半角を使ってください。

このグラフからは、どのようなことがわかりますか。気づいたことを書いてみましょう。

もう少し、このようなグラフをみてみたいというような、メモも大切です。

#### Fig 4. 世界のGDP における割合（１）


```r
df_gdp %>% 
  filter(region != "Aggregates") %>% drop_na(gdp) %>% 
  group_by(year) %>% mutate(gdp_ratio = gdp/sum(gdp)) %>% ungroup() %>%
  filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR"))  %>%
  ggplot(aes(x = year, y = gdp_ratio, fill = iso2c)) + geom_area() +
  geom_line(col = "black", position = "stack", linewidth = 0.3) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))
```

![](03-first-example_files/figure-latex/unnamed-chunk-15-1.pdf)<!-- --> 

まず、下の部分が新しいですが、ここでは、年毎にグループにして、その上で、新しい `dgp_ratio` という名前の列を追加し、その gdp の値を、gdp 合計で割っています。すなわち、世界の、GDP における割合が計算されています。

```         
  group_by(year) %>% mutate(gdp_ratio = gdp/sum(gdp)) %>% ungroup() %>%
```

下の部分では、`geom_area` を使って、`fill=iso2c` により、`iso2c` ごとに、違う色を塗って、position = "stack" により、積み上げ型の、グラフを描き、境目がわかりやすいように、0.3 の太さの黒の線を描いてください。また、y 軸は、小数点以下を省いたパーセント表示に変えてください。というコードです。

```         
  ggplot(aes(x = year, y = gdp_ratio, fill = iso2c)) + geom_area() +
  geom_line(col = "black", position = "stack", linewidth = 0.3) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))
```

#### Fig 4. 世界のGDP における割合（２）

これは、上から、iso2c の アルファベットの順番になっていますが、積み上げの順序を変更することもできます。


```r
df_gdp %>% 
  filter(region != "Aggregates") %>% drop_na(gdp) %>% 
  group_by(year) %>% mutate(gdp_ratio = gdp/sum(gdp)) %>% ungroup() %>%
  filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR"))  %>%
  mutate(iso2co = factor(iso2c, levels = c("IN", "CN", "FR", "GB", "DE", "JP", "US"))) %>%
  ggplot(aes(x = year, y = gdp_ratio, fill = iso2co)) + geom_area() +
  geom_line(col = "black", position = "stack", linewidth = 0.3) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))
```

![](03-first-example_files/figure-latex/unnamed-chunk-16-1.pdf)<!-- --> 

これらは、世界全体の GPT における割合です。

どのようなことがわかりますか。

主要国で、60%〜70% を占めていることがわかります。それぞれの国や、幾つかの国の影響力も、ある程度みることができるように見えます。

気づいたこと、疑問に思ったことなどを、書き出してみてください。

GDP が大きな国と、小さな国があるのはわかりますが、それは、どのように分布しているのでしょうか。

#### Fig 5. 2021年の世界の国のGDPの分布（１）


```r
df_gdp %>% drop_na(gdp) %>% 
  filter(year == 2021) %>% filter(region != "Aggregates") %>%
  ggplot(aes(gdp)) + geom_histogram()
#> `stat_bin()` using `bins = 30`. Pick better value with
#> `binwidth`.
```

![](03-first-example_files/figure-latex/unnamed-chunk-17-1.pdf)<!-- --> 

小さいところに集中していることがわかりますが、`scale_x_log10()` を加え、対数軸をとってみます。

$log10(1000) = 3$, $log10(1000000) = 6$, $log10(1000000000) = 9$ などになります。

#### Fig 6. 2021年の世界の国のGDPの分布（２）


```r
df_gdp %>% drop_na(gdp) %>% 
  filter(year == 2021) %>% filter(region != "Aggregates") %>%
  ggplot(aes(gdp)) + geom_histogram() + scale_x_log10()
#> `stat_bin()` using `bins = 30`. Pick better value with
#> `binwidth`.
```

![](03-first-example_files/figure-latex/unnamed-chunk-18-1.pdf)<!-- --> 

幅を変更したり、分ける個数を変更するには `binwidth = 0.5` や、`bins = 20` を、`geom_histogram()` のかっこの中に入れます。

#### Fig 7. 2021年の世界の国のGDPの分布（３）

また、密度曲線に変えるには、`geom_density` を使います。


```r
df_gdp %>% drop_na(gdp) %>% 
  filter(year == 2021) %>% filter(region != "Aggregates") %>%
  ggplot(aes(gdp)) + geom_density() + scale_x_log10()
```

![](03-first-example_files/figure-latex/unnamed-chunk-19-1.pdf)<!-- --> 

#### Fig 8. 2021年の世界の国のGDPの分布（４）

これは、2021年のデータですが、density の変化を見てみます。alpha の値は透明度です。


```r
df_gdp %>% drop_na(gdp) %>% 
  filter(year %in% c(1961, 1971, 1981, 1991, 2001, 2011, 2021)) %>%
  ggplot(aes(gdp, fill = factor(year))) + geom_density(alpha = 0.4) + scale_x_log10()
```

![](03-first-example_files/figure-latex/unnamed-chunk-20-1.pdf)<!-- --> 

#### Fig 9. 2021年の世界の国のGDPの分布（５）

少しみにくいので、分けてみます。


```r
df_gdp %>% drop_na(gdp) %>% 
  filter(year %in% c(1971, 1981, 1991, 2001, 2011, 2021)) %>%
  ggplot(aes(gdp, fill = factor(year))) + 
  geom_density() + scale_x_log10() + facet_wrap(~year)
```

![](03-first-example_files/figure-latex/unnamed-chunk-21-1.pdf)<!-- --> 

#### Fig 10. 地域ごとの GDP の分布

いくつかのグループごとに分布をみてみることも可能です。それには、Boxplot が有効です。


```r
df_gdp %>% drop_na(gdp) %>% filter(region != "Aggregates") %>%
  drop_na(region) %>% filter(year %in% c(2021)) %>%
  ggplot(aes(gdp, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + 
  theme(legend.position = "none")
```

![](03-first-example_files/figure-latex/unnamed-chunk-22-1.pdf)<!-- --> 

#### Fig 11. 収入の多寡による分類ごとの GDP 分布


```r
df_gdp %>% drop_na(gdp) %>% filter(region != "Aggregates") %>%
  drop_na(income) %>% filter(year %in% c(2021)) %>%
  mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
  ggplot(aes(gdp, level, fill = income)) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + 
  theme(legend.position = "none")
```

![](03-first-example_files/figure-latex/unnamed-chunk-23-1.pdf)<!-- --> 

これからも、いろいろなことがわかりますね。

#### 世界地図の準備

地図で、国の income level をみてみましょう。


```r
library(maps)
gdp_short <- df_gdp %>% filter(year == 2021, region != "Aggregates") %>%
  select(iso2c, gdp, income)
map_world <- map_data('world')
map_gdp <- map_world %>% 
  mutate(iso2c = iso.alpha(region, n=2)) %>% 
  left_join(gdp_short, by = "iso2c") 
head(map_gdp)
#>        long      lat group order region subregion iso2c
#> 1 -69.89912 12.45200     1     1  Aruba      <NA>    AW
#> 2 -69.89571 12.42300     1     2  Aruba      <NA>    AW
#> 3 -69.94219 12.43853     1     3  Aruba      <NA>    AW
#> 4 -70.00415 12.50049     1     4  Aruba      <NA>    AW
#> 5 -70.06612 12.54697     1     5  Aruba      <NA>    AW
#> 6 -70.05088 12.59707     1     6  Aruba      <NA>    AW
#>          gdp      income
#> 1 3126019385 High income
#> 2 3126019385 High income
#> 3 3126019385 High income
#> 4 3126019385 High income
#> 5 3126019385 High income
#> 6 3126019385 High income
```

#### Fig 12. Income Level による色分け地図


```r
map_gdp %>% mutate(income_level = factor(income, levels = c("High income", "Upper middle income", "Lower middle income", "Low income", "Not classified", NA))) %>%
  ggplot() +
  geom_map(aes(long, lat, map_id = region, fill = income_level), map = map_world, col = "black", size = 0.1) 
#> Warning: Using `size` aesthetic for lines was deprecated in ggplot2
#> 3.4.0.
#> i Please use `linewidth` instead.
#> This warning is displayed once every 8 hours.
#> Call `lifecycle::last_lifecycle_warnings()` to see where
#> this warning was generated.
#> Warning in geom_map(aes(long, lat, map_id = region, fill =
#> income_level), : Ignoring unknown aesthetics: x and y
```

![](03-first-example_files/figure-latex/unnamed-chunk-25-1.pdf)<!-- --> 

#### Fig 13. GDP による色分け地図


```r
map_gdp %>%
  ggplot() +
  geom_map(aes(x=long, y=lat, map_id = region, fill = gdp), map = map_world, col = "black", size = 0.1) 
#> Warning in geom_map(aes(x = long, y = lat, map_id = region,
#> fill = gdp), : Ignoring unknown aesthetics: x and y
```

![](03-first-example_files/figure-latex/unnamed-chunk-26-1.pdf)<!-- --> 

## 練習

1.  それぞれのグラフから、わかったこと、問いなどを列挙してみましょう。
2.  Fig 1 の　Japan の部分を他の国や、グループ（World など）に変えてみてください。何がわかりますか。
3.  Fig 3 の iso2c で選択する、国を変更してください。何がわかりますか。
4.  Fig 4 または Fig 5 の iso2c の部分を他の国に変更してください。何がわかりますか。
5.  Fig 5 または Fig 6 の、区間の幅や、数を 変更してみてください。何がわかりますか。
6.  Fig 7, Fig 8, Fig 9 の年を変更してみてください。何がわかりますか。
7.  Fig 12, Fig 13 の年を変更してみてください。何がわかりますか。

## プロジェクト

他のデータで、同様のことをしてみましょう。

1.  最初に、`gdp = "NY.GDP.MKTP.CD"` としましたが、GNI per capita, Atlas method (current US\$): NY.GNP.PCAP.CD に変えてみましょう。


```r
df_gnppcap <- WDI(country = "all", 
              indicator = c(gnppcap = "NY.GNP.PCAP.CD"), 
              extra = TRUE)
```

2.  [World Development Indicators](https://datatopics.worldbank.org/world-development-indicators/) のサイトの下にある、Data Themes（テーマ）から自分が調べたいテーマを選び、そのテーマから、データコードを取得して、同様の分析をしてみてください。データがあまりない場合もありますので、ある程度データが多いものを選択することをお勧めします。

## まとめ

今回は、経済指標である、GDP を使いました。データサイエンスについて少しずつ、学んでいきます。

コードの説明は、簡単にしかしていませんから、理解するのは難しいと思いますが、いくつかのことは、ご理解いただけると思います。

-   それほど、長くはない、コードで、データを見ていく。R は対話型（interactive）のプログラミング言語と言われています。

-   コードに続けて、結果が表示されるので、コードと出力の対応が見やすい。また、コメントや説明も併記することができる。これは、RMarkdown という形式の中で、コードを書いていることによるものです。RMarkdown は、再現性（reproducibility）と、プログラム・コードの内容をコンピュータにわかるようにでなく、人間にもわかるように記述する（Literate Programming）を実現しています。

-   視覚化（Visualization）によって、わかることが色々とある。また、視覚化の方法もたくさんあり、いろいろな見方をすることで、データについての理解が深まっていく。

-   視覚化を通して、データを理解すること、問いを持ち、他の視覚化などを用いて、さらに、理解を深めることがたいせつ。

-   理解したことを元にして、さらに、そのデータ、または、他のデータを使って、新たな発見をしていく。

統計的な指標も用いますが、それらによって、新しい知識を生み出すとも表現しますが、そのような営み全体が、データサイエンスの核をなす部分だと思います。

<!--chapter:end:03-first-example.Rmd-->

# 世界開発指標 {#wdi-site}

世界銀行（World Bank）の 世界開発指標（WDI）の中の、GDP を使いました。どのようなものか確認しておきましょう。

## 世界銀行（[World Bank](https://www.worldbank.org/en/home)）

* [世界銀行オープンデータ](https://data.worldbank.org)
* [データカタログ](https://datacatalog.worldbank.org/home)
* [世界開発指標（WDI）](https://datatopics.worldbank.org/world-development-indicators/)

世界開発指標は、世界銀行が提供している、オープンデータの一つで、他にも、たくさんのデータを提供しています。三つのサイトのリンクを書きました。一つ一つみていきましょう。

まず、英語を読むことが苦手な場合は、ブラウザー（Google Chrome, Edge, Safari などのホームページ閲覧ソフト）の自動翻訳機能を使うのも良いでしょう。しかし、自動翻訳機能を利用していると、リンク先に飛べなかったり、いくつかの機能が使えないこともありますので、ボタンを押しても、反応しないときは、自動翻訳機能を OFF にして利用してください。

### [世界銀行オープンデータ](https://data.worldbank.org)

上の検索窓の下に、Country と Indicators と書いてあります。

#### 国別サイト

Country（国別）のサイトを選択すると、国のリストが出てきます。

J のところに、Japan（日本）がありますから、選択すると、日本のさまざまな指標とグラフが出てきます。

Indicator（指標）、Most Recent Values（直近の値）、Trend（傾向）が表示されます。指標をクリックすると、大きなグラフが出てきます。その指標のサイトですから、そこで、その指標についての他の国の状況などを確認することができます。そこでは、選択した指標と似た指標が選択できたり、もっと詳しいことをしらべるデータバンクへのリンクもあります。このサイトから、データをダウンロードすることもできるようになっています。

また、国別サイトを開けると、右の方には、地域など、グループに分けてある箇所もあります。その一番下には、World （世界）もありますから、世界全体について見てみたり、収入の階級に分けたサイトの指標を見ることもできるようになっています。


#### 指標別サイト

Indicators（指標）を選択すると、トピックに分けて、指標が並んでいます。

よく見ると、一番上に、Featured Indicators（特徴的な指標） と、All Indicators（すべての指標） となっていて、最初の開いているのは、特徴的な指標の方であることがわかります。すべての指標の方を開けると、たくさんの指標を見ることができます。

トピックは、以下のものに分かれています。

-  Agriculture & Rural Development 農業と農村開発
-  Aid Effectiveness 援助の有効性
-  Climate Change 気候変動
-  Economy & Growth 経済と成長
-  Education 教育
-  Energy & Mining エネルギーと鉱業
-  Environment 環境
-  External Debt 対外債務
-  Financial Sector 金融セクター
-  Gender 性別
-  Health 健康
-  Infrastructure インフラ
-  Poverty 貧困
-  Private Sector 民間部門
-  Public Sector 公共部門
-  Science & Technology 科学技術
-  Social Development 社会開発
-  Social Protection & Labor 社会的保護と労働
-  Trade 貿易
-  Urban Development 都市開発

それぞれの指標を選択すると、グラフが表示される画面が出てきます。それは、上で国別のところから選択したものと同じです。

Indicator Code （WDI コード）は、Details (詳細) を見ると、その指標の概要とともに、書いてあります。
そのデータコードは、そのページの上の URL にも表示されています。


### [データカタログ](https://datacatalog.worldbank.org/home)




### [世界開発指標（WDI）](https://datatopics.worldbank.org/world-development-indicators/)


また、オープンデータについて、世界銀行は、厳密な定義をしています。

### オープンデータの定義（[Open Data Defined](http://opendatatoolkit.worldbank.org/en/essentials.html)）

オープンデータという言葉は、厳密な意味を持っています。データまたはコンテンツは、出所が明示されオープンという性質が維持されれば、誰でも自由に利用、再利用、再配布できるものを言います。

1. データは法的にオープンでなければなりません。つまり、パブリックドメインに置かれ、最小限の制限で自由に使用できなければなりません。

2. データは技術的にオープンでなければなりません。つまり、誰でも自由に使える一般的なソフトウェアツールを使ってデータにアクセスし、機械で読み取ることが可読な電子フォーマットで提供されていなければならなりません。パスワードやファイアウォールによる制限を受けずに、公共のサーバーで、だれでもアクセスできなければなりません。また、オープンデータを見つけやすくするために、さまざまな組織がオープンデータカタログを作成し管理してく必要があります。

<center><font size="3">データはだれのものでしょうか?  パブリックデータのパブリックとは？</font></center>

## 世界開発指標（WDI）

* [World Development Indicators (WDI)](https://datatopics.worldbank.org/world-development-indicators/) : 世界銀行が開発に関する各国間比較可能なデータの集大成である1400の時系列指標（the World Bank’s premier compilation of cross-country comparable data on development; 1400 time series indicators）
  - テーマ別（Themes）: 貧困と格差、人間、環境、経済、国家と市場、グローバルリンク集（Poverty and Inequality, People, Environment, Economy, States and Markets, Global Links）
  - オープンデータとデータバンク（Open Data & DataBank）: Explore data, Query database
  - Bulk Download: Excel, CSV
  - API Documentation
  
### 世界のさまざまな課題

https://datatopics.worldbank.org/world-development-indicators/

1. 貧困と不平等（Poverty and Inequality）：貧困、繁栄、消費、所得分配
2. 人々（People）：人口動態、教育、労働、健康、ジェンダー
3. 環境（Environment）：農業、気候変動、エネルギー、生物多様性、水、衛生
4. 経済（Economy）：成長、経済構造、所得と貯蓄、貿易、労働生産性
5. 国家と市場（States and Markets）：ビジネス、株式市場、軍事、通信、輸送、テクノロジー
6. グローバルリンク（Global Links）：債務、貿易、援助への依存、難民、観光、移住

### ダッシュボード・データの取得・データコード

さまざまな国際機関では、データを、Excel 形式や、CSV (Comma Separated Values）形式などで、提供する以外に、ダッシュボード形式で、グラフを生成するなどして、データを視覚化をある程度できるようにしています。さらに、コンピュータのアプリケーションでデータを直接取得できるように、API (Application Program Interface) を提供しています。

世界開発指標（WDI）は、これらを、すべて統一した形で提供しているために、非常に使いやすいデータベースになっています。また、上にリストしているように、1400余のさまざまなデータを提供しているために、最初に調べてみることをお勧めするデータベースです。

分析を考えると、Excel や、CSV でダウンロードして、それから、データを読み込むよりも、R で直接データを取得する方が、便利ですので、このコースでは、その方法を、説明しています。

データを探すことも、R の中ですることが可能ですが、データベースに慣れるためにも、WDI のホームページから、トピックを選択して、データを探し、説明も調べて、取得したいデータ・コードを調べることも非常に有効です。

いろいろなトピックに、どのような指標があるか調べて、興味のある、データ・コードをリストしてください。データの名前も同時に、記録しておくと良いでしょう。


## 世界銀行以外の国際機関のパブリックデータ

世界銀行以外にも、それぞれの機関がデータを提供しています。どれも、少しずつ使いやすくなってきています。少しずつ、いくつかのデータベースに、アクセスして、できれば、API の利用の仕方も、習得して、データを調べることに少しずつ慣れていっていただければと思います。

下のリストは、私が個人的に、何度か使ったことのある、データベースです。他にも、たくさんのデータベースがありますので、ぜひ、調べてみてください。

* 国際連合　[UNdata](https://data.un.org)
* 経済協力開発機構　[OECD data](https://data.oecd.org)、
* 世界格差データベース（World Inequality Database）[WID](https://wid.world)、
* 欧州連合の統計局　[Eurostat](https://ec.europa.eu/eurostat)、
* データで見る私たちの世界　[Our World in Data](https://ourworldindata.org)

なども、同様の、ダッシュボードを備えており、データの提供もしている。

<p>
日本では、

* [e-Stat](https://www.e-stat.go.jp/)、
* [ダッシュボード](https://dashboard.e-stat.go.jp)

## 持続的開発目標（SDGs） データ

* 世界銀行：https://databank.worldbank.org/source/sustainable-development-goals-(sdgs)
* 国連：https://unstats.un.org/sdgs/dataportal/database
* データで見る私たちの世界：Our World in Data SGD Tracker: https://sdg-tracker.org/
* SDG Index: https://dashboards.sdgindex.org/map

## 課題

世界開発指標（WDI）の、データで、調べてみたい データコードをいくつか見つけて、書き出してください。


<!--chapter:end:04-wdi-site.Rmd-->

# (PART) PART I PUBLIC DATA {-}
# Public Data {#publicdata}



まずは、パブリックデータを見てみましょう。大きな機関のパグリックデータには、ダッシュボード（dashboard）と呼ばれている、パラメタを変更して、そのグラフを描くなどの機能が付いているものもあります。

## オープンデータ

### [Open Government Data Toolkit](http://opendatatoolkit.worldbank.org): [Open Data Defined](http://opendatatoolkit.worldbank.org/en/essentials.html)

The term **Open Data** has a very precise meaning. Data or content is open if anyone is free to use, re-use or redistribute it, subject at most to measures that preserve provenance and openness.

1. The data must be _legally open_, which means they must be placed in the public domain or under liberal terms of use with minimal restrictions.
2. The data must be _technically open_, which means they must be published in electronic formats that are machine readable and non-proprietary, so that anyone can access and use the data using common, freely available software tools. Data must also be publicly available and accessible on a public server, without password or firewall restrictions. To make Open Data easier to find, most organizations create and manage Open Data catalogs.

オープンデータの定義

1. オープンデータという言葉は、非常に正確な意味を持っています。データまたはコンテンツは、誰でも自由に使用、再利用、再配布でき、せいぜい出所とオープン性を維持するための措置に従うだけであればオープンです。

2. データは法的にオープンでなければなりません。つまり、パブリックドメインに置かれるか、最小限の制限で自由な使用条件のもとに置かれなければなりません。
データは技術的にオープンでなければならない。つまり、誰でも自由に使える一般的なソフトウェアツールを使ってデータにアクセスし利用できるように、機械可読で非専有の電子フォーマットで公開されていなければならない。また、データは一般に公開され、パスワードやファイアウォールによる制限を受けずに、公共のサーバーでアクセスできなければなりません。オープンデータを見つけやすくするために、ほとんどの組織がオープンデータカタログを作成し管理しています。

## 日本から世界を見る

以下では、世界銀行の、世界開発指標を利用するが、他にも、[UNdata](https://data.un.org)、[OECD data](https://data.oecd.org)、[WID](https://wid.world)、[Eurostat](https://ec.europa.eu/eurostat)、[Our World in Data](https://ourworldindata.org) なども、同様の、ダッシュボードを備えており、データの提供もしている。日本では、[e-Stat](https://www.e-stat.go.jp/)、[ダッシュボード](https://dashboard.e-stat.go.jp)

* 日本のデータはどうでしょうか。

## 世界銀行（World Bank）

* World Bank: https://www.worldbank.org
* [Who we are](https://www.worldbank.org/en/who-we-are):
  - To end extreme poverty: By reducing the share of the global population that lives in extreme poverty to 3 percent by 2030.
  - To promote shared prosperity: By increasing the incomes of the poorest 40 percent of people in every country. 
* World Bank Open Data: https://data.worldbank.org
  - Data Bank, World Development Indicators, etc.
  


### 世界開発指数（World Development Indicator (WDI)）

* [World Development Indicators (WDI)](https://datatopics.worldbank.org/world-development-indicators/) : the World Bank’s premier compilation of cross-country comparable data on development; 1400 time series indicators
  - Themes: Poverty and Inequality, People, Environment, Economy, States and Markets, Global Links
  - Open Data & DataBank: Explore data, Query database
  - Bulk Download: Excel, CSV
  - API Documentation


### World Bank: WDI - World Development Indicaters

* 世界銀行（World Bank）: https://www.worldbank.org
* [世界銀行について（Who we are）](https://www.worldbank.org/en/who-we-are):
  - 極度の貧困状態の削減（To end extreme poverty）: 2030年までに、極度の貧困状態にある世界人口の割合を3%に削減する。By reducing the share of the global population that lives in extreme poverty to 3 percent by 2030.
  - 繁栄を共に享受（To promote shared prosperity）: すべての国の最貧困層の40％の人々の所得を増加させることによって共栄を促進。By increasing the incomes of the poorest 40 percent of people in every country. 
* 世界銀行オープンデータ（World Bank Open Data）: https://data.worldbank.org
  - Data Bank, World Development Indicators, etc.
  
日本について：https://data.worldbank.org/country/japan?view=chart

### 世界開発指標（World Development Indicator）

* [World Development Indicators (WDI)](https://datatopics.worldbank.org/world-development-indicators/) : 世界銀行が開発に関する各国間比較可能なデータの集大成である1400の時系列指標（the World Bank’s premier compilation of cross-country comparable data on development; 1400 time series indicators）
  - テーマ別（Themes）: 貧困と格差、人間、環境、経済、国家と市場、グローバルリンク集（Poverty and Inequality, People, Environment, Economy, States and Markets, Global Links）
  - オープンデータとデータバンク（Open Data & DataBank）: Explore data, Query database
  - Bulk Download: Excel, CSV
  - API Documentation


### 例

#### GDP per capita (constant 2015 US$)

実質GDP（2015年を基準にしたもの）を、総人口で割った値。アメリカ合衆国、英国、ドイツ、フランス、日本、中国、日本、ロシア、ウクライナの2021年における比較棒グラフ - [リンク](https://data.worldbank.org/indicator/NY.GDP.PCAP.KD?locations=JP-GB-RU-FR-CN-US-UA-DE&start=2021&end=2021&view=bar)

<iframe src="https://data.worldbank.org/share/widget?end=2021&indicators=NY.GDP.PCAP.KD&locations=JP-GB-RU-FR-CN-US-UA-DE&start=2021&view=bar" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

年次変化を示す折線グラフ - 

<iframe src="https://data.worldbank.org/share/widget?end=2021&indicators=NY.GDP.PCAP.KD&locations=JP-GB-RU-FR-CN-US-UA-DE&start=1960&view=chart" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

#### Central government debt, total (% of GDP)

2020年の政府の負債（GDP の百分率）- [リンク](https://data.worldbank.org/indicator/GC.DOD.TOTL.GD.ZS?locations=JP-GB-RU-FR-CN-US-UA-DE&start=2020&end=2020&view=bar)

<iframe src="https://data.worldbank.org/share/widget?end=2020&indicators=GC.DOD.TOTL.GD.ZS&locations=JP-GB-RU-FR-CN-US-UA-DE&start=2020&view=bar" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

政府の負債（GDP の百分率）の年次変化を示す折線グラフ
<iframe src="https://data.worldbank.org/share/widget?indicators=GC.DOD.TOTL.GD.ZS&locations=JP-GB-RU-FR-CN-US-UA-DE" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

#### CO2 emissions (metric tons per capita)

CO2 排出量 (1 人あたりのメートル トン) - [リンク](https://data.worldbank.org/indicator/EN.ATM.CO2E.PC?locations=JP-GB-RU-FR-CN-US-UA-DE&start=2019&end=2019&view=bar)

<iframe src="https://data.worldbank.org/share/widget?end=2019&indicators=EN.ATM.CO2E.PC&locations=JP-GB-RU-FR-CN-US-UA-DE&start=2019&view=bar" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

CO2 排出量 (1 人あたりのメートル トン) の年次変化の折線グラフ

<iframe src="https://data.worldbank.org/share/widget?end=2019&indicators=EN.ATM.CO2E.PC&locations=JP-GB-RU-FR-CN-US-UA-DE&start=1990&view=chart" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

#### Military expenditure (% of GDP)

2021年の軍事費 (GDP の %) - [リンク](https://data.worldbank.org/indicator/MS.MIL.XPND.GD.ZS?locations=JP-GB-RU-FR-CN-UA&start=2021&end=2021&view=bar)

<iframe src="https://data.worldbank.org/share/widget?end=2021&indicators=MS.MIL.XPND.GD.ZS&locations=JP-GB-RU-FR-CN-UA&start=2021&view=bar" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

軍事費 (GDP の %) の年次変化

<iframe src="https://data.worldbank.org/share/widget?indicators=MS.MIL.XPND.GD.ZS&locations=JP-GB-RU-FR-UA-KR-DE&view=chart" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

#### Military expenditure (current USD)

2021年の軍事費 (現在の米ドル)  

<iframe src="https://data.worldbank.org/share/widget?end=2021&indicators=MS.MIL.XPND.CD&locations=JP-GB-RU-FR-CN-UA&start=2021&view=bar" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

軍事費の年次変化

<iframe src="https://data.worldbank.org/share/widget?indicators=MS.MIL.XPND.CD&locations=JP-GB-RU-FR-UA-KR-DE&view=chart" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

#### Proportion of seats held by women in natinal parliaments (%)

2021年、国会で女性が占める議席の割合 (%) - [リンク](https://data.worldbank.org/indicator/SG.GEN.PARL.ZS?locations=JP-GB-RU-FR-CN-US-UA-DE&start=2021&end=2021&view=bar)

<iframe src="https://data.worldbank.org/share/widget?end=2021&indicators=SG.GEN.PARL.ZS&locations=JP-GB-RU-FR-CN-US-UA-DE&start=2021&view=bar" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

国会で女性が占める議席の割合 (%) の年次変化

<iframe src="https://data.worldbank.org/share/widget?indicators=SG.GEN.PARL.ZS&locations=JP-GB-RU-FR-CN-US-UA-DE" width='450' height='300' frameBorder='0' scrolling="no" ></iframe>

## 世界のさまざまな課題から見る

## OECD

OECD Data: https://data.oecd.org/

## UN Data

UNdata: https://data.un.org

## Our World in Data

owid: https://ourworldindata.org/

## Eurostat

eurostat: https://ec.europa.eu/eurostat

<!--chapter:end:11-publicdata.Rmd-->

# (PART) PART II BASICS {-}
# R Studio で R {#ronrstudio}

## はじめに

この章では、R と R Studio をインストールし、正常に動作しているかを、確認することを目標とします。実際の、使い方は、次の章以下で、述べます。

また、Posit Cloud など、R Studio 以外で、R を使う方法も、最後に述べます。特に、Posit Cloud は、一定の制限はあるものの、基本的には、R Studio で R を使うのと、同様のことが可能な、Cloud 環境ですので、R と R Studio のインストールに成功した場合も、利用方法を確認してください。

確認の段階で、エラーが出てしまった場合の解決方法も、下に書きますが、まずは、Posit Cloud など、他の方法でR を使えるようにして、時間のあるときに、解決を試みてください。

## R と R Studio

> R is a free software environment for statistical computing and graphics. It compiles and runs on a wide variety of UNIX platforms, Windows and MacOS. https://www.r-project.org

> R は、無償で提供されている、統計解析ともに、データサイエンスにおいてたいせつな可視化のためのグラフを描写する環境でもあります。Windows、MacOS や、Linux で利用することが可能です。

> RStudio is an integrated development environment (IDE) for R and Python. It includes a console, syntax-highlighting editor that supports direct code execution, and tools for plotting, history, debugging, and workspace management. RStudio is available in open source and commercial editions and runs on the desktop (Windows, Mac, and Linux).　https://posit.co/products/open-source/rstudio/

> RStudio は、R と Python のための、総合開発環境（IDE）です。RStudio には、プログラムを実行したり、制御やジョブ管理のための、コンソール（console）、コードを書いたり、実行したりする、文書の編集をする、エディター（Editor）とともに、グラフを表示したり、履歴や、プログラムを修正するなどのための、さまざまなツールが付属しています。RStudio はオープンソースで提供され、Windows、Mac および、Linux で利用可能で、有償版のサービスと無償版を提供しています。

R は、統計解析のためのシステムで、R Studio は、R（および Python）を利用するための、総合開発環境です。そこで、「R Studio で R を利用する」という表現をします。

## R と R Studio のインストール

R と R Studio をインストールします。

両方とも、インストールすることが必要です。

今後のために、動作確認を、RNotebook を使って行います。

:::{.rmdcaution}
**注意**

以下は、自分のコンピュータ、すなわち、管理者権限があるコンピュータにインストールすることを前提に書きます。

家族で、コンピュータを共有していて、管理者権限がない場合は、管理者権限のあるかたに、R と RStudio をインストールしてもらってください。そうすれば、そのコンピュータの他のアカウントでも利用することができます。

ある制約がかかるとメッセージが出ますが、管理者権限なしで、インストールすることも可能です。特別の事情があり、管理者権限なしで、インストールする場合は、[こちら](https://icu-hsuzuki.github.io/myds/techmemo.html#%E9%9D%9E%E7%AE%A1%E7%90%86%E8%80%85%E3%81%A8%E3%81%97%E3%81%A6-r-%E3%81%A8-rstudio-%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB)を参照してください。
:::

### R のインストール

https://cloud.r-project.org

上のリンクから、Windows、macOS または、Linux を選択して、インストールしてください。

Windows の場合は、base - install R for the first time を選択してください。

macOS の場合は、M1, M2 など、最近の Apple Silicon の CPU で動くコンピュータか、以前の、Intel の CPU で動くものか、選択してください。Mac の左上の、りんごマークの、このコンピュータについてから、確認できます。 

不明の場合は、「R のインストール」と検索してみてください。

### R Studio の インストール

http://www.rstudio.com/download

上のリンクから、Windows 10/11 または、macOS 11+ を 選択してください。これら以外の、古いシステムのコンピュータの場合は、 下のサイトから、探してください。

https://docs.posit.co/previous-versions/

不明の場合は、「RStudio のインストール」と検索してみてください。

### 動作確認

動作確認のための、一連の流れを書き、その下に、問題が起こった場合の対処を書きます。

R Studio はこれまでも使っていたが、R Notebook は使ったことがないという方も、同様の確認をしてください。

1. RStudio を立ち上げます。
2. 上のメニューの File から、New Project を選択します。
3. Project の名前を（test とか、firstproject など）つけて、Create ボタンを押します。
4. 上のメニューの File から、New File の R Notebook を選択します。
    * Package が必要なので、Install するかと聞かれますから、インストールを選んでください^[次のステップ5でインストールする場合もあるかもしれません。]。
5. File から、Save as を選んで、名前を（test0, rnotebook など）とつけ、Preview ボタンを押すと、内容が現れます。
6. Preview ボタンの右の、三角印を押すと、Knit PDF と現れますから、それを選択
    * すでに、TeX というシステムを使っておられる方は、PDF が作成されますが、それ以外の方は、なにやらメッセージが出て、TeX システムが無いと出ると思います。
    * 左下の、Console タブに、`tinytex::install_tinytex()` をコピーして、入力し、Enter または、Return キーを押し実行します。
    * もう一度、Kit PDF を（今度は、Preview ボタンが、Knit となっていると思います。その右の三角から Knit PDF  を選択し）押し実行します。

この一連の作業で、最後に、PDF が現れれば、動作確認終了です。クラウド Posit Cloud の項目に進んでください。

ステップ5まで終了すれば、PDF を作成しない限り、問題はありませんので、あとは、時間のあるときに、対応することも可能です。


### トラブル・シューティング（１）

動作確認のステップ 4 （またはステップ５で要求されるパッケージのインストール時点）または、6 でエラーが出る場合があります。

* 動作確認の ステップ 4で、パッケージをたくさんインストールしますが、この段階で、エラーが出る場合があります。そのときは、まず、RStudio の上のメニューの、Tools の一番下の、Global Options を開き、左のメニューから、Packages を選び、Primary CRAN Repository を Change として、CRAN mirror から、Japan: The Institute of Statistical Mathematics, Tokyo を選択してください^[理由は不明ですが、特定のミラーサイトが理由ではなく、https を能動的に設定することで解決が図れるのかなと思います。]。

    - 解決しない場合は、下の、**解決しない場合**はに進んでください。

* 動作確認のステップ 4では、問題なく、パッケージのインストールが完了したが、6で、エラーが出た場合には、Windows の日本語アカウント名の問題の可能性が高いと思います。OneDrive の問題の可能性もないとは言えませんが、次を試してみてください。

  1.  TinyTeX のアンインストール：`tinytex::unstall_tinytex()` を コンソールで実行
  2.  Windowsの自分のアカウントからサインアウトし、サインインしなおす
  3.  TinyTeX をディレクトリを指定してインストール：`tinytex::install_tinytex(dir = "C:/myTinyTeX")` を コンソールで実行
  4.  サインアウトし、サインインしなおす
  5.  上の動作確認のステップ6、R Notebook から knit PDF を利用して、PDF を作成する。
  
  - 解決しない場合は、下の、**解決しない場合は**に進んでください。
  
* **解決しない場合は**、下の囲みの中を読んでください。Windows の、OneDrive 関連の問題の可能性が高いかと思います。
  - その後に書いてあるように、R と RStudio を一度、アンインストールします。（この作業はしなくても、おそらく問題ないと思いますが、安全のためにアンインストールします。）
  - もう一つ別の管理者権限のあるアカウントを（半角ローマ字名で）下の指示に従って作成して、そのアカウントにサインインして、上の、1から6を試してください。
  - 問題なく、1から6が完了したら、しばらく、そちらのアカウントを利用してください。それ以降については、また下に書きます。

  
* 別のアカウントでも、問題が解決しない場合は、コンピュータに詳しい方に相談してください。わたしのホームページにある、メールアドレスから、わたしに相談するときは、次の三つの情報をコピー・ペーストして、教えてください。
  - 上の手順のどこでどのような問題が生じたか、そのときの、エラーメッセージ
  - `Sys.getenv()` の出力
  - Windows の場合、コマンド・プロンプトから、`systeminfo` と入力したときの出力 

:::{.rmdcaution}
**注意**：Windows における既知の不具合について

`Sys.getenv('HOME')` と、`Sys.getenv('R_LIBS_USER')` をそれぞれ、コピーして、RStudio 左下の窓枠の Console タブに、ペーストして、エンターして、???? や、カタカナ、漢字や、OneDrive という文字列が現れるか確認してください。`Sys.getenv()` とすれば、すべての環境変数を確認することもできます^[エクスプローラからユーザ（`C:\Users`）を見ると漢字になっているかどうかの確認ができます。]。

Windows の日本語システムで、アカウント名に日本語を使っておられる方、または、OneDrive を使っていて、Documents（書類）ディレクトリーのすべてをバックアップしておられる方は、ファイルを作成したり、パッケージをインストールするときに、問題が発生する可能性があります。

カタカナや漢字のユーザネームを使っている場合は、RMarkdown で、文書を作成し、PDF で出力するときには、問題が起こります^[PDF の作成には、内部で TeX というプログラムを使っていますが、この TeX システムは、カタカナや漢字が入っているディレクトリには、インストールすることができません。]。解決方法は上に書いたように、一つの解決方法として、TinyTeX を、Home とは異なるところにインストールしています^[別のアカウントを作成して、そこに、TeXLive を インストールする方法もあります。[リンク](https://icu-hsuzuki.github.io/myds/techmemo.html#windows-installation-of-r-rstudio-tex) を参照。]。

OneDrive で、ドキュメントフォルダ全体のバックアップをとっている場合も、問題が起こる可能性がありますが、一般的には書けませんので、困ったときは、下に書く方法を参照してください^[パッケージのインストールや、R Markdown で文書を生成するときには、一時的なファイルを作成して、問題がある場合はレポートする仕組みになっています。そして、問題なくその作業が終了すると、それらのファイルを消去しています。詳細は不明ですが、この作業で、OneDrive でバックアップする作業が入ると、エラーが起きるのではないかと思われます。]。
:::

#### トラブル・シューティング（２）

トラブル・シューティング（１）では解決できない場合の対処法を書きます。わたしは、MacOS では、動作確認の１から６で、問題が起こったと聞いたことがないので、以下では主として、Windows に限って書きます。

実際には、さまざまな理由がありますから、以下の方法では対処できないかもしれません。まず、エラーメッセージを丁寧に見ることが大切ですが、簡単には理解できない場合が多いかと思います。そこで、まず、試してみる方法を以下に書きます。

##### R および RStudio のアンインストール

どのようなアプリも、本来はインストールと同時に、アンインストール（アプリを削除）する方法を知っておくことは大切です。

* **Windows**: 設定から、アプリを選び、アンインストール（削除）したいものを選択して、実行。
* **Mac**: アプリケーションフォルダーから、アプリをみつけ、ゴミ箱へ。

:::{.rmdnote}
**備考**：環境変数のPath について

上記の方法で、残ってしまうものがあります。それは、環境変数 Path の設定です。
アンインストールなどをしたときは、一旦、サインアウトをして、もう一度、サインインしてから確認してください。

Mac は、システムのベースにあるのは、Linux などと同じ、Unix なので、アプリケーションの、ユーティリティ（Utilities）から、Terminal を立ち上げ、
`echo $PATH` とすると、確認できます。RStudio の左下の窓枠にも Terminal があり、そこからでも、同じように確認できます。

Windows の場合は、対応するものには、コマンド・プロンプト（Command Prompt）と、パワーシェル（PowerShell）があります。初期設定^[Tools から Global Option を選択して変更することも可能です。]では、RStudio の左下の窓枠には、コマンド・プロンプトが出ていると思います。そこで、`echo %PATH%` とします。PowerShell の場合は `echo $Env:Path` とすれば、表示できます。

Windows の場合、「設定」から、「環境変数の編集」を検索して、選択すると、Path を見ることができます。上の枠が、ユーザの環境変数、下の枠が、システム環境変数です。ユーザの環境変数の中の、Path（他には、TEMP, TMP もあるかと思います。）をコピーしておくと良いでしょう。Path をダブルクリックして、編集することも可能です。ただし、十分理解しないで、Path を変更すると、問題が起こる可能性がありますので、注意してください。
:::

##### 別のアカウントを作成してインストール

Windows に、もう一つ、アカウントを作成します。

1. [スタート] $>$ [設定] $>$ [アカウント] の順に選択し、[ファミリとその他のユーザー] を選択し、[アカウントの追加] から作成します。

2. どのようにサインインしますかと出ますから、下にある、「このユーザーのサインイン
情報がありません」を選択します。[次へ]

3. つぎに、アカウントを作成しましょうとでますから、特に、なにも入力せず、「Microsoft ア
カウントを持たないユーザーを追加する」を選択します。[次へ]

4. アカウント設定、名前とパスワード、名前は、ローマ字と数字の半角で作成。パスワードは２回入れる。アカウントの名前と、パスワードは記録しておくこと。

5. その下の三つの質問とその答えを記入します。これも、おぼられるものにするか、記録すること。[次へ]

6. アカウントが作成されるが、そのアカウントを選択すると、「アカウントの種類の変更」が選択できるので、「管理者」に変更。[OK] をクリックして終了。

アカウント名をローマ字にします。このアカウントから、インストールしてください。元の日本語アカウントとファイルを共有したいときは、C ドライブのユーザーにあるパブリック（共有）ディレクトリーにコピーしてください。

##### このあとの使い方について

他のアカウントに、R と RStudio をインストールしても、自分のアカウントでも、R と RStudio を利用することが可能です。しかし、漢字やカタカナのアカウント名や、OneDrive の問題は、解決しません。アカウント名を修正することは可能ですが、間違えると、コンピュータ自体が動かなくなりますから、ここでは、説明しませんが、興味のあるかたは、[矢内勇生さんのスライド](https://yukiyanai.github.io/jp/resources/docs/install-R_windows.pdf) を参照してください。

OneDrive は、どのように使われているかによって、対応が変わりますので、一般的な対応方法は書けません。OneDrive は、Microsoft が提供するクラウドサービスで、5GB までは、無料で使えることもあり、コンピュータを使い始めるときに^[Microsoft アカウントを設定すると]、利用を促されます。5GB を超える場合は、課金されます。十分な容量を有料で確保していると、すべて、OneDrive にバックアップすることになり、Home も、OneDrive の管理下に置かれて、上に述べたような、ファイルを書いたり消去したりを頻繁に行うプログラムの場合には、問題が起こるようです。

ただし、バックアップを取ること自体は、とても有効なことですので、設定を変える場合は、十分検討してから行ってください。

個人的には、簡単設定で設定される、デスクトップと、ドキュメントと、フォトのうち、ドキュメントについては、OneDrive バックアップを停止し、ドキュメントの中に、バックアップ用のフォリダーを作成し、その中のもののみ、バックアップするのが良いのではないかと思います。それには、ドキュメントのバックアップを外し、OneDrive の中に、フォルダーを作成して、そこに、バックアップするファイルを移動させます。しかし、使い方などによって、状況が異なりますので、コンピュータに詳しいかたに相談することをお勧めします。

その上で、RStudio のプロジェクトを作成するときは、OneDrive でバックアップをとっていないフォルダーに作成します。

詳細は、下のリンクなどを参照してください。

[参照リンク](https://icu-hsuzuki.github.io/myds/techmemo.html#windows-installation-of-r-rstudio-tex) 
  
## クラウド - Posit Cloud {#positcloud}

Posit（RStudio）Cloudは、誰でもオンラインでデータサイエンスを行い、共有し、教え、学ぶことができる、軽量でクラウドベースのソリューションです。2022年11月に、会社名が、RStuio から Posit に変更になったので、Posit Cloud となっていますが、まだ、RStudio Cloud と表示されている箇所もあります。

### クラウドサービス　How to Start Posit Cloud

まず、サインアップして、使ってください。一ヶ月の利用時間の限度など、設定されていますが、どこからでも、インターネットにつながっていれば使えるので、わたしは、いつくかアカウントを持って、活用しています。

1. [Posit Cloud](https://posit.cloud/) にアクセスします。Go to https://posit.cloud/
2. Get Started または、右上から、Sign UP を選択します。Sign Up: top right
3. Email address or Google account
4. New Project: Project Name

:::{.rmdnote}
**特徴：制限など（Key Features）**

* プロジェクト数の上限は50。Up to 50 projects total
* 共有スペースは一つのみ（5人までのメンバーが10個のプロジェクトまで共有できます） 1 shared space (5 members and 10 projects max)
* コンピュータ時間としては月間最大25時間^[右の`i`マークを押すと詳細な条件を確認できます。]。25 compute hours per month
* 各プロジェクトについて最大 1GB のRAM（Read Access Memory）。Up to 1 GB RAM per project
* 各プロジェクトについて 1 CPU。Up to 1 CPU per project
* 背後で実行する作業は1時間が上限。Up to 1 hour background execution time
:::

大学で課題などに取り組むと、まず、月間25時間の制限に引っかかり、次のようなメッセージが表示されます。

:::{.rmdcaution}
Your account exceeded its compute hour limit. You can continue to open projects in your account until _such and such time_, or until you have used at total of 40 compute hours. After that you will be unable to open projects in space owned by your account until your next usage period begins on _such and such day_.
:::

わたしは、このようなメッセージが出たら、重要度にもよりますが、まずは、プロジェクトをダウンロードし、いつでも、自分のコンピュータで使えるようにしてから、他の、アカウントに引っ越して、作業を続けています。その方法を追記しておきます。

:::{.rmdtips}
**TIPs：**

**プロジェクトをダウンロード：**

プロジェクトのダウンロード：自分のコンピュータに R と R Studio が使える場合は、必要なプロジェクトをダンロードします。ダウンロードするには、左上の3本線から、自分の Workspace にもどり、プロジェクトの右についている、ダウンロードボタンを押します。これは、プロジェクトとして、RStudio から開くことができます。

If you have installed R Studio and R on your computer, From the three lines on the top left, go back to your workspace.
Then there is a download button on the right of your project. You can open it on your computer.

**他のアカウントとの共有：**

1. 異なる電子メールアドレスで別の Posit Cloud アカウントを作成します。（create another Posit Cloud account with another email address.）
2. 使っていたプロジェクトを開き、右上のギアマークから、Change Access を、`You` から、`everyone` に変更します。（In your current project, open the gear mark on the top right, and change access from `You` to `everyone`.）
3. 使っていたプロジェクトのアカウント名の隣にある、三つの点が丸で囲まれているものを選び、`Share Link ` を、別のアカウントを作成したアドレスに送ります。（In your currentproject, next to your account name, there is a circle with three dots. Share the link and send the email to another account.）
4. 使っていた、元のアカウントからログアウトし、新しいアカウントを開き、送られてきたアドレスクリック、またはコードを入れると、使っていたプロジェクトが開き、Temporary Copy と出ます。編集して使いたい時は、それを Permanent Copy にすると、新しいアカウントで編集し、使うことができます。（Then, you can get an access code to your current project. Log out from the existing account, log in to your new account, and then use the link.
Then you can see the temporary file containing everything in your old account and use it for a permanent project.)
:::

### PositCloud Shared Project

わたしのプロジェクトを一つ共有してありますので、興味のある方はご覧ください、

1. まず、自分の、PositCloud アカウントにログインする。
2. [リンク](https://posit.cloud/content/5539763) をクリック
3. 上に、Temporary Copy と出ています。このままでの、右下の、窓枠から、Files を選び、開いて中身を見たり、Code Chunk を実行したり、Preview や、knit をすることも可能です。Try Again と表示されますが、それをクリックすると、表示されます。R Markdown などの詳細は、R Markdown の章をみてください。
4. 上に、Save a Permanent Copy とあります。これを、クリックすると、自分の、プロジェクトとすることができ、編集も可能になります。

### Posit Primers and Cheat Sheet

Posit Primers の左の帯（表示されていない場合は、左上の３本線をクリックしてください）をみると、いろいろな機能があることがわかります。特に、Primers は、基本的な練習をするプログラムで、あとからも、紹介しますが、答えを入力している形の練習問題になっています。とても有用です。

Cheat Sheet は、いくつもの、機能の一覧が、早見表の形式で載っています。使い方などをぼえておくことはできないので、わたしも、よく使っています。

## R のその他の利用方法

R Studio または、RStudio Cloud（Posit Cloud） 以外で、R を使われる方のために、少しだけ書いておきます。個人的には、[Google colab](https://colab.research.google.com) と、[Cocalc](https://cocalc.com) を利用しています。

Google colab は、Google アカウントの作成、Cocalc は、Cocalc アカウントの作成、または、Google アカウントか、GitHub アカウントのリンクが必要です。

Google アカウントをお持ちの方は多いと思うので、Google colab について、最低限のことのみ、書いておきます。

### Google colab で R

基本的に、`python` 開発環境として構築されているものですが、R でも使うことができます。

1. Google アカウントにログインします。
2. [ここ](https://colab.research.google.com/#create=true&language=r) をクリックして起動します。
3. 一番上に、ノートブック名が `Untitled0.ipynb` などと表示されますから、適当に変更します。
4. ＋コード、＋テキスト　とあり、最初のコードの１行が表示されていますから、たとえば、`head(cars)` と入れて、左の三角を押します。すると、最初だけ少し時間がかかりますが、その下に結果がでます。
5. 次に、上や、最後の行の直下に、表示される、＋コード、＋テキスト をクリックして、あたらしい、コード・チャンクか、テキスト・チャンクを書き入れていきます。
6. `tidyverse` などは、すでにインストールされていますが、使いたいときは、`library(tidyverse)` とし、インストールされていないときは、`install.packages("WDI")` などとします。

ノートを、保存、印刷、ダウンロードなど可能です。

フォルダーを作成して、外部ファイルを読み込んだり、書き出したりすることも可能です。

#### 参考

* [How to use R in Google Colab:](https://towardsdatascience.com/how-to-use-r-in-google-colab-b6e02d736497)


### CoCalc で R と RMarkdown

[Cocalc リンク](https://cocalc.com)

無償版は、スピードが遅いですが、個人的には、有用なクラウドサービスとして、活用しています。グループでプロジェクトを共有することも簡単にできます。

1. 最初は、上のリンクの下にある、SinUp から、アカウントを作成します。
  - Email アドレス、または、Google などのアカウントにリンクさせて、アカウントを作成することが可能です。
2. Create a New Project から、プロジェクトを作成します。
3. 使い方
  * New から、Sage Worksheet を選択して、`%default_mode r` と最初に書けば、そのあと、R のコマンドを実行できます。
  * New から、RMarkdown を選択すると、RMarkdown 文書を作成することができます。
  * 他にも、TeX や、Python Notebook (Jupyter Notebook) など、さまざまな道具が提供されています。
  * Maxima と呼ばれる、Maathematica の Free のバージョンから改良した、SageMath からスタートしたサイトです。


<!--chapter:end:21-r-on-rstudio.Rmd-->

# R Markdown {#rmarkdown}

## Reproducible and Literate Programming

データサイエンスは、サイエンス（科学）ということばもついていますが、特に、根拠に基づいた（evidence based）とか、データに基づいた（data based）ということばを使うときには、なおさら、再現可能性（reproducibility）や、コードの内容の説明などのコミュニケーションにも注力する必要があります。このことを心がけて、データサイエンスを学んでいきましょう。

表題にある、"Reproducible and Literate Programming" は、Reproducible （再現可能）かつ、Literate　な（理解できるように記述した）Program（プログラム・コード）を共有することをたいせつにしましょうということです。

### 目的、問いなど

プロジェクトの目的、問いなどは、途中で変わっていくこともありますが、その都度に、メモをしておくと良いでしょう。

### データについて

どのようなデータをどのように取得してきたかを、記録し、伝えられるようにすることが、必要です。データを取得するときから、取得方法や、それを伝える方法にも常に気をつけましょう。

### コードについて

どのようなコードでそのグラフ（chart）などが得られたかも、単にコードを記述するだけでなく、それぞれの部分に、説明を付与することも有効です。

### グラフについて

視覚化（visualization）は、とても有効です。そこで、見て理解したこと、観察したこと（observations）などは、簡単でも構いませんから、必ず、記録しておきましょう。

### まとめ：R Markdown の目的

まさに、このようなことを可能にするのが、R Markdown です。少しずつ学んでいきましょう。

## 準備：パッケージのインストール

Rパッケージは、Rの拡張機能で、コード、データ、ドキュメントを標準化されたコレクション形式で含んでおり、標準的なものは、R Studio の Top Bar の Tool > Install Packages からインストールできます。

* `tidyverse`
* `rmarkdown`
* `tinytex`

インストールを複数回しても問題はありませんが、インストールされているかどうかは、Packages タブから確認することができます。

インストールは一回だけ。ときどき、Tools > Check for Package Update をつかって、Update しておくと良いでしょう。


## R Notebook

R Markdownはデータサイエンスのためのオーサリングフレームワーク。

コード（プログラム）とその実行結果、を記録・表示し、高品質のレポートの作成を可能にします。

R Notebook は、独立してインタラクティブに実行できるチャンクを持つR Markdownドキュメントの一つの形式で、入力のすぐ下に出力が表示することができます。

1. File > New File > R Notebook
2. Save with a file name, say, test-notebook
3. Preview by [Preview] button
4. Run Code Chunk plot(cars) and then Preview again.

## 日本語のテンプレート

下のリンクを開き、右上の Code ボタンから、Download Rmd を選択すると、ダウンロードできますから、ダインロードしたものを、プロジェクト・フォールダーに移動またはコピーしてください。ダウンロードできないときは、Ctrl を押しながら、Download Rmd をクリックすると、Save As で保存できると思います。ブラウザーによって仕様が異なりますから、適切な方法を選んでください。

* https://ds-sl.github.io/intro2r/RNotebook-J.nb.html
* https://ds-sl.github.io/intro2r/Rmarkdown-J.nb.html

Windows でも、Mac でも提供されている、Google Chrome の場合には、Code ボタンから、ダンロードされるはずです。

RNotebook の新しいファイルを作成し、下のサイトを表示させて、コピー・ペーストで、書き換えることも可能です。

* https://ds-sl.github.io/intro2r/RNotebook-J.html
* https://ds-sl.github.io/intro2r/Rmarkdown-J.html


## R Markdown いくつかの Output
```
---
title: "Testing R Markdown Formats"
author: "ID Your Name"
header-includes:
  - \usepackage{ctex}
output:
  html_notebook: default
  html_document: default
  pdf_document: default
    latex_engine: xelatex
  word_document: default
  powerpoint_presentation: default
  ioslides_presentation: default
---
```

**PDFでエラー？** コンソールで `tinytex::install_tinytex()`

* TeX システムがインストールされている場合は不要

エラーの例を書いておきます。`tinytex::install_tinytex()` おらず、他の TeX システムもインストールしていない環境で、上に引用した、`RNotebook-J` から、PDF を作成したときに生じたエラーです。ここに

```
If you are not sure, you may install TinyTeX in R: tinytex::install_tinytex()
```

「よくわからない場合は、RでTinyTeXをインストールすることもできます: `tinytex::install_tinytex()`」

と書いてあります。

**エラーメッセージの例**

```
processing file: RNotebook-J.Rmd

“C:/Program Files/RStudio/bin/quarto/bin/tools/pandoc” +RTS -K512m -RTS RNotebook-J.knit.md –to latex –from markdown+autolink_bare_uris+tex_math_single_backslash –output RNotebook-J.tex –lua-filter “C:000117x-library\4.2.lua” –lua-filter “C:000117x-library\4.2-div.lua” –embed-resources –standalone –highlight-style tango –pdf-engine pdflatex –variable graphics –variable “geometry:margin=1in” output file: RNotebook-J.knit.md

Error: LaTeX failed to compile RNotebook-J.tex. See https://yihui.org/tinytex/r/#debugging for debugging tips. In addition: Warning message: In system2(…, stdout = if (use_file_stdout()) f1 else FALSE, stderr = f2) : ‘“pdflatex”’ not found Execution halted

No LaTeX installation detected (LaTeX is required to create PDF output). You should install a LaTeX distribution for your platform: https://www.latex-project.org/get/

If you are not sure, you may install TinyTeX in R: tinytex::install_tinytex()

Otherwise consider MiKTeX on Windows - http://miktex.org

MacTeX on macOS - https://tug.org/mactex/ (NOTE: Download with Safari rather than Chrome strongly recommended)

Linux: Use system package manager
```

## YouTube Video - rmarkdown

<iframe width="560" height="315" src="https://www.youtube.com/embed/-E_XLf15YHs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

### RMarkdown で PDF を作成するときの注意

RMarkdown では、`tinytex` パッケージというとても素晴らしいものが提供されています。これは、TeXLive というシステムを扱うためのものですが、LiveTeX 全体は、3GB 程度ありますが、非常に小さなファイルで、必要なものだけ、導入できるようになっています。

\TeX システムを、使われる方は、TeXLive が、インストールされているかと思いますので、それを使うことが狩野樹になっています。

一応、TeXLive がインストールされていて、そのあとに、TinyTeX をインストールしようとすると、拒否されますが、インストール、アンインストールなどをしていると、Path も変更になるため、問題が起こり、PDF が作成できなくなる場合もあります。

その場合の対処も含めて、下に書きます。

アカウントに漢字やカタカナが入っていると、PDF が作成できません。

#### `tinytex` によるインストール方法

* tinytex::install_tinytex(dir = "C:/TTeX") 
* 環境変数の設定：
  - `Path=C:\**UserName**\AppData\Local\Microsoft\WindowsApps;C:\TTeX\bin\windows`
  - UserName の部分は、ご自分のユーザネームに変更　\ は日本語システムでは、¥ と表示されているかもしれません。

:::{.rmdnote}

これで解決しない場合は、Windows に、もう一つ、アカウントを作成し^[[スタート] > [設定] > [アカウント] の順に選択し、[ファミリとその他のユーザー] を選択し、[アカウントの追加] から作成。]、アカウント名を英語にして、そちらから、インストールしてください。元の日本語アカウントとファイルを共有したいときは、共有ディレクトリーにコピーしてください。

すべての状況は確認できませんので、ここまでとします^[元のアカウントから、利用したり、Home を変更したりなど、いろいろな方法で、解決することも可能ですが、自信がない場合には、上の方法で、別のアカウントから、利用してください。]。Chat GPT に確認したやりとりは、[ここ](https://icu-hsuzuki.github.io/ds_education/chatgpt.html#chatgpt)にあります。自分で確認をして、HOME の変更などをしてみても良いですが、問題が生じた時に、サポートできませんから、一般的な方法としては、書かないことにします。

注：矢内勇生さんの[サイト](https://yukiyanai.github.io/jp/resources/docs/install-R_windows.pdf)には、詳細な説明があります。
:::



<!--chapter:end:22-rmarkdown.Rmd-->

# R Basics {#rbasics}

## プロジェクト - Project

RStudio で R を利用する場合には、プロジェクトを作成することを強く勧めます。

1. まず、R Studio を起動します。

2. 上のメニューの、File から、New Project を選択します。New Directory（新しいディレクトリー）を選択し、プロジェクトを作成する Directory を決めて、名前をつけます。その名前が、プロジェクト名になります。

  - Directory（フォルダー）を指定してその名前をつけて、プロジェクトを作成します。
  - Directory が階層に分かれているときは、どこに作成するかを選択してから、名前をつけて、作成します。
  
3. 一旦、R Studio を終了してみましょう。

4. プロジェクトの起動には、いくつかの方法があります。

  - まず、R Studio を起動。一つしかプロジェクトがない場合は、そのプロジェクトが起動すると思います、。上に、プロジェクト名が掲載されていれば、問題ありません。
  - File から、Open Project を選択し、起動したい、プロジェクトの Directory（フォルダー）を選択して起動します。
  - File から、Recent Project（最近使ったプロジェクト）を選択すると、プロジェクト名が表示されますから、選択すると起動することができます。
  - コンピュータのプロジェクト入っているディレクトリー（フォルダー）をさがし、そこに、プロジェクト名.Rproj とあるものを見つけて、それを開くと、そのプロジェクトが起動します。
  
5. 作業後は、保存しますかと聞かれますから、保存して終了してください。

## コンソールで実行 - Run in Console

プログラム（コード）の実行には、いくつかの方法がありますが、一番、基本的な、コンソール（Console）での実行について、説明します。Console は、R Studio の左下にあります。（左の枠が一つになっているかもしれません。その一番左のタブが Console です。選択されていない場合は、Console を選択してください。）

### 最初の四つ

下の、四つを、一つずつ、一番下の、> マークの次に書き（または、コピー・ペーストして）Return または、Enter キーを押してください。実行結果が、その下に出ます。最後の、`plot(cars)` は、`cars` というデータの、散布図が右下の、Plots タブに表示されます。

* `head(cars)`
* `str(cars)`
* `summary(cars)`
* `plot(cars)`

エラーが表示されたら、もう一度、スペルを確認して、入力してみてください。

次のような、結果が表示されると思います。簡単な説明をつけます。


```r
head(cars)
#>   speed dist
#> 1     4    2
#> 2     4   10
#> 3     7    4
#> 4     7   22
#> 5     8   16
#> 6     9   10
```

`head(cars)` は、`cars` という、R に付属している、データの、最初（頭 head）の6行を、表示します。


```r
str(cars)
#> 'data.frame':	50 obs. of  2 variables:
#>  $ speed: num  4 4 7 7 8 9 10 10 10 11 ...
#>  $ dist : num  2 10 4 22 16 10 18 26 34 17 ...
```

`str(cars)` は、`cars` という、R に付属している、データの構造（structure）を表示します。`data.frame` とありますが、これは、矩形になったデータ（各列の長さがおなじ）の一番簡単なクラスの名前で、2変数、それぞれが、50 個の数値データ（numerical data） からなっていることがわかります。

`head(cars)` では、縦に表示されていたものが、横に表示されています。`$speed`、`$dist` とありますが、`cars$speed`, `cars$dist` は、`cars` データの、それぞれの列を意味します。


```r
summary(cars)
#>      speed           dist       
#>  Min.   : 4.0   Min.   :  2.00  
#>  1st Qu.:12.0   1st Qu.: 26.00  
#>  Median :15.0   Median : 36.00  
#>  Mean   :15.4   Mean   : 42.98  
#>  3rd Qu.:19.0   3rd Qu.: 56.00  
#>  Max.   :25.0   Max.   :120.00
```
`cars` データの概要（summary）が表示されます。各列（変数）について、最小値（Minimum）、小さい方から、4分の1を切り捨てたときの最小の値（1st Quadrant）、中央値（Median）、平均（Mean）、大きい方から、4分の1を切り捨てたときの最大の値（3rd Quadrant）、最大値（Maximum）が表示されます。


```r
plot(cars)
```

![](24-rbasics_files/figure-latex/unnamed-chunk-4-1.pdf)<!-- --> 

右下の、窓枠の、Plots に、上のグラフ（散布図）が表示されると思います。Export と書いてある、プルダウンメニューがあり、そこから、画像として保存することも、可能です。

以前は、このように取り出した画像を、Word などに貼り付けて、使っていました。現在でも、そのような方法を知っていることは有効だと思います。

### アサインメント、ヘルプ

コンソールで次のそれぞれを、試してみてください。

* `df <- cars`

`df` に、`cars` をアサインします。すなわち、`df` が、`cars` の内容に置き換わります。`cars` はデータですが、データを含む、オブジェクトの名前を設定するためにも使います。オブジェクト名は。英文字から始まれば、かなりの自由度がありますが、わたしは、英文字と数字と `_`（underscore） 程度しか使わないようにしています。


* `head(df)`

`head(df)` は、`head(cars)` と同じ出力が得られます。

* `View(cars)`

左上の、窓枠が開き、`cars` というデータ の内容が表示されます。列名のところには、三角形も表示され、それを用いると、大きい順、小さい順などに、並び替えることも可能です。また、フィルター機能も使えます。

* `?cars`

右下の、窓枠の　Help タブに、`cars` の情報が表示されます。Help タブにある、虫眼鏡がついた、検索窓（search window）に、`cars` といれても、同じ結果が得られます。
内容を確認してください。

一番上には `cars {datasets}` とありますが、これは、`datasets` というパッケージの、`cars` だという意味です。そこで、`datasets` を調べてみましょう。

* `?datasets`

"The R Datasets Package" だと書かれていて、さらに、

This package contains a variety of datasets. For a complete list, use library(help = "datasets").

さまざまなデータが含まれています。全てのリストをみるには、`library(help = "datasets")` を使ってください。

とありますから、`library(help = "datasets")` をコンソールに入力してみてください。

* `library(help = "datasets")`

左上の窓枠に、リストが表示されます。古いデータばかりですが、例として使うには、十分すぎるぐらいの、数のデータがあります。これらは、Toy Data（おもちゃのデータ）と呼ばれることもあります。

`cars` も見つかりましたか。


### おすすめ

コンピュータのシステムが、日本語であると、R の言語も日本語になっているはずです。そこで、エラーが発生すると、一部、日本語で表示されます。しかし、ネット上などで、そのエラーの対応を検索するときは、英語のエラーメッセージで検索した方が、解決方法が得られる可能性が圧倒的に高いので、わたしは、英語に設定しています。英語にするには、Console で次のようにします。

言語を英語に設定：`Sys.setenv(LANG = "en")`

RStudio を終了して、もう一度起動すると、日本語に戻っていると思います。ですから、作業の最初、または、エラーが出たら、変更することをお勧めします。

日本語に戻したいときは、次のようにします。

言語を日本語に設定：`Sys.setenv(LANG = "ja")`

さまざまな Help なども、すべて日本語で表示されれば日本語を使うのは有効かもしれませんが、すくなくとも、現在は、そうではないので、上に説明したことから、英語に設定することをお勧めします。

### 練習

1. `head(cars, 10L)` は何が出力されますか。`head(cars, n=10L)` と同じですか。
2. `?head` または、Help の検索窓に `head` と入力して、説明を見てみてください。`head(cars, n=10L)` などについて、書いてありましたか。他には、どのようなことが分かりましたか。
3. `datasets` のデータのいくつかについて、そのデータの help や、`head`, `str`, `summary` などを使ってみてください。これらで表示できない場合はありますか。データについては、最初に、これら、三つを試してみることをお勧めします。わかったことをメモしておくと良いでしょう。`datasets` のリストをみるには、`library(help = "datasets")` でしたね。

## RStudio について

RStudio は多くの機能を持っています。

### 四つの窓枠とタブ Four Panes and Tabs

* 左上（Top Left）: スクリプトや文書、データなどの編集（Source Editor）
* 右上（Top Right）: 環境変数（Environment）, 履歴（History） など（etc.）
* 左下（Bottom Left）: コードの実行・実行結果などを表示するコンソール（Console）, コンピュータシステムの端末（Terminal）, 文書の機械語翻訳（Render）, 背後での作業（Background Jobs）
* 右下（Bottom Right）: ファイル（Files）, 描画（Plots）, パッケージ（Packages）, ヘルプ（Help）, 文書などの表示窓（Viewer）, R Markdown の HTML, PDF 表示（Presentation^[Viewerへの表示を使っており、Presentationへの表示を使っておらず不明]）

## R Script 実行記録

R Script を使って、コードを実行すると、その記録を残すことができます。

### R Script の作成

* RStudio の上のメニュー・バーからFile > New File > R Script を選択します。
* File > Save As で、名前をつけて保存します。{file_name}.R が作成されます。
  - 右下の、Files から、ファイルを確認してください。
* `head(cars)`, `str(cars)`, `summary(cars)`, `plot(cars)` などと改行をしながらコードを書きます。
* 実行するには、カーソルの場所で Ctrl+Shift+Enter (Win) または Cmd+Shift+Enter (Mac) とすると、カーソルのある行か、その下の行で、最初のコードが実行されます。
  - R Script エディターの上にある、Run ボタンを押しても、同様に実行されます。
  - Run ボタンの右の、Source ボタンを押すと、そのスクリプトの、最初からすべてが実行されます。
* 最後には保存しておきましょう。たとえば、`myfirstscript` などとすると、File のところに、`myfirstscript.R` というファイルができていることを確認できます。

### R Script による実行

新しく、R Script を作成し、この下の、コード（ハイライトされている部分）をコピー・ペーストして、保存し、実行してみてください。

それぞれ、どのようなことをしているでしょうか。


#### スクリプト1: `basics.R`


```r
#################
#
# basics.R
#
################
# 'Quick R' by DataCamp may be a handy reference: 
#     https://www.statmethods.net/management/index.html
# Cheat Sheet at RStudio: https://www.rstudio.com/resources/cheatsheets/
# Base R Cheat Sheet: https://github.com/rstudio/cheatsheets/raw/main/base-r.pdf
# To execute the line: Control + Enter (Window and Linux), Command + Enter (Mac)
## try your experiments on the console

## calculator

3 + 7

### +, -, *, /, ^ (or **), %%, %/%

3 + 10 / 2

3^2

2^3

2*2*2

### assignment: <-, (=, ->, assign()) 

x <- 5

x 

#### object_name <- value, '<-' shortcut: Alt (option) + '-' (hyphen or minus) 
#### Object names must start with a letter and can only contain letter, numbers, _ and .

this_is_a_long_name <- 5^3

this_is_a_long_name

char_name <- "What is your name?"

char_name

#### Use 'tab completion' and 'up arrow'

### ls(): list of all assignments

ls()
ls.str()

#### check Environment in the upper right pane

### (atomic) vectors

5:10

a <- seq(5,10)

a

b <- 5:10

identical(a,b)

seq(5,10,2) # same as seq(from = 5, to = 10, by = 2)

c1 <- seq(0,100, by = 10)

c2 <- seq(0,100, length.out = 10)

c1

c2

length(c1)

#### ? seq   ? length   ? identical

(die <- 1:6)

zero_one <- c(0,1) # same as 0:1

die + zero_one # c(1,2,3,4,5,6) + c(0,1). re-use

d1 <- rep(1:3,2) # repeat


d1

die == d1

d2 <- as.character(die == d1)

d2

d3 <- as.numeric(die == d1)

d3

### class() for class and typeof() for mode
### class of vectors: numeric, charcters, logical
### types of vectors: doubles, integers, characters, logicals (complex and raw)

typeof(d1); class(d1)

typeof(d2); class(d2)

typeof(d3); class(d3)

sqrt(2)

sqrt(2)^2

sqrt(2)^2 - 2

typeof(sqrt(2))

typeof(2)

typeof(2L)

5 == c(5)

length(5)

### Subsetting

(A_Z <- LETTERS)

A_F <- A_Z[1:6]

A_F

A_F[3]

A_F[c(3,5)]

large <- die > 3

large

even <- die %in% c(2,4,6)

even

A_F[large]

A_F[even]

A_F[die < 4]

### Compare df with df1 <- data.frame(number = die, alphabet = A_F)
df <- data.frame(number = die, alphabet = A_F, stringsAsFactors = FALSE)

df

df$number

df$alphabet

df[3,2]

df[4,1]

df[1]

class(df[1])

class(df[[1]])

identical(df[[1]], die)

identical(df[1],die)

####################
# The First Example
####################

plot(cars)

# Help

? cars

# cars is in the 'datasets' package

data()

# help(cars) does the same as ? cars
# You can use Help tab in the right bottom pane

help(plot)
? par

head(cars)

str(cars)

summary(cars)

x <- cars$speed
y <- cars$dist

min(x)
mean(x)
quantile(x)

plot(cars)

abline(lm(cars$dist ~ cars$speed))

summary(lm(cars$dist ~ cars$speed))

boxplot(cars)

hist(cars$speed)
hist(cars$dist)
hist(cars$dist, breaks = seq(0,120, 10))
```

#### スクリプト2: `coronavirus.R`


```r
# https://coronavirus.jhu.edu/map.html
# JHU Covid-19 global time series data
# See R package coronavirus at: https://github.com/RamiKrispin/coronavirus
# Data taken from: https://github.com/RamiKrispin/coronavirus/tree/master/csv
# Last Updated
Sys.Date()

## Download and read csv (comma separated value) file
coronavirus <- read.csv("https://github.com/RamiKrispin/coronavirus/raw/master/csv/coronavirus.csv")
# write.csv(coronavirus, "data/coronavirus.csv")

## Summaries and structures of the data
head(coronavirus)
str(coronavirus)
coronavirus$date <- as.Date(coronavirus$date)
str(coronavirus)

range(coronavirus$date)
unique(coronavirus$country)
unique(coronavirus$type)

## Set Country
COUNTRY <- "Japan"
df0 <- coronavirus[coronavirus$country == COUNTRY,]
head(df0)
tail(df0)
(pop <- df0$population[1])
df <- df0[c(1,6,7,13)]
str(df)
head(df)
### alternatively,
head(df0[c("date", "type", "cases", "population")])
###

## Set types
df_confirmed <- df[df$type == "confirmed",]
df_death <- df[df$type == "death",]
df_recovery <- df[df$data_type == "recovery",]
head(df_confirmed)
head(df_death)
head(df_recovery)

## Histogram
plot(df_confirmed$date, df_confirmed$cases, type = "h")
plot(df_death$date, df_death$cases, type = "h")
# plot(df_recovered$date, df_recovered$cases, type = "h") # no data for recovery

## Scatter plot and correlation
plot(df_confirmed$cases, df_death$cases, type = "p")
cor(df_confirmed$cases, df_death$cases)


## In addition set a period
start_date <- as.Date("2022-07-01")
end_date <- Sys.Date() 
df_date <- df[df$date >=start_date & df$date <= end_date,]
##

## Set types
df_date_confirmed <- df_date[df_date$type == "confirmed",]
df_date_death <- df_date[df_date$type == "death",]
df_date_recovery <- df_date[df_date$data_type == "recovery",]
head(df_date_confirmed)
head(df_date_death)
head(df_date_recovery)

## Histogram
plot(df_date_confirmed$date, df_date_confirmed$cases, type = "h")
plot(df_date_death$date, df_date_death$cases, type = "h")
# plot(df_date_recovered$date, df_date_recovered$cases, type = "h") # no data for recovery

plot(df_date_confirmed$cases, df_date_death$cases, type = "p")
cor(df_date_confirmed$cases, df_date_death$cases)

#### Extra
plot(df_confirmed$date, df_confirmed$cases, type = "h", 
     main = paste("Comfirmed Cases in",COUNTRY), 
     xlab = "Date", ylab = "Number of Cases")
```

### 練習

上の、`coronavirus.R` について

1. `COUNTRY <- "Japan"` の Japan を他の国に変えてみましょう。
2. `start_date <- as.Date("2022-07-01")` の日付を、他の日付に変えてみましょう。
3. `df_confirmed$cases` と `df_death$cases` についてどんなことがわかりますか。
4. 発見や、問いがあれば、書き出してみましょう。


### Tips

キーボード・ショートカットと言われる、さまざまな機能があります。

* 上のメニュー・バー： Help > Keyboard Short Cut Help 確認してみてください。
* 右下の窓枠: Files タブから、ファイルの確認ができます。


## パッケージ - Packages

> R packages are extensions to the R statistical programming language containing code, data, and documentation in a standardised collection format that can be installed by users of R using Tool > Install Packages in the top menu bar of R Studio. https://en.wikipedia.org/wiki/R_package

> Rパッケージは、Rの拡張機能で、コード、データ、ドキュメントを標準化されたコレクション形式で含んでおり、標準的なものは、R Studio の Top Bar の Tool > Install Packages からインストールできます。

### パッケージのインストール

いずれ使いますので、まずは、三つのパッケージをインストールしてみましょう。

* `tidyverse`
* `rmarkdown`
* `tinytex`

インストール方法はいくつかあります。

一つ目は、上のメニューバーの Tool から、Install Packages ... を選択します。そして、パッケージーズにインストールしたい、パッケージ名を入力します。そのパッケージ名が下にも出れば、Install ボタンを押してください。入力した名前の下にパッケージ名が出ない場合は、スペルが間違っている可能性がありますから、確認して、入れ直してください。

Console に、`install.packages("tidyverse")` などと表示され、たくさんメッセージが出ます。終了すると、> のマークがでます。

二つ目は、`install.packages("tidyverse")` のような書式で書いて、Console に入れる方法です。

三つ目は、右下の窓枠の Packages のタブにある、Install というボタンを押す方法です。すると、一番目の方法に、戻り、パッケージ名を入力できるようになります。

この Packages タブにある、ものが、すでに、インストールされているパッケージです。そのなかで、`base` や、`datasets` などいくつかに、チェックがついていると思いますが、それらは、ロードされていて、いつでも、使える状態になっていることを意味しています。ロードは、たとえば、`library(tidyverse)` のようにしますが、それは、いずれもう一度説明します。

インストールは一回だけ。ときどき、Tools > Check for Package Update をつかって、Update しておくと良いでしょう。

:::{.rmdnote}
パッケージのインストールで問題が生じることがあります。特に、Windows の日本語システムの場合です。（4.3.2 R Studio の インストール の下に書いてある部分を参照してください。）

回避方法もいくつかあるようですが、混乱をさけるため、その場合は、Posit Cloud（旧：RStudio Cloud）を使うと良いでしょう。それを見越して、最初は、Posit Cloud ではじめることを、わたしはお薦めしています。自分のコンピュータで、R が RStudio 上で問題なく動いていても、Cloud 上にアカウントを持っていて、実行できることは有効ですし、全員が、同じ環境で作業できることもたいせつなことです。他にも、すぐ、Cheat Sheets（早見表）や、Posit Primers という練習問題（Tutorial）を利用できたり、プロジェクトを共有したりなど、さまざまなメリットがあります。
:::

### 備考

Package によっては、Source から Compile するかと聞いてくる場合があります。どちらでも、良いのですが、特に、問題が起こっていなければ、No でよいと思います。コンピュータにあった形でインストールすることが必要な場合は、Yes とします。

同じパッケージをもう一度、インストールしたり、または、関連するパッケージがあるような場合、R をリスタートするかと聞いてくることがあります。特に問題が起こらなければ、No で構いません。ただ、エラーが起こって、それに関連して、特別なパッケージをインストールする必要がある場合がありますが、そのときは、Yes としてください。



## 練習問題 Posit Primers 

Posit Primers https://posit.cloud/learn/primers

教科書 ["R for Data Science"](https://r4ds.had.co.nz) は、`tidyverse` パッケージを中心に、データサイエンスについて解説したものですが、Posit Primers は、演習問題をしながら、教科書の内容を理解できるように構成されています。

Posit Cloud からは、左のメニュー（隠れている場合は左上の3本線をクリックして表示させて）から選ぶことができます。そうでない場合は、直接、上のリンクから、利用してください。

### 最初の演習　The Basics – r4ds: Explore, I

* [Visualization Basics](https://rstudio.cloud/learn/primers/1.1)
* [Programming Basics](https://rstudio.cloud/learn/primers/1.2)

ぜひこれら二つの演習問題を、トライしてください。解説を読んでいただけでは、データサイエンスは身につきません。

## 参考文献 References

一番目は、すでに紹介した、教科書です。二番目は、この文書を作成している、Bookdown というパッケージのサイトですが、そこに、たくさんの本が、無償で公開されています。素晴らしい本がたくさん含まれています。

* R For Data Science, by H. Wickham: https://r4ds.had.co.nz
  - Introduction: https://r4ds.had.co.nz/explore-intro.html#explore-intro
* Bookdown: https://bookdown.org, [Archive](https://bookdown.org/home/archive/)

下の一番目は、R 入門を、２時限の講義でしたときのものです。二番目と三番目は、講義で使ったものを、まとめたものです。教科書のようには、できていませんが、参考になる部分もあるかと思いますので、紹介しておきます。

* [Introducton to R](https://ds-sl.github.io/intro2r/intro2r.nb.html)
* [Data Analysis for Researchers 2022](https://icu-hsuzuki.github.io/da4r2022/)
* [Data Analysis for Researchers 2021](https://icu-hsuzuki.github.io/da4r2021/)

## YouTube Video - getstarted

<iframe width="560" height="315" src="https://www.youtube.com/embed/9uQmMZoG74g" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

* ファイル：https://ds-sl.github.io/intro2r/getstarted.html



<!--chapter:end:24-rbasics.Rmd-->

# (PART) PART III INSTITUTIONAL DATA {-}
# World Bank {#worldbank}



## World Development Indicator (WDI)

パッケージ と `tidyverse` と `WDI` を使いますから、下のコードによって、ロードします。


```r
library(tidyverse)
#> -- Attaching core tidyverse packages ---- tidyverse 2.0.0 --
#> v dplyr     1.1.2     v readr     2.1.4
#> v forcats   1.0.0     v stringr   1.5.0
#> v ggplot2   3.4.2     v tibble    3.2.1
#> v lubridate 1.9.2     v tidyr     1.3.0
#> v purrr     1.0.1     
#> -- Conflicts ---------------------- tidyverse_conflicts() --
#> x dplyr::filter() masks stats::filter()
#> x dplyr::lag()    masks stats::lag()
#> i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
library(WDI)
```

まず、三つの例を見てみましょう。なにをしているかわかりますか。考えて見てください。


```r
WDI(country = "all", indicator = c(gdp = "NY.GDP.MKTP.CD"),
    extra=TRUE) %>% drop_na(gdp) %>%
  filter(year==max(year), income !="Aggregates") %>% 
  drop_na(region) %>% arrange(desc(gdp))
```




```
#> Rows: 16492 Columns: 13
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr  (7): country, iso2c, iso3c, region, capital, income...
#> dbl  (4): year, gdp, longitude, latitude
#> lgl  (1): status
#> date (1): lastupdated
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
#> # A tibble: 196 x 13
#>    country      iso2c iso3c  year     gdp status lastupdated
#>    <chr>        <chr> <chr> <dbl>   <dbl> <lgl>  <date>     
#>  1 United Stat~ US    USA    2021 2.33e13 NA     2022-12-22 
#>  2 China        CN    CHN    2021 1.77e13 NA     2022-12-22 
#>  3 Japan        JP    JPN    2021 4.94e12 NA     2022-12-22 
#>  4 Germany      DE    DEU    2021 4.26e12 NA     2022-12-22 
#>  5 India        IN    IND    2021 3.18e12 NA     2022-12-22 
#>  6 United King~ GB    GBR    2021 3.13e12 NA     2022-12-22 
#>  7 France       FR    FRA    2021 2.96e12 NA     2022-12-22 
#>  8 Italy        IT    ITA    2021 2.11e12 NA     2022-12-22 
#>  9 Canada       CA    CAN    2021 1.99e12 NA     2022-12-22 
#> 10 Korea, Rep.  KR    KOR    2021 1.81e12 NA     2022-12-22 
#> # i 186 more rows
#> # i 6 more variables: region <chr>, capital <chr>,
#> #   longitude <dbl>, latitude <dbl>, income <chr>,
#> #   lending <chr>
```



```r
WDI(country = c("CN","GB","JP","IN","US","DE"), indicator = c(gdp = "NY.GDP.MKTP.CD"), extra=TRUE) %>% drop_na(gdp) %>% 
  ggplot(aes(year, gdp, col = country)) + geom_line() +
  labs(title = "WDI NY.GDP.MKTP.CD: gdp")
```




```
#> Rows: 372 Columns: 13
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr  (7): country, iso2c, iso3c, region, capital, income...
#> dbl  (4): year, gdp, longitude, latitude
#> lgl  (1): status
#> date (1): lastupdated
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
```

![](31-worldbank_files/figure-latex/unnamed-chunk-8-1.pdf)<!-- --> 


```r
WDI(country = c("CN","IN","JP","US"), 
    indicator = c(gdp_growth_rate = "NY.GDP.MKTP.KD.ZG"), extra=TRUE) %>%
  drop_na(gdp_growth_rate) %>% 
  ggplot(aes(year, gdp_growth_rate, col = country)) + geom_line() +
  labs(title = paste("WDI NY.GDP.MKTP.KD.ZG: gdp growth rate"))
```




```
#> Rows: 248 Columns: 13
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr  (7): country, iso2c, iso3c, region, capital, income...
#> dbl  (4): year, gdp_growth_rate, longitude, latitude
#> lgl  (1): status
#> date (1): lastupdated
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
```

![](31-worldbank_files/figure-latex/unnamed-chunk-11-1.pdf)<!-- --> 

まず、世界の国々の、GDP（gross domestic product 国内総生産）のデータを、取得して、2021年の GDP を大きな順に並べています。

値は、たとえば、$2.331508e+13$ のように書かれていますが、これは、科学的記法と呼ばれるもので、$2.331508 \times 10^{13}$ を意味しています。約23兆ドルです。

次に、3兆ドル以上の、６カ国を選択し、その、iso2c と呼ばれるコードを使って、それらの国のデータをもう一度取得し、年次変化をあらわすグラフを描いています。

さらにその中から、４カ国を選んで、今度は、GDP の年次変化率を描いています。単位は、パーセントです。

これは、ひとつの例ですが、ここで使われているのが、WDI World Development Indicator というもので、世界銀行が、いくつかの指標を定めて、編纂しているものです。

### 指標 Indicators (WDI)

上の例では、次の二つの指標のコード Indicator Code (WDI Code) が使われました。

-   NY.GDP.MKTP.CD: GDP (current US\$)
-   NY.GDP.MKTP.KD.ZG: GDP growth (annual %)

### 指標 WDI (World Development Indicators)

> The World Development Indicators is a compilation of relevant, high-quality, and internationally comparable statistics about global development and the fight against poverty. The database contains 1,400 time series indicators for 217 economies and more than 40 country groups, with data for many indicators going back more than 50 years.

> WDIは、世界の開発状況と、貧困との戦いに関する、適切で上質、かつ、国際的に比較可能な時系列の統計データを編纂したものです。このデータベースは、217の経済と40以上の国グループについて1,400の時系列指標を含み、指標のデータの多くは50年以上前に遡ることができます。

-   世界銀行（World Bank）: <https://www.worldbank.org>
-   World Bank Open Data: <https://data.worldbank.org>
    -   Country / Indicator \> Featured & All \> Details
-   [World Development Indicators (WDI)](https://datatopics.worldbank.org/world-development-indicators/) :
    -   Themes: Poverty and Inequality, People, Environment, Economy, States and Markets, Global Links
    -   Open Data & DataBank: Explore data, Query database

### 指標 のコード、WDI code を探してみよう

いくつかの探し方があります。まず、ここでは、World Bank のサイトから探す方法を説明しましょう。

ふた通りあります。

1. [World Bank Open Data](https://data.worldbank.org) にいくと、表題の下の検索窓の下に、 Country / Indicator とありますから、Indicator を選択します。すると、そこに、項目のリストが、Featured と All という二つのタブに分かれて出ています。かなり膨大です。それを選択すると、その項目のサイトに行きます。それが、指標のサイトです。図などの、右上に、Details とありますから、それを選択すると、その中に、Indicator が書かれています。
実は、指標のサイトのアドレス（URL）を見ると、そこにも、この Indicator が書かれていることがわかります。

2. [World Development Indicators (WDI)](https://datatopics.worldbank.org/world-development-indicators/) にいくと、下のようなテーマに分かれています。

Themes: Poverty and Inequality, People, Environment, Economy, States and Markets, Global Links

その中から、選択して、スクロールすると、そこに、指標が書かれています。

Indicator, Code, Time coverage, Region coverage, Get data

とあり、Code が、指標のコードです。実は、すべての年や、すべての地域のデータが揃っているわけではないので、この情報を見ておくことはとても重要です。ほとんど、データがない場合もあります。

一番右端の Get data からは、CSV や、データバンク（Data Bank）へのリンクがあります。

それぞれの方法で、上で使った、二つの指標およびそのコードは見つかりましたか。

1 の方法の途中に出てきた、検索窓から検索することも可能です。

### 指標 WDIの例

このあとの、例で使う指標を書いておきます。

* NY.GDP.MKTP.CD: GDP (current US$)
* NY.GDP.DEFL.KD.ZG: Inflation, GDP deflator (annual %)
* SL.UEM.TOTL.NE.ZS: Unemployment, total (% of total labor force) (national estimate)
* CPTOTNSXN: CPI Price, nominal
* SL.TLF.CACT.MA.NE.ZS: Labor force participation rate, male (% of male population ages 15+) (national estimate)
* SL.TLF.CACT.FE.NE.ZS: Labor force participation rate, female (% of male population ages 15+) (national estimate)

### 練習 1. - 調べてみたい WDI 指標とそのコード

いくつか、リストしてみましょう。

## WDI パッケージ

`WDI` パッケージ の使い方を紹介します。

`WDI` パッケージで、データをダウンロードしたり、探したり、詳細情報を得たりできます。

### 指標 WDI 検索

まず、検索です。上で、サイトから調べる方法を紹介しましたが、`WDI` パッケージの、`WDIsearch` でも探すことができます。詳細は、右下の窓枠の Help タブの検索窓に、WDIsearch といれて調べて見てください。ここでは、二種類の検索方法を紹介します。

#### 検索例 1（WDI名）

WDI 名に、ある文字列が含まれているものを検索します。検索文字列は、大文字・小文字は関係ありません。


```r
WDIsearch(string = "gdp", field = "name", short = TRUE, cache = NULL) %>%
  as_tibble()
#> # A tibble: 540 x 2
#>    indicator            name                                
#>    <chr>                <chr>                               
#>  1 5.51.01.10.gdp       "Per capita GDP growth"             
#>  2 6.0.GDP_current      "GDP (current $)"                   
#>  3 6.0.GDP_growth       "GDP growth (annual %)"             
#>  4 6.0.GDP_usd          "GDP (constant 2005 $)"             
#>  5 6.0.GDPpc_constant   "GDP per capita, PPP (constant 2011~
#>  6 BG.GSR.NFSV.GD.ZS    "Trade in services (% of GDP)"      
#>  7 BG.KAC.FNEI.GD.PP.ZS "Gross private capital flows (% of ~
#>  8 BG.KAC.FNEI.GD.ZS    "Gross private capital flows (% of ~
#>  9 BG.KLT.DINV.GD.PP.ZS "Gross foreign direct investment (%~
#> 10 BG.KLT.DINV.GD.ZS    "Gross foreign direct investment (%~
#> # ... with 530 more rows
```

なんと、500件以上出てきました。Indicator（指標コード）と、Name（指標名）が列挙されます。すべてに、GDP という文字列が入っていることを確認できると思います。

#### 検索例 2（WDI）

Indicator（指標コード）から、Name（指標名）を検索します。


```r
WDIsearch(string = "NY.GDP.MKTP.CD", field = "indicator", short = TRUE, cache = NULL)
#>               indicator
#> 11410    NY.GDP.MKTP.CD
#> 11411 NY.GDP.MKTP.CD.XD
#>                                             name
#> 11410                          GDP (current US$)
#> 11411 GDP deflator, index (2000=100; US$ series)
```

二件出てきました。
  
#### 練習 2. - 検索（short）

名前で検索（"" の間に、（なるべく簡単な）検索文字列を入れてください。）


```r
WDIsearch(string = "", field = "name", short = TRUE, cache = NULL)
```

Indicator で検索（"" の間に、調べたい indicator を入れてください。）


```r
WDIsearch(string = "", field = "indicator", short = TRUE, cache = NULL)
```

  
#### 詳しい情報を得るには

上では、Indicator（指標コード）と、Name（指標名）だけでしたが、Description（説明） なども得ることができます。

それには、`short = FALSE` とします。

一回一回、World Bank にアクセスして調べるのは、時間もかかりますから、Indicator と、名前などの情報をもったファイルを手元に持っておくことにします。それには、次のようにします。


```r
wdi_cache <- WDIcache()
```

これは、series と、country の二つのデータ・フレームからなっているリストです。

右上の窓枠（pane）から、`wdi_cache` を探して、中身を見てみましょう。三角印や、右から二番目の巻物のようなアイコンをクリックすると中身が見えます。

series には、すべての指標がリストされ、その情報が書かれています。

また、country には、それぞれについて、さまざまな情報が書かれています。これは、とても、たいせつな情報です。国名と、iso2c, iso3c のようなコードもありますし、地域（region）や、その国が、どの income level（収入の階級）に入るかも書かれています。また、国だけではなく、地域など、グループの名称も含まれています。

今後、さまざまに利用していきたいと思います。



  
#### 検索例 3（WDI名）

`short = FALSE` として、検索してみましょう。文字列が入っている、指標名を検索します。


```r
WDIsearch(string = "CPI Price", field = "name", short = FALSE, cache = wdi_cache)
#>         indicator
#> 2586    CPTOTNSXN
#> 2587 CPTOTSAXMZGY
#> 2588    CPTOTSAXN
#> 2589 CPTOTSAXNZGY
#>                                                 name
#> 2586                              CPI Price, nominal
#> 2587 CPI Price, % y-o-y, median weighted, seas. adj.
#> 2588                  CPI Price, nominal, seas. adj.
#> 2589         CPI Price, % y-o-y, nominal, seas. adj.
#>                                                                                                                                                                                                                  description
#> 2586                                                                The consumer price index reflects the change in prices for the average consumer of a constant basket of consumer goods. Data is not seasonally adjusted.
#> 2587                                                                Median inflation rate calculated for geographical aggregates (regions, world, etc) of the annual percent change of the CPI. Data is seasonally adjusted.
#> 2588                                               The consumer price index reflects the change in prices for the average consumer of a constant basket of consumer goods. Data is in nominal terms and seasonally adjusted.
#> 2589 The consumer price index reflects the change in prices for the average consumer of a constant basket of consumer goods. Data is in nominal percentage terms, measured on a year-on-year basis, and seasonally adjusted.
#>               sourceDatabase
#> 2586 Global Economic Monitor
#> 2587 Global Economic Monitor
#> 2588 Global Economic Monitor
#> 2589 Global Economic Monitor
#>                                           sourceOrganization
#> 2586 World Bank staff calculations based on Datastream data.
#> 2587 World Bank staff calculations based on Datastream data.
#> 2588 World Bank staff calculations based on Datastream data.
#> 2589 World Bank staff calculations based on Datastream data.
```

- CPTOTNSXN: CPI Price, nominal
  - The consumer price index reflects the change in prices for the average consumer of a constant basket of consumer goods. Data is not seasonally adjusted.

#### 検索例 4（WDI）

指標コードから、詳細情報を得ます。


```r
WDIsearch(string = "NY.GDP.MKTP.KD.ZG", field = "indicator", short = FALSE, cache = wdi_cache)
#>               indicator                  name
#> 12114 NY.GDP.MKTP.KD.ZG GDP growth (annual %)
#>                                                                                                                                                                                                                                                                                                                                                                                                                                                                           description
#> 12114 Annual percentage growth rate of GDP at market prices based on constant local currency. Aggregates are based on constant 2015 prices, expressed in U.S. dollars. GDP is the sum of gross value added by all resident producers in the economy plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources.
#>                     sourceDatabase
#> 12114 World Development Indicators
#>                                                              sourceOrganization
#> 12114 World Bank national accounts data, and OECD National Accounts data files.
```

  
#### 練習 2 - 検索（long w/ cache）

`string` と、`field` を、ふたつとも入れてください。


```r
WDIsearch(string = "", field = "", short = FALSE, cache = wdi_cache)
```


  
### 指標 WDI データのダウンロード

Indicator が決まったら、ダウンロードします。右下の窓枠の Help タブの検索枠に、`WDI` と入れて確認しましょう。 

```
WDI(
  country = "all",
  indicator = "NY.GDP.PCAP.KD",
  start = 1960,
  end = NULL,
  extra = FALSE,
  cache = NULL,
  latest = NULL,
  language = "en"
)
```

上が基本的な用法ですが、`start` 以下は、Default（初期値）が書かれていますから、たいせつなのは、最初の二つ、country と、indicator です。
  
#### ダウンロード例 1-1

country は、初期値も、"all" となっていますから、最も簡単なのは、indicator に、指標コードを入れることです。引用符を忘れずに。


```r
df_gdp1 <- WDI(country = "all", indicator = "NY.GDP.MKTP.CD")
df_gdp1
```


```
#> Rows: 16492 Columns: 5
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr (3): country, iso2c, iso3c
#> dbl (2): year, NY.GDP.MKTP.CD
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
#> # A tibble: 16,492 x 5
#>    country                  iso2c iso3c  year NY.GDP.MKTP.CD
#>    <chr>                    <chr> <chr> <dbl>          <dbl>
#>  1 Africa Eastern and Sout~ ZH    AFE    2021        1.08e12
#>  2 Africa Eastern and Sout~ ZH    AFE    2020        9.27e11
#>  3 Africa Eastern and Sout~ ZH    AFE    2019        1.00e12
#>  4 Africa Eastern and Sout~ ZH    AFE    2018        1.01e12
#>  5 Africa Eastern and Sout~ ZH    AFE    2017        1.02e12
#>  6 Africa Eastern and Sout~ ZH    AFE    2016        8.83e11
#>  7 Africa Eastern and Sout~ ZH    AFE    2015        9.25e11
#>  8 Africa Eastern and Sout~ ZH    AFE    2014        1.00e12
#>  9 Africa Eastern and Sout~ ZH    AFE    2013        9.83e11
#> 10 Africa Eastern and Sout~ ZH    AFE    2012        9.73e11
#> # i 16,482 more rows
```

これでも良いのですが、利用するには、指標コードではわかりにくいので、それを簡単な名前に置き換えて、データを読み込むこができます。

#### ダウンロード例 1-2


```r
df_gdp2 <- WDI(country = "all", indicator = c(gdp = "NY.GDP.MKTP.CD"))
df_gdp2
```


```
#> Rows: 16492 Columns: 5
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr (3): country, iso2c, iso3c
#> dbl (2): year, gdp
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
#> # A tibble: 16,492 x 5
#>    country                     iso2c iso3c  year     gdp
#>    <chr>                       <chr> <chr> <dbl>   <dbl>
#>  1 Africa Eastern and Southern ZH    AFE    2021 1.08e12
#>  2 Africa Eastern and Southern ZH    AFE    2020 9.27e11
#>  3 Africa Eastern and Southern ZH    AFE    2019 1.00e12
#>  4 Africa Eastern and Southern ZH    AFE    2018 1.01e12
#>  5 Africa Eastern and Southern ZH    AFE    2017 1.02e12
#>  6 Africa Eastern and Southern ZH    AFE    2016 8.83e11
#>  7 Africa Eastern and Southern ZH    AFE    2015 9.25e11
#>  8 Africa Eastern and Southern ZH    AFE    2014 1.00e12
#>  9 Africa Eastern and Southern ZH    AFE    2013 9.83e11
#> 10 Africa Eastern and Southern ZH    AFE    2012 9.73e11
#> # i 16,482 more rows
```
  
#### ダウンロード例 1-3\

今度は、`extra = TRUE` として、読み込みましょう。先ほど、読み込んである、`wdi_cache` を使います。


```r
df_gdp3 <- WDI(country = "all", indicator = c(gdp = "NY.GDP.MKTP.CD"), 
               extra=TRUE, cache=wdi_cache)
df_gdp3
```


```
#> Rows: 16492 Columns: 13
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr  (7): country, iso2c, iso3c, region, capital, income...
#> dbl  (4): year, gdp, longitude, latitude
#> lgl  (1): status
#> date (1): lastupdated
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
#> # A tibble: 16,492 x 13
#>    country     iso2c iso3c  year      gdp status lastupdated
#>    <chr>       <chr> <chr> <dbl>    <dbl> <lgl>  <date>     
#>  1 Afghanistan AF    AFG    2021  1.48e10 NA     2022-12-22 
#>  2 Afghanistan AF    AFG    2020  2.01e10 NA     2022-12-22 
#>  3 Afghanistan AF    AFG    2019  1.89e10 NA     2022-12-22 
#>  4 Afghanistan AF    AFG    2018  1.84e10 NA     2022-12-22 
#>  5 Afghanistan AF    AFG    2017  1.89e10 NA     2022-12-22 
#>  6 Afghanistan AF    AFG    2016  1.80e10 NA     2022-12-22 
#>  7 Afghanistan AF    AFG    2015  2.00e10 NA     2022-12-22 
#>  8 Afghanistan AF    AFG    2014  2.06e10 NA     2022-12-22 
#>  9 Afghanistan AF    AFG    2013  2.06e10 NA     2022-12-22 
#> 10 Afghanistan AF    AFG    2012  2.02e10 NA     2022-12-22 
#> # i 16,482 more rows
#> # i 6 more variables: region <chr>, capital <chr>,
#> #   longitude <dbl>, latitude <dbl>, income <chr>,
#> #   lending <chr>
```
右上の三角印を使って、どのような詳細情報が付加されたか見て見ましょう。どんなことがわかりますか。

#### ダウンロード例 1-4

国名を指定します。`WDI` では、iso2c コードを使って、国名を指定します。上で見たように、Envoronment から、`wdi_cache` を選択すると、国名と、iso2c コード両方を見ることができました。iso2c や、iso3c は、よく使われるので、web 検索でも簡単にみつけることができます。最初に紹介した例ですから、どの国かはわかりますね、


```r
df_gdp4 <- WDI(country = c("CN","GB","JP","IN","US","DE"), 
               indicator = c(gdp = "NY.GDP.MKTP.CD"), extra=TRUE, cache=wdi_cache)
df_gdp4
```


```
#> Rows: 372 Columns: 13
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr  (7): country, iso2c, iso3c, region, capital, income...
#> dbl  (4): year, gdp, longitude, latitude
#> lgl  (1): status
#> date (1): lastupdated
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
#> # A tibble: 372 x 13
#>    country iso2c iso3c  year     gdp status lastupdated
#>    <chr>   <chr> <chr> <dbl>   <dbl> <lgl>  <date>     
#>  1 China   CN    CHN    2021 1.77e13 NA     2022-12-22 
#>  2 China   CN    CHN    2020 1.47e13 NA     2022-12-22 
#>  3 China   CN    CHN    2019 1.43e13 NA     2022-12-22 
#>  4 China   CN    CHN    2018 1.39e13 NA     2022-12-22 
#>  5 China   CN    CHN    2017 1.23e13 NA     2022-12-22 
#>  6 China   CN    CHN    2016 1.12e13 NA     2022-12-22 
#>  7 China   CN    CHN    2015 1.11e13 NA     2022-12-22 
#>  8 China   CN    CHN    2014 1.05e13 NA     2022-12-22 
#>  9 China   CN    CHN    2013 9.57e12 NA     2022-12-22 
#> 10 China   CN    CHN    2012 8.53e12 NA     2022-12-22 
#> # i 362 more rows
#> # i 6 more variables: region <chr>, capital <chr>,
#> #   longitude <dbl>, latitude <dbl>, income <chr>,
#> #   lending <chr>
```

#### ダウンロード例 2-1

二つの、指標コードを使って、同時に読み込むこともできます。そのときは、`c()` (combine) を使います。

* NY.GDP.DEFL.KD.ZG: Inflation, GDP deflator (annual %)
* CPTOTNSXN: CPI Price, nominal


```r
df_gdp21 <- WDI(country = "all", 
                indicator = c(gdp_deflator = "NY.GDP.DEFL.KD.ZG", 
                              cpi_price = "CPTOTNSXN"), 
                extra=TRUE, cache=wdi_cache)
df_gdp21
```


```
#> Rows: 23972 Columns: 14
#> -- Column specification ------------------------------------
#> Delimiter: ","
#> chr  (7): country, iso2c, iso3c, region, capital, income...
#> dbl  (5): year, gdp_deflator, cpi_price, longitude, lati...
#> lgl  (1): status
#> date (1): lastupdated
#> 
#> i Use `spec()` to retrieve the full column specification for this data.
#> i Specify the column types or set `show_col_types = FALSE` to quiet this message.
#> # A tibble: 23,972 x 14
#>    country iso2c iso3c  year status lastupdated gdp_deflator
#>    <chr>   <chr> <chr> <dbl> <lgl>  <date>             <dbl>
#>  1 Advanc~ AME   <NA>   1987 NA     2020-07-27            NA
#>  2 Advanc~ AME   <NA>   1988 NA     2020-07-27            NA
#>  3 Advanc~ AME   <NA>   1989 NA     2020-07-27            NA
#>  4 Advanc~ AME   <NA>   1990 NA     2020-07-27            NA
#>  5 Advanc~ AME   <NA>   1991 NA     2020-07-27            NA
#>  6 Advanc~ AME   <NA>   1992 NA     2020-07-27            NA
#>  7 Advanc~ AME   <NA>   1993 NA     2020-07-27            NA
#>  8 Advanc~ AME   <NA>   1994 NA     2020-07-27            NA
#>  9 Advanc~ AME   <NA>   1995 NA     2020-07-27            NA
#> 10 Advanc~ AME   <NA>   1996 NA     2020-07-27            NA
#> # i 23,962 more rows
#> # i 7 more variables: cpi_price <dbl>, region <chr>,
#> #   capital <chr>, longitude <dbl>, latitude <dbl>,
#> #   income <chr>, lending <chr>
```

NA (not available) つまり、データがないものが多いことがわかります。もう少し、データをよく見て見ましょう。



```r
str(df_gdp21)
#> spc_tbl_ [23,972 x 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>  $ country     : chr [1:23972] "Advanced Economies" "Advanced Economies" "Advanced Economies" "Advanced Economies" ...
#>  $ iso2c       : chr [1:23972] "AME" "AME" "AME" "AME" ...
#>  $ iso3c       : chr [1:23972] NA NA NA NA ...
#>  $ year        : num [1:23972] 1987 1988 1989 1990 1991 ...
#>  $ status      : logi [1:23972] NA NA NA NA NA NA ...
#>  $ lastupdated : Date[1:23972], format: "2020-07-27" ...
#>  $ gdp_deflator: num [1:23972] NA NA NA NA NA NA NA NA NA NA ...
#>  $ cpi_price   : num [1:23972] 58.7 60.5 63 66 69.1 ...
#>  $ region      : chr [1:23972] NA NA NA NA ...
#>  $ capital     : chr [1:23972] NA NA NA NA ...
#>  $ longitude   : num [1:23972] NA NA NA NA NA NA NA NA NA NA ...
#>  $ latitude    : num [1:23972] NA NA NA NA NA NA NA NA NA NA ...
#>  $ income      : chr [1:23972] NA NA NA NA ...
#>  $ lending     : chr [1:23972] NA NA NA NA ...
#>  - attr(*, "spec")=
#>   .. cols(
#>   ..   country = col_character(),
#>   ..   iso2c = col_character(),
#>   ..   iso3c = col_character(),
#>   ..   year = col_double(),
#>   ..   status = col_logical(),
#>   ..   lastupdated = col_date(format = ""),
#>   ..   gdp_deflator = col_double(),
#>   ..   cpi_price = col_double(),
#>   ..   region = col_character(),
#>   ..   capital = col_character(),
#>   ..   longitude = col_double(),
#>   ..   latitude = col_double(),
#>   ..   income = col_character(),
#>   ..   lending = col_character()
#>   .. )
#>  - attr(*, "problems")=<externalptr>
```


```r
summary(df_gdp21)
#>    country             iso2c              iso3c          
#>  Length:23972       Length:23972       Length:23972      
#>  Class :character   Class :character   Class :character  
#>  Mode  :character   Mode  :character   Mode  :character  
#>                                                          
#>                                                          
#>                                                          
#>                                                          
#>       year       status         lastupdated        
#>  Min.   :1960   Mode:logical   Min.   :2020-07-27  
#>  1st Qu.:1982   NA's:23972     1st Qu.:2020-07-27  
#>  Median :1996                  Median :2022-12-22  
#>  Mean   :1995                  Mean   :2022-03-23  
#>  3rd Qu.:2009                  3rd Qu.:2022-12-22  
#>  Max.   :2021                  Max.   :2022-12-22  
#>                                                    
#>   gdp_deflator         cpi_price         region         
#>  Min.   :  -98.704   Min.   :  0.00   Length:23972      
#>  1st Qu.:    2.317   1st Qu.: 55.95   Class :character  
#>  Median :    5.273   Median : 83.28   Mode  :character  
#>  Mean   :   25.308   Mean   : 84.18                     
#>  3rd Qu.:   10.411   3rd Qu.:108.75                     
#>  Max.   :26765.858   Max.   :551.25                     
#>  NA's   :11616       NA's   :18410                      
#>    capital            longitude          latitude      
#>  Length:23972       Min.   :-175.22   Min.   :-41.286  
#>  Class :character   1st Qu.: -15.18   1st Qu.:  4.174  
#>  Mode  :character   Median :  19.26   Median : 17.300  
#>                     Mean   :  19.14   Mean   : 18.889  
#>                     3rd Qu.:  50.53   3rd Qu.: 40.050  
#>                     Max.   : 179.09   Max.   : 64.184  
#>                     NA's   :10890     NA's   :10890    
#>     income            lending         
#>  Length:23972       Length:23972      
#>  Class :character   Class :character  
#>  Mode  :character   Mode  :character  
#>                                       
#>                                       
#>                                       
#> 
```

どんなことが分かりましたか。

右上の窓枠の、Environment でも `df_gdp21` を見てみましょう。

## 可視化 Visualization

グラフ（Chart）を描いて視覚化します。ここでは、年ごとの変化をみる、折れ線グラフだけを描いて見ます。

### グラフ 1

`x = year`, `y = gdp` の、`x=`, `y=` は省略してあります。`col=country` は、国ごとに、グループにして、色分けをします。`col` は、`color` としても `colour` としても、問題ありません。
`

```r
df_gdp4 %>% ggplot(aes(year, gdp, col=country)) + geom_line()
#> Warning: Removed 10 rows containing missing values
#> (`geom_line()`).
```

![](31-worldbank_files/figure-latex/unnamed-chunk-39-1.pdf)<!-- --> 

Warning として、missing values があると出ています。どこかは、分かりませんが、図を書くときですから、`y` に対応する、`gdp` の値がないものと思われます。

### グラフ 2

`drop_na(gdp)` で、`gdp` の値が、NA であるものを削除します。また、`labs` で、図にタイトルをつけます。


```r
df_gdp4 %>% drop_na(gdp) %>% 
  ggplot(aes(year, gdp, col=country)) + geom_line() +
  labs(title = "WDI - NY.GDP.MKTP.CD: gdp")
```

![](31-worldbank_files/figure-latex/unnamed-chunk-40-1.pdf)<!-- --> 

### テンプレート Templates

下に、テンプレートをつけます。コピーして、指標コードや、略称、国などを、それぞれ置き換えて、試して見てください。少し、複雑な変形をしていますが、少しずつ説明します。

#### 一つの国についての、一つの指標（WDI）と、その略称から、折線グラフを作成

Line Plot with one indicator with abbreviation and one country


```r
chosen_indicator <- "SL.UEM.TOTL.NE.ZS"
short_name <- "unemployment"
chosen_country <- "United States"
WDI(country = "all", indicator = c(short_name = chosen_indicator), extra=TRUE, cache=wdi_cache) %>%
  filter(country == chosen_country) %>% 
  ggplot(aes(year, short_name)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator, ": ", short_name, " - ", chosen_country),
       y = short_name)
```

#### 一つの国についての、一つの指標（WDI）から、折線グラフを作成

Line Plot with one indicator and one country


```r
chosen_indicator <- "SL.UEM.TOTL.NE.ZS"
chosen_country <- "United States"
WDI(country = "all", indicator = c(chosen_indicator = chosen_indicator), 
    extra=TRUE, cache=wdi_cache) %>%
  filter(country == chosen_country) %>% 
  ggplot(aes(year, chosen_indicator)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator, " - ", chosen_country), 
       y = chosen_indicator)
```

#### いくつかの国についての、一つの指標（WDI）と、その略称から、折線グラフを作成

Line Plot with one indicator with abbreviation and several countries


```r
chosen_indicator <- "SL.UEM.TOTL.NE.ZS"
short_name <- "unemployment"
chosen_countries <- c("United States","United Kingdom", "Japan")
WDI(country = "all", indicator = c(short_name = chosen_indicator), extra=TRUE, cache=wdi_cache) %>% drop_na(short_name) %>% 
  filter(country %in% chosen_countries) %>% 
  ggplot(aes(year, short_name, col = country)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator, ": ", short_name), y = short_name)
```


#### 一つの国についての、二つの指標（WDI）と、その略称から、折線グラフを作成

Line Plot with two indicators with abbreviation and one country


```r
chosen_indicator_1 <- "NY.GDP.DEFL.KD.ZG"
short_name_1 <- "gdp_deflator"
chosen_indicator_2 <- "CPTOTSAXNZGY"
short_name_2 <- "cpi_price"
chosen_country <- "United States"
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>% 
  filter(country == chosen_country) %>% 
  pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
  ggplot(aes(year, value, col = class)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2, " - ", chosen_country)) +
  scale_color_manual(labels = c(short_name_1, short_name_2), values = scales::hue_pal()(2))
```


```r
chosen_indicator_1 <- "SL.TLF.CACT.MA.NE.ZS"
short_name_1 <- "male"
chosen_indicator_2 <- "SL.TLF.CACT.FE.NE.ZS"
short_name_2 <- "female"
chosen_country <- "United States"
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>% 
  filter(country == chosen_country) %>% 
  pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
  ggplot(aes(year, value, col = class)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2, " - ", chosen_country)) +
  scale_color_manual(labels = c(short_name_1, short_name_2), values = scales::hue_pal()(2))
```

#### いくつかの国についての、二つの指標（WDI）と、その略称から、折線グラフを作成

Line Plot with two indicators with abbreviation and several countries


```r
chosen_indicator_1 <- "NY.GDP.DEFL.KD.ZG"
short_name_1 <- "gdp_deflator"
chosen_indicator_2 <- "CPTOTSAXNZGY"
short_name_2 <- "cpi_price"
chosen_countries <- c("United States", "France", "Japan")
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>% 
  filter(country %in% chosen_countries) %>% 
  pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
  ggplot(aes(year, value, linetype = class, col = country)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2)) +
  scale_linetype_manual(labels = c(short_name_1, short_name_2), values = c("solid", "dashed"))
```



```r
chosen_indicator_1 <- "SL.TLF.CACT.MA.NE.ZS"
short_name_1 <- "male"
chosen_indicator_2 <- "SL.TLF.CACT.FE.NE.ZS"
short_name_2 <- "female"
chosen_countries <- c("United States", "France", "Japan")
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>% 
  filter(country %in% chosen_countries) %>% 
  pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
  ggplot(aes(year, value, linetype = class, col = country)) + geom_line() +
  labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2)) +
  scale_linetype_manual(labels = c(short_name_1, short_name_2), values = c("solid", "dashed"))
```

## 課題　Assignment

上のテンプレートをコピーして、下に貼り付け、指標 `indicator` と、略称 `short_name` と、いくつかの国名 `chosen_countries` を、入れ替えて、試してみてください。


<!--chapter:end:31-worldbank.Rmd-->

# (PART) PART IV EDA {-}
# 探索的データ解析 {#intro2eda}



## 探索的データ解析 (EDA)とは

![image from r4ds](./data/data-science.png)

以下は、[Posit Primers: Visualise Data](https://posit.cloud/learn/primers/3.1) から

探索的データ解析 (EDA) は、データを理解するための反復的なサイクルです。EDAでは、以下のことを行います。

1. データに関する問いを作成する

2. データの可視化、変形・整形、モデリングによって、問いの答えを探索する。

3. 学んだことを使って、問いをより洗練されたものとする。

EDAは、あらゆるデータ分析において重要な役割を担います。EDA によって、課題解決のいとぐちを発見することもありますし、他の課題との関係性を発見する場合もあります。EDAを使用してデータの問題や品質を確認したり、データが信頼できるものであるかを見極める問いを作成できる場合もあります。


## 探索的データ解析 (EDA) の一例

WDI の一つの指標を使って、流れを見てみましょう。



### データの取得と読み込み - Data Import

NY.GDP.PCAP.CD: GDP per capita (current US$)


```r
df_wdi_gdppcap <- WDI(country = "all", indicator = c(gdp_pcap = "NY.GDP.PCAP.CD"))
write_csv(df_wdi_gdppcap, "./data/df_wdi_gdppcap.csv")
```




```r
df_wdi_gdppcap
#> # A tibble: 16,492 x 5
#>    country                     iso2c iso3c  year gdp_pcap
#>    <chr>                       <chr> <chr> <dbl>    <dbl>
#>  1 Africa Eastern and Southern ZH    AFE    2021    1550.
#>  2 Africa Eastern and Southern ZH    AFE    2020    1364.
#>  3 Africa Eastern and Southern ZH    AFE    2019    1512.
#>  4 Africa Eastern and Southern ZH    AFE    2018    1565.
#>  5 Africa Eastern and Southern ZH    AFE    2017    1629.
#>  6 Africa Eastern and Southern ZH    AFE    2016    1444.
#>  7 Africa Eastern and Southern ZH    AFE    2015    1539.
#>  8 Africa Eastern and Southern ZH    AFE    2014    1719.
#>  9 Africa Eastern and Southern ZH    AFE    2013    1730.
#> 10 Africa Eastern and Southern ZH    AFE    2012    1759.
#> # i 16,482 more rows
```

### データ変形・整形 - Data Transformation

#### 列を `select`

どの変数について分析するかを選ぶ。


```r
df_wdi_gdppcap_small <- df_wdi_gdppcap %>% 
  select(country, year, gdp_pcap)
df_wdi_gdppcap_small
#> # A tibble: 16,492 x 3
#>    country                      year gdp_pcap
#>    <chr>                       <dbl>    <dbl>
#>  1 Africa Eastern and Southern  2021    1550.
#>  2 Africa Eastern and Southern  2020    1364.
#>  3 Africa Eastern and Southern  2019    1512.
#>  4 Africa Eastern and Southern  2018    1565.
#>  5 Africa Eastern and Southern  2017    1629.
#>  6 Africa Eastern and Southern  2016    1444.
#>  7 Africa Eastern and Southern  2015    1539.
#>  8 Africa Eastern and Southern  2014    1719.
#>  9 Africa Eastern and Southern  2013    1730.
#> 10 Africa Eastern and Southern  2012    1759.
#> # i 16,482 more rows
```

#### 行を `filter`

いくつかの国に、フォーカスして調べる。


```r
df_wdi_gdppcap_short <- df_wdi_gdppcap %>% 
  filter(country %in% c("Japan", "Germany", "United States"))
df_wdi_gdppcap_short
#> # A tibble: 186 x 5
#>    country iso2c iso3c  year gdp_pcap
#>    <chr>   <chr> <chr> <dbl>    <dbl>
#>  1 Germany DE    DEU    2021   51204.
#>  2 Germany DE    DEU    2020   46773.
#>  3 Germany DE    DEU    2019   46794.
#>  4 Germany DE    DEU    2018   47939.
#>  5 Germany DE    DEU    2017   44653.
#>  6 Germany DE    DEU    2016   42136.
#>  7 Germany DE    DEU    2015   41103.
#>  8 Germany DE    DEU    2014   48024.
#>  9 Germany DE    DEU    2013   46299.
#> 10 Germany DE    DEU    2012   43856.
#> # i 176 more rows
```

列（変数）と、行（国）の選択を続けて、実行すると次のようになる。
一つ一つ変形したデータ（オブジェクト）に名前をつけて、保存する必要がないので、パイプ（`%>% `）の活用は有用である。


```r
df_wdi_gdppcap_small_short <- df_wdi_gdppcap %>% select(country, year, gdp_pcap) %>%
  filter(country %in% c("Japan", "Germany", "United States"))
df_wdi_gdppcap_small_short
#> # A tibble: 186 x 3
#>    country  year gdp_pcap
#>    <chr>   <dbl>    <dbl>
#>  1 Germany  2021   51204.
#>  2 Germany  2020   46773.
#>  3 Germany  2019   46794.
#>  4 Germany  2018   47939.
#>  5 Germany  2017   44653.
#>  6 Germany  2016   42136.
#>  7 Germany  2015   41103.
#>  8 Germany  2014   48024.
#>  9 Germany  2013   46299.
#> 10 Germany  2012   43856.
#> # i 176 more rows
```


### 可視化 Data Visualization

次は、よく生じる、誤りの例で、ノコギリの歯（sawtoothed）のようなギザギザ・グラフと呼ばれます。なぜこのようなことが起きているかわかりますか。


```r
df_wdi_gdppcap_small_short %>%
  ggplot(aes(x = year, y = gdp_pcap)) + geom_line()
#> Warning: Removed 1 row containing missing values
#> (`geom_line()`).
```

![](41-eda_files/figure-latex/unnamed-chunk-9-1.pdf)<!-- --> 

同じ年に、多くのデータがあるので、折れ線グラフを適切に書くことができませんでした。


```r
df_wdi_gdppcap_small_short %>% filter(country %in% c("Japan")) %>%
  ggplot(aes(x = year, y = gdp_pcap)) + geom_line()
```

![](41-eda_files/figure-latex/unnamed-chunk-10-1.pdf)<!-- --> 

一般的には、散布図をまず、書いてみるのも一つです。


```r
df_wdi_gdppcap_small_short %>%
  ggplot(aes(x = year, y = gdp_pcap)) + geom_point()
#> Warning: Removed 10 rows containing missing values
#> (`geom_point()`).
```

![](41-eda_files/figure-latex/unnamed-chunk-11-1.pdf)<!-- --> 

国別に、異なる色を使うことで、折れ線グラフを書くことも可能です。


```r
df_wdi_gdppcap_small_short %>% drop_na(gdp_pcap) %>%
  ggplot(aes(x = year, y = gdp_pcap, col = country)) + geom_line()
```

![](41-eda_files/figure-latex/unnamed-chunk-12-1.pdf)<!-- --> 

折線グラフと、散布図を同時に描くこともかのうです。


```r
df_wdi_gdppcap_small_short %>% drop_na(gdp_pcap) %>%
  ggplot(aes(x = year, y = gdp_pcap, col = country)) + geom_line() +
  geom_point()
```

![](41-eda_files/figure-latex/unnamed-chunk-13-1.pdf)<!-- --> 

点を、曲線で近似する方法はいくつも知られているが、ある幅で、近似していく、LOESS が初期値となっている。`method='loess'` を省略しても、同じ近似がなされる。`span` という値を調節することで、ことなる幅での近似曲線を書くことも可能である。初期値は、0.75。


```r
df_wdi_gdppcap_small_short %>% drop_na(gdp_pcap) %>%
  ggplot(aes(x = year, y = gdp_pcap)) + 
  geom_point(aes(color = country)) + 
  geom_smooth(method = 'loess', formula = 'y ~ x')
```

![](41-eda_files/figure-latex/unnamed-chunk-14-1.pdf)<!-- --> 

### データモデリング Data Modeling

上の例では、曲線ではなく、直線で近似することも考えられる。


```r
df_wdi_gdppcap_small_short %>% drop_na(gdp_pcap) %>%
  ggplot(aes(x = year, y = gdp_pcap)) + 
  geom_point(aes(color = country)) + 
  geom_smooth(method = 'lm', formula = 'y ~ x')
```

![](41-eda_files/figure-latex/unnamed-chunk-15-1.pdf)<!-- --> 

簡単な線形回帰モデルでの、回帰直線の y-切片や、傾きは、次のコードで与えられ、p-value や、R squared の値も求められる。

この例では、年とともに、増加の傾向があること。そして、線形モデルが$$、90% 程度説明していると表現される。すなわち、


は、良い、近似であることがわかる。


```r
df_wdi_gdppcap_small_short %>% lm(gdp_pcap ~ year, .) %>% summary()
#> 
#> Call:
#> lm(formula = gdp_pcap ~ year, data = .)
#> 
#> Residuals:
#>      Min       1Q   Median       3Q      Max 
#> -14156.8  -3200.5   -507.4   3237.7  16779.2 
#> 
#> Coefficients:
#>               Estimate Std. Error t value Pr(>|t|)    
#> (Intercept) -1903497.5    48007.9  -39.65   <2e-16 ***
#> year             968.3       24.1   40.18   <2e-16 ***
#> ---
#> Signif. codes:  
#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 5514 on 174 degrees of freedom
#>   (10 observations deleted due to missingness)
#> Multiple R-squared:  0.9027,	Adjusted R-squared:  0.9021 
#> F-statistic:  1614 on 1 and 174 DF,  p-value: < 2.2e-16
```


<!--chapter:end:41-eda.Rmd-->

# (PART) PART V EXAMPLES {-}
# Example 1 {#example1}




<!--chapter:end:51-examples.Rmd-->

# (APPENDIX) APPENDIX {-}
# 日本語の扱いについて {#japanese}



## 日本語・中国語・韓国語

文字化けが、起こることが多く、対応が、一定せず、特に、図の表示において、Windows や、macOS や、Linux などの、OS ごとに、フォントが違ったり、それを、図のタイトルなどに、使ったりが、難しかったのですが、どうやら、現在は、どの場合も、次の設定で、解決しているようです。下の例を確認してください。特に、フォントについては、好みも関係しますから、難しいですが、ここでは、どのプラットフォーム（OS）でも、共通に扱えることを中心に書きます。


```r
# showtext を、インストールしていない場合は、一回だけ、右上の三角をクリックして実行
install.packages('showtext')
```

### パッケージをロード

`library` によって、Package をロード（いつでも使えるように）します。


```r
library(tidyverse)
library(showtext) 
showtext_auto()
```

## Base R でタイトルに日本語


```r
plot(cars, main="散布図")
```

![](81-japanese_files/figure-latex/unnamed-chunk-3-1.pdf)<!-- --> 


## 列名や、データに日本語



```r
df_iris <- iris
colnames(df_iris) <- c("萼長","萼幅","葉長","葉幅","Species" )
tab <- data.frame(Species = c("setosa", "versicolor", "virginica"), 
                  "種別" = c("ヒオウギアヤメ", "ブルーフラッグ", "バージニカ"))
df_iris <- df_iris %>% left_join(tab, by=c("Species" = "Species")) %>% select(-5)
df_iris %>% slice(1:2)
#>   萼長 萼幅 葉長 葉幅           種別
#> 1  5.1  3.5  1.4  0.2 ヒオウギアヤメ
#> 2  4.9  3.0  1.4  0.2 ヒオウギアヤメ
```

## `kable` で表示


```r
knitr::kable(df_iris[1:6, ])
```


\begin{tabular}{r|r|r|r|l}
\hline
萼長 & 萼幅 & 葉長 & 葉幅 & 種別\\
\hline
5.1 & 3.5 & 1.4 & 0.2 & ヒオウギアヤメ\\
\hline
4.9 & 3.0 & 1.4 & 0.2 & ヒオウギアヤメ\\
\hline
4.7 & 3.2 & 1.3 & 0.2 & ヒオウギアヤメ\\
\hline
4.6 & 3.1 & 1.5 & 0.2 & ヒオウギアヤメ\\
\hline
5.0 & 3.6 & 1.4 & 0.2 & ヒオウギアヤメ\\
\hline
5.4 & 3.9 & 1.7 & 0.4 & ヒオウギアヤメ\\
\hline
\end{tabular}




## `ggplot` でグラフを作成


```r
ggplot(df_iris, aes(x = `葉長`, y = `葉幅`, col = `種別`)) +
  geom_point() + labs(title = "散布図", x = "葉長", y = "葉幅")
```

![](81-japanese_files/figure-latex/unnamed-chunk-5-1.pdf)<!-- --> 


## 備考：

実は、一番難しいのが、PDF の作成だと思いますが、一応、上のものも、PDF を作成することが可能です。
下のリンクのファイルを、いろいろな、形式で、出力してみてください。R Notebook と、PDF に出力したもののリンクを付けておきます。

* [R Notebook](https://ds-sl.github.io/intro2r/Rmarkdown-J.nb.html)
  - 右上の Code ボタンから、Rmd ファイルも取得できます。
* [R Notebook RMD](https://ds-sl.github.io/intro2r/Rmarkdown-J.html)
  - Rmd の中身がテキストで表示されますから、コピーして、新規作成した、RNotebook ファイルに貼り付けることも可能です。
* [PDF](https://ds-sl.github.io/intro2r/Rmarkdown-J.pdf)
  - 通常のPDFも、やはり PDF 形式の、beamer presentation も作成できます。

詳細は、これらのファイルに記載されていますから、参考にしてください。

## 参考：日本語の表示について

> 日本語が適切に表示されない！？

簡単ではなく、未解決の部分が何かなどを含め、わたしも十分理解できているか不明であるが、理解できていると思われる範囲で、備忘録のように記します。

R を使うという場合に限っても、R Studio IDE を使う場合、RStudio Cloud を使う場合、Google colab を使う場合、他のプラットフォームで使う場合で違ってくると思われますが、上にあげた、三種類のプラットフォームで確かめられるものについて書いていく。上に書いた以外に、R Studio IDE を、Windows 上で使う場合と、Mac 上で使う場合（Mac のシステムは Unix 系であるが、さまざまな Linux ）でも、状況が異なるかもしれません。そこで、場合分けをして書いていくほうが安全ですが、それは、極力避け、どれにでも適用可能な方法を模索しながら書いていこうと思います。個人的に、日常的に分断を避ける努力をすることが大切だと思っていることも背景にある。さらに、ソフトウェア開発者は、むろん、そのような差異を理解して、どの環境でも、可能なように設計することを心がけていると思われますし、そのようなものが、R Project の正規のパッケージとして採用されていくべきだとも考えていますので、多少、理想も入っているが、これを基本として書いていこうと思います。十分なチェックができていないものもあるので、不具合などは、ぜひ、お知らせ願いたい。この文章も少しずつ、改善していければと思う。

通常、日本語、中国語、韓国語などが適切に表示できない場合は、文字のエンコーディング（Encoding: どのような情報として記録されているか）と、フォントの問題、さらに、システムがこれらをどう処理しているかの問題があると思われます。しかし、R の利用者として考えると、文字化けが起きたり、適切に文字が表示されないのは、以下の三つに分けられるようです。

1. データファイルなどを読み込んだときに適切に表示されない
2. 図の中のタイトルなどが、適切に表示されない
3. R Markdown の出力において、適切に表示されない


### データファイルの読み込み


- tidyverse に含まれる readr には、guess_encoding が含まれており、一般的には、たとえば、
	- read_csv("./data/file_name.csv")  とすると、一番可能性の高いエンコーディングで読み込まれるようになっています。
- 使い方：guess_encoding(file, n_max = 10000, threshold = 0.2) とあり、10000行で推測されたエンコーディング、または、確率を計算することを 初期設定値（Default）にしてます。Help によると、すべての行をチェックする場合は、n_max =  -1 とすることが書かれています。
- これで問題がない場合が多いです。他の、readr 関数も同様です。しかし、これは、あくまでも、CSV などのテキストファイルについてです。
- なお、read_csv などにも、guess_max = min(1000, n_max) もありますが、これは、column type を決めるためのものである。
- read.csv() など、base R では、fileEncoding = "", encoding = "unknown" がオプションに含まれていたので、指定して読み込むことが通常でした。


### 図の中のテキスト

- 基本的には、日本語を表示できるフォントがインストールされていて、図の表示の前にlibrary(showtext); showtext_auto() となっていれば、これ以降の図は、問題なく、表示されるはずです。
- 通常使っている、コンピュータ以外で、使うときに、フォントが入っていない場合などは、`tinytex` の命令を使って、`tinytex::tlmgr_install("ipaex")` とすれば、PDF を作成するときも、IPA フォント（International Phonetic Alphabet）を使えます。
- 二種類以上のフォントを使い分けたいときは、名前をつけて、それを family = name で指定する。
	- showtext: Using Fonts More Easily in R Graphs 参照。

### R Markdown の出力

- PDF 作成には、\TeX システムを使っているので、日本語を扱えるように、tex-engine や、document class や、mainfont を設定する必要があるが、R Markdown ファイルの YAML に、以下を加えれば問題がないようである。
```
header-includes:
  - \usepackage{xeCJK}
  - \setCJKmainfont{ipaexm.ttf}
  - \setCJKsansfont{ipaexg.ttf}
  - \setCJKmonofont{ipaexg.ttf}
```
### `bookdown`

`bookdown` を使って、電子書籍を出版する場合には、[`bookdown` （リンク）](https://bookdown.org/yihui/bookdown/) を参照してください。

日本語におけるテンプレートは、[こちら](https://github.com/icu-hsuzuki/bs4_book_template) にあります。まずは、ページの下にある、README を読んでください。

### 参考としたもの

#### showtext: Using Fonts More Easily in R Graphs

- https://CRAN.R-project.org/package=showtext
	- https://cran.r-project.org/web/packages/showtext/readme/README.html
	- showtext: Using Fonts More Easily in R Graphs: 
		- https://cran.r-project.org/web/packages/showtext/vignettes/introduction.html
		- https://fonts.google.com

#### sysfonts: Loading Fonts into R

- https://CRAN.R-project.org/package=sysfonts
	- https://cran.r-project.org/web/packages/sysfonts/sysfonts.pdf


#### foods4all: Examples of Graphs

- https://foods4all.github.io/examples/examples_of_graphs.html
	- 77.2 Japanese Environments 日本語環境（昔の記事：Last Updated: 2020-04-22）

<!--chapter:end:81-japanese.Rmd-->

# IT ツール {#tools}

> いくつかの便利なツールについて紹介します。

## Git と GitHub

Git は バージョン管理システムで、GitHub はそれを、活用し、かつ他のメンバーと協力して開発など、さまざまな活動をするためのサイトです。公開が基本となっています。非公開にすることも可能ですが、公開することで、世界中のひとたちと協力していくことが可能になりますので、その利点も学んでいただければと思います。

### 概要

RStudio で R を使っている場合、Git-GitHub-RStudio の連携で使うことをお勧めします。しかし、これらは、三つとも、まったく異なるものですから、簡単な概要を書いておくことにします。

#### Git

これは、ファイルのバージョン（更新履歴）の管理システムで、単独で機能します。他の、プログラムなどに関係しない、他の文書ファイルであっても、バージョンを管理する場合に活用できます。特に、テキスト・ファイルの場合には、どこがどう改訂されているかを確認することもできます。また、基本的には、Unix の Shell プログラムで動作させるのが一般的です。Mac は、Unix システムの上に構築されているため、最初から、ユーティリティ（Utility）> ターミナル（Terminal）で、Shell コマンドが利用可能になっていますが、Windows の場合には、bash と呼ばれる Shell プログラムをインストールすることをお勧めします。Windows システムについてよくご存知の方は、他の方法を使っていただいて構いませんが、Git のインストールの時に、Git bash を選択して、簡単に インストールできますし、Unix システムの基本を理解するチャンスでもあり、Mac とも同じ環境で説明できますから、ここでは、そちらを使います。Shell コマンドは、R Studio の中のターミナルを使って、利用することも可能です。（注：Windows のコマンド・プロンプト、または、パワー・シェルをお使いの方は、利用環境が変化する可能性がありますから、そのまま使われる方が良いかもしれません。）

基本的なコマンドとしては、以下のものがあります。いまは、このようなものがある程度に、眺めておいてください。

* `git init`: 特定のディレクトリ（フォルダ）で バージョン管理を始める時に使います。
* `git status`: 現在の状況を確認するときに使います。
* `git diff file_name`: ファイルへの変更を確認します。
* `git log`: 過去の commit による履歴を確認する時に使います。
* `git add file_name`: ステージングという中間的な場所に登録します。
* `git commit -m "log message here"`: ステージングにあるものを、確定させます。引用符で囲まれた短いコメントを加えます。50文字が上限です。
* `git help`: Help のリストが表示されます。
  - 例：`git help init` などと入力すると、説明を見ることができます。

#### Git Hub

Git でバージョン管理されているディレクトリ（フォルダ）の状態を示す、クラウドサービスです。更新されている、状態を確認するとともに、変更履歴なども確認できます。また、Git Hub サービスを利用して、ファイルを公開、共有することも可能です。Pages サイトを利用することで、ホームページとして HTML ファイルなどを公開することもできるため、レポートを公開したり、この電子書籍のように、`bookdown` パッケージを利用して作成したものを、インターネット上に公開することも可能です。

お気付きかと思いますが、この電子書籍も、リンクされている、他の文書も、URL（アドレス）をみると、GitHub になっていますし、パッケージや、データなども、GitHub へのリンクが示されている割合が、非常に高いと思います。

最初に、Git で管理されている、ディレクトリ（フォルダ）（これを、ローカル・リポジトリと言います）と、GitHub 内のリポジトリ（リモート・リポジトリまはたアップストリーム・リポジトリと言います。ここでは、リモート・リポジトリと呼ぶことにします）を結びつけるステップが必要です。

#### RStudio 連携

コマンドライン（シェル）で行う作業や、ローカル・リポジトリを、リモート・リポジトリに結びつける作業を、RStudio の中で行うことが可能です。

### はじめかた

1. Git のインストール
  - Windows と Mac で異なりますので注意が必要です。Mac については、**Mac** と書いてあるところを読んでください。
  - **Windows** の場合は、[git-scm](https://git-scm.com/download/win) にアクセスしてダウンロード、インストールしてください。セットアップ（Setup）で、２箇所、注意点があります、それ以外は、すべて、初期設定のままで変更は必要ありません。
    - Choosing the default editor used by Git: 設定で、エディタ（Editor）を設定しますが、vi, vim に慣れていない方は、nano を選択することをお勧めします。（nano^[GNU nanoは、コンソールウィンドウで動作する小型でフレンドリーなテキストエディタです。(GNU nano is a small and friendly text editor running in the console window.)] は、メニューが下に出るので、それを見て操作することが可能なエディターです。）
    - Adjusting Your Path Environment: Windows の コマンドライン・ツール（command line prompt) を使っていない方は、Git Bash のインストールを選択してください。さらに、Git and optional Unix tools from the Windows Command Prompt を選択することをお勧めしますが、上で書いたように、Windows の コマンド・プロンプトになれておられる方で、それを使い続けたいかたは、Use Git from Git Bash only を選択されるのが良いかもしれません。
    - 最後に、RStudio の設定（Tools > Global Option）で、Terminal　から、Git Bash を選択^[自動的に選択されているかもしれません]し、Tools から、New Terminal を選択^[すでにタブがあればこの作業は不要です]します。
  - **Mac** は、最初から、Install されていると思います。ユーティリティ（Utility）> ターミナル（Terminal）を開いて^[RStudio を既にお使いの方は、左下の窓枠から、Terminal タブを選択できますので、それを使うことも可能です。]、`git --version` とすると、インストールされているバージョンが表示されると思います。バージョンがでない場合には、Install するかと聞かれます。このときに、Git だけをインストールすることも、Xcode という開発環境を同時にインストールすることも可能です。（インストールするように指示が出なければ、App Store からも、インストールできます。もし、そのあとで、git などのコマンドで xcrun: error などとエラーが出たら、`xcode-select --install` としてください。）インストールが終了したら、もう一度、`git --version` と Terminal に入力して、結果を確認してください。

2. GitHub のアカウント取得
  - [GitHub サイト](https://github.com) に、アカウントを作成します。アカウント名は、短く、分かりやすく、覚えやすいものをよく考えて決めてください。Email Address だけで、無償で作成できます。

3. RStudio の 左下の窓枠のTerminal タブ^[Terminal がない場合は、Tools > Terminal > New Terminal とすると表示されます。]から、GitHub アカウントに連携する設定を行います。
下の２行を、１行ずつ、コピーして、Terminal に入力してください。
```
git config --global user.name "Your Name" # GitHub の User Name
git config --global user.email "your@email.com" # GitHub に登録したメールアドレス
```

4. RStudio の、Tools > Global Opton の、Git/SVN タブを開き、Git Executable とあるところに、Git 実行プログラムのある場所を入れます。
  - **Windows** の場合は、`C:/Program Files/Git/bin/git.exe` だと思いますが、Browse ボタンから確認してください。
  - **Mac** の場合は、`/usr/bin/git` になるかと思いますが、Browse ボタンから確認してください。

5. その下に、Create RSA key とありますから、それを押し、Create ボタンを押しててください^[Passphrase (optional) と出ますが、無視してくださって構いません。]。すると、View RSA key から、暗号キーも確認できます。（この作業は、Terminal から、`ssh-keygen -t rsa` として作成することも可能です。この作業で、`~/.ssh/` 内に、SSH キーが記述されたファイルが作成されます。）

6. GitHub アカウントで公開鍵を利用できるようにします。まず、RStudio の方で作成した、RSA key （Tools の、Global Option の Git/SVN）の下にある view を押すと見ることができ、上に、書いてあるように、そこに出てきたものを、コピーします。次に、GitHubにログインし、右上のアイコンの右の三角から、設定（Setting）を選択し、SSH公開鍵（SSH and GPG Keys）を選択します。新しい公開鍵を追加（New SSH Key）を選択すると、SSH  キーを貼り付けることができます。（リポジトリの左上にある、アカウント名をクリックし現れるダッシュボードの左上の大きなアイコンをクリックしても「アカウント設定」が現れ、SSH and GPG Keysを見つけることができると思います。）

（なお、RStudio ではなく、Terminal からコピーするときは、Unix では、`pbcopy < ~/.ssh/id_rsa.pub` などとします。Windows の場合は、`pbcopy` が使えない可能性があるので、そのときは、Terminal から、Git Bash を使い、`use < ~/.ssh/id_rsa.pub` とします。Terminal に慣れておられない方には、上に紹介した、RStudio からコピーする方が簡便かと思います。）

7. これで設定終了ですので、R Studio を再起動させてください。


### GitHub にあるリモート・リポジトリ（Remote Repo）から始める場合

1. GitHub にログインして、既存のリポジトリを開きます。
2. Code の、Clone から、リンク先のアドレスを入手。https と SSH を選べますが、SSH を選び、コピーします。
3. RStudio から、New Project とし、Version Control を選択し、ディレクトリーを決めたら、上でコピーした、ものを、貼り付けて、Project を作成します。

この手続きで、リモート・リポジトリのファイルがすべて、RStudio のプロジェクトに入ります。

実はこの手続きで、公開されている、他のリポジトリも取り込むことができます。ただし、編集して、改訂していくには、自分のリポジトリに、繋ぐことになります。そのときは、次の項目を見てください。

### 自分のコンピュータのリポジトリ（Local Repo）から始める場合

1. RStudio から新しい、プロジェクト（Project） を作成 `test0` としておきましょう。
2. GitHub に、新しい、レポジトリを作成して繋げる
  - 自分の GitHub アカウントに、新しい、レポジトリをプロジェクトと同じ名前 `test0` で作成します。同じ名前でなくてもかまわないのですが、関連がしやすいので、同じ名前がお勧めです。
  - Quick Setup というページが表示されますから、その、下の Set up in Desktop or  の右から、https と SSH を選べますが、SSH を選び、コピーします。
  - プロジェクトの中の 左下の窓枠の、Terminal から次を実行します。
```
echo "# Project test0" >> README.md # REAME の表題を書きます。
git init
git add README.md
git commit -m "First commit. README.md"
git branch -M main
git remote add origin `git@github.com:icu-hsuzuki/test0.git`
# わたしのアカウントの場合には、コピーしたものを貼り付けると、上のようになります。
git push -u origin main
```

再起動すると、プロジェクトの右上の窓枠に、Git と表示されていると思います。開いて、いくつかファイル名があれば、これを選択し、Commit ボタンを押し、短い message を書いて、Commit とし、そのあとで、Push ボタンを押してください。 `HEAD -> main` と表示されれば、OK です。

### GitHub Pages について

GitHub は、Web 上のサービスですが、たとえ、リポジトリーの中に、HTML ファイルなどが存在しても、ブラウザーで表示させることはできません。公開する方法として、わたしは、以下のようにしています。

公開しブラウザーで読めるようにしたいファイルを、`docs` という ディレクトリに入れます。Setting を選択し、左の帯から、Pages を選び、Branch を、`main`、`/docs` として、Save します。すると、docs に入っているファイルは、リンクを指定すれば、ブラウザーで、見ることができます。

リンクは、まず、リポジトリーの右上の、About の右のギアマークから、Use your GitHub Pages website に、チェックを入れると、URL が表示されますから、その URL に続けて、ファイル名を加えたものが、そのファイルの、リンクとなります。

### Bookdown パッケージによる、電子書籍の執筆

[bookdown](https://github.com/rstudio/bookdown) を利用して、始める方法を簡単に記します。

Git-GitHub-RStuio の設定は済んでいると仮定して書きます。また、Bookdown を利用するには、`bookdown` パッケージのインストールが必要です。RStudio の Tools から、Install Packages を選択して、インストールしてください。また、`bs4_book` スタイルを利用する場合は、RStudio などのバージョンによっては、`bslib` と `downlit` も、インストールする必要があるようです。

以下では、R Studio で新しい、プロジェクトとして始める場合と、テンプレート・リポジトリ を使う方法を説明します。

#### RStudio での設定

1. 新しい book プロジェクトを始めます、標準設定の `book` と、`bs4_book` を選択できます。このディレクトリ（フォルダ。ローカル・リポジトリと呼びます）の名前をリモート・リポジトリの名前と同じにして、作成します^[異なる名前でも可能ですが、特別な理由がない限り同じにしておいた方が良いでしょう]。
2. Files の、Rename 機能を使って `_book` ディレクトリ（フォルダ）の名前を、`docs` に変更します。
3. `_bookdown.yml` を編集し次の行を加えます（私は２行目に入れています）。  
`output_dir: docs`  
GitHub Pages の機能を使って、公開するための変更です。
4. **\@GitHub:** 新いリポジトリー（リモート・リポジトリと言います）を作成します。ローカル・リポジトリと同じ名前にし、簡単な説明を加えます。
5. 左下の窓枠から、Terminal タブを選択します。 以下は例です。`git remote add origin` のところは、適当に変更してください。
```
echo "# ds-book" >> README.md
git init
git add README.md
git commit -m "first commit"
git branch -M main
git remote add origin git@github.com:icu-hsuzuki/ds4aj.git # 変更
git push -u origin main
```
5. RStudio を一旦終了し、もう一度、そのプロジェクトを立ち上げると、右上の窓枠に、Git タブが表示されるはずです。
6. Build から、Build Book ボタンを利用すれば、作成されます。
7. Git タブから: Commit "first build" とし、 Push をします。
8. **\@GitHub:** Settings から、Pages > main > docs と変更すると、公開されます。
9. Code に戻り、About の右のギアマークから、



##### 他の PC での作業

1. Login to GitHub account
2. Copy SSH address under Code>Clone
3. Create a new project using Version Control:Git with the SSH address by setting the directory name
4. Edit README.md and test Git Commit and Push

#### テンプレートを利用する方法

##### bookdown-demo

[`bookdown` の電子書籍（bookdown: Authoring Books and Technical Documents with R Markdown）](https://bookdown.org/yihui/bookdown/) の、はじめてみよう（Get started）から、GitHub リポジトリー [rstudio/bookdown-demo](https://github.com/rstudio/bookdown-demo) にリンクがついています。

1. 自分の、GitHub アカウントに、ログインします。
2. [rstudio/bookdown-demo](https://github.com/rstudio/bookdown-demo) にアクセスし、Use this template から、create a new repository を選択します。
3. 自分のアカウントの中に、コピーされたリポジトリーがつくられます。
4. 上で説明した「GitHub にあるリモート・リポジトリ（Remote Repo）から始める場合」を利用してください。

よくできているテンプレートです。しかし、このままでは、公開されません。[bookdown: Authoring Books and Technical Documents with R Markdown](https://bookdown.org/yihui/bookdown/) には、いくつかの公開方法が書かれていますから、参照してください。

##### `jtr13/bookdown-template`

YouTube ビデオ [5分間で、bookdown の本を作成する方法（How to create a bookdown book in 5 minutes）](https://www.youtube.com/watch?v=m5D-yoH416Y) で紹介されているものです。

1. 自分の、GitHub アカウントに、ログインします。
2. [jtr13/bookdown-template](https://github.com/jtr13/bookdown-template) にアクセスし、Use this template から、create a new repository を選択します。
3. 自分のアカウントの中に、コピーされたリポジトリーがつくられます。
4. 上で説明した「GitHub にあるリモート・リポジトリ（Remote Repo）から始める場合」を利用してください。

ビデオの中では、簡単に、GitHub Pages（GitHub のホームページサービス）に、公開する方法が説明されています。最も、大切な部分は、テンプレートがコピーされた、自分のリポジトリの Settings から、Pages を選び、Branch を main > docs とする部分です。このようにすることで、公開されます。上の、「GitHub Pages」で説明していることと同じです。

##### 日本語テンプレート

`bs4_book` スタイルでの、簡単な、日本語テンプレートを作成しました。

1. 自分の、GitHub アカウントに、ログインします。
2. [icu-hsuzuki/bs4_book_template](https://github.com/icu-hsuzuki/bs4_book_template) にアクセスし、Use this template から、create a new repository を選択します。
3. 自分のアカウントの中に、コピーされたリポジトリーがつくられます。
4. 上で説明した「GitHub にあるリモート・リポジトリ（Remote Repo）から始める場合」を利用してください。

まだ、不十分ですが、少しずつ、改訂していきます。
使い方は、リポジトリの README に、注意点などは、最後の章 Bookdown に書いておく予定です。

### 大きなファイルに関すること

100M 未満のファイルだけを利用するのがよいですが、それより大きいものを、GitHub に挙げようとして、問題が起こることがあります。その対処法を書いておきます。

個人的には、大きなデータや、本などを、Build して、100M 以上の、非常に大きな、TeX 関連のファイルができることがありました。

備忘録も含めて、書いておきます。

#### 大きなファイルの取り除きかた

下のサイトからの引用です。非常に分かりやすく書かれています。Terminal で作業を行いますが、いま、Add した場合と、いくつか、前のステップで、Add した場合で、対応の方法が異なります。

- [Tutorial: Removing Large Files from Git](https://medium.com/analytics-vidhya/tutorial-removing-large-files-from-git-78dbf4cf83a) 
	- Scenario 1: The Large File Was Just Added in the Most Recent Commit
		- git rm --cached big_file_name
		- git commit --amend -C HEAD
	- Scenario 2: The Large File Was Committed Prior to The Most Recent Commit
		- Locating the Last “Good” Commit: git log --oneline
		- Initiate a Rebase Between the Last “Good” Commit and the Current Commit: git rebase -i 8464da4
		- This will open up a file in your Git editor (in my case, Vim), that looks something like this:
			- pick -> edit
		- git rm --cached csv_building_damage_assessment.csv
		- git commit --amend -C HEAD
		
### 複数のコンピュータから利用する方法

わたしも、いくつかのコンピュータから、同じGitHub アカウントにアクセスして作業しています。

同じSSHキーを、複数のコンピュータで利用することも可能です。特に、コンピュータの更新時に、移行する場合は、元の環境をそのまま使うことも可能で便利です。

ただし、基本的には、それぞれのコンピュータで別々のSSHキーを使用するのがお勧めです。問題が発生した時に、個別のコンピュータの課題として解決することができます。

（たとえば、RSA 形式で作成した）複数の SSH キーを使用するときは、GitHub アカウントに公開鍵を追加する必要があります。

GitHub アカウントに別の公開鍵を追加するには、GitHubにログインし、右上のアイコンの右の三角から、設定（Setting）を選択し、SSH公開鍵（SSH and GPG Keys）を選択します。新しい公開鍵を追加（New SSH Key）を選択すると、SSH  キーを貼り付けることができます。（リポジトリの左上にある、アカウント名をクリックし現れるダッシュボードの左上の大きなアイコンをクリックしても「アカウント設定」が現れ、SSH and GPG Keysを見つけることができると思います。）

コピーを貼り付ける時には、RStudio の、Global Option の、Git/SVN タブから、View public key を見ると、コピーできるようになっています。

Terminal からコピーするときは、Unix では、`pbcopy < ~/.ssh/id_rsa.pub` などとします。Windows の場合は、`pbcopy` が使えない可能性があるので、そのときは、Terminal から、Git Bash を使い、`use < ~/.ssh/id_rsa.pub` とします。Terminal に慣れておられない方には、上に紹介した、RStudio からコピーする方が簡便かと思います。

SSH キーの最後には、コンピュータ名とコンピュータのアカウント名などが入っていると思います。

この設定をすれば、どちらのマシンからでもSSH経由でGithubリポジトリにアクセスできるようになります。


### 複数のアカウントを一つのコンピュータから利用する方法

わたしも複数のGitHub アカウントを利用しています。

- ~/.ssh 内に 複数（例では三つ）、ssh-keygen -t rsa  でファイル作成
	- id_rsa , id_sub1_rsa, id_sub2_rsa
- 上の複数のコンピュータから利用する時に説明してあるように、SSH キーを GitHub に登録
- ~/.ssh 内の config ファイル（~/.ssh/config）を編集　(nano などを利用)
- ~/.gitconfig, ~/.gitconfig_sub1, ~/.gitconfig_sub2 を作成

詳しくは、参考にしたサイトを参照してください。

### 共同作業をする場合

以下では、ひとり管理者（とりまとめ役）がいて、その人がまずは、レポジトリーを作成し、何人かの編集者で、共同編集することを想定して、書きます。内容は本でなくても、プログラムでも、ノートでも構いませんが、イメージしやすくするため、本を編集することを想定して書いていきます。

1. 編集に関わる全員が、それぞれ、個人の、GitHub アカウントを作成します。

2. リポジトリを フォーク（Fork）： 共同編集する（本の）レポジトリ（オリジナル・レポジトリと呼ぶことにします^[upstream repository と呼ぶこともありますが、自分のリモート・リポジトリを upstream  repository と呼ぶこともあるので、ここでは、オリジナル・リポジトリと呼ぶことにします。]）にいき、フォークします。フォークすることで、編集者のリポジトリに、コピーが作成され、大元のリポジトリ（オリジナル・レポジトリ）の変更を依頼することができます。名前をつけますが、元のものと同じでも、フォークしたことがわかるようにしておいても良いでしょう。

  - 一回フォーク（Fork）したら、２度目以降は、オリジナル・レポジトリから、フォーク（Fork）する必要はありません。ただし、改訂されているかもしれないので、更新（Sync fork）する必要はあります。GitHub 上の、フォーク（Fork） した、自分のレポジトリを見ると、更新されている場合は、オリジナル・レポジトリーに、Sync することができますから、Sync し^[Synk fork ボタンを押すと This branch is out-of-date などと表示され、Update branch を選択すると、update されます]、最新の状態にしておきます。よくみると、オリジナル・レポジトリーとの関係が読み取れるかと思います。

3. （フォークした）リポジトリをクローン: 編集者のコンピュータにフォークして得られたリポジトリを、クローンし、自分のコンピュータ内に、ローカル・リポジトリを作成ます。

4. RStudio の右上の、Git タブの右にある、New Branch に、新しい、Branch（編集用枝）を作成します。すると、その右に、Branch 名が記載されます。それが、現在の Branch 名です。その右の三角を押すと、main など、すべての Branch が見えるはずです。編集のための Branch が表示されている（アクティブ）になっていることを確認します^[New Branch の右に、現在どのBranch がアクティブになっているかが表示されています。そこに現れている Branch に、commit などで、編集を加えていくことになります。]。

5. 編集: 編集者のコンピュータ（RStudio 上）で編集を行います。

6. 編集結果をコミット : 編集者のコンピュータで編集した後に、簡単な説明を書いて、コミットします。

7. 編集結果をプッシュ : フォークした GitHub の自分のリポジトリに、プッシュします。

  - 実際にどうなるかをみるために、Build をする場合もあるかもしれませんが、すると、たくさんのファイルが書き換えられます。管理者も、一つ一つ丁寧に見るのは大変ですから、実際に、書き換えた、Rmd ファイルなどだけに、チェックを入れて、Commit + Push するのも良いでしょう。
  - この時点で、RStudio 上の、Branch を main に戻しておくと良いでしょう^[New Branch の右のところで、選択します]。

8. プル依頼を作成 : フォークした自分の（リモート）リポジトリで、編集の内容を簡単に記述して、プルリクエスト（Pull Request）をします。

  - 編集して、プッシュした、Branch を選択し、オリジナル・レポジトリーと異なった状態であることを確認します。
  - Pull Request を選択します。
  - オリジナル・レポジトリーの管理者は、修正をしやすいように、修正の要点を書いておきます。
  - ここまでで終了です。管理者にメールが届きます。
  - このあと、編集者が何をするか、確認してください。

9. **管理者**：編集結果の確認 : オリジナル・リポジトリの所有者は、編集結果を確認し、承認する場合は、main に、統合（マージ）します。

  - 統合（マージ）すると、Pull Request をした編集者に、メールが届きます。

10. 変更の同期: 編集者は、承認された、オリジナル・リポジトリを、フォークした自分のリポジトリに、同期（Sync Fork）させます。

  - 自分のコンピュータ上の、ローカル・リポジトリの　main branch も（アクティブな、Branch 名を確認して）Pull をして、更新しておくと良いでしょう。
  - 少し、複雑な、変更の場合には、注意が出ます。詳細は省略しますが、Terminal で、一つの選択肢の、`git config pull.rebase true # rebase` を入力して、それから、もう一度、Pull をすると良いでしょう。これによって、オリジナル・リポジトリと同じ状態を維持することができます。
  
#### 要点

* フォークして作成したリポジトリ（リモートも、ローカルも）の、main branch は、オリジナル・レポジトリと同じ状態にしておく。
* 編集は、編集用に、branch を作成して、その branch を、リモート・リポジトリにプッシュして、プル・リクエストを行う。
* プル・リクエストの結果が反映されたら、リモートも、ローカルも、同期しておく。
* プル・リクエストが反映される前に、また編集するときは、別の branch を作成して、また、プル・リクエストをするのがよいでしょう。
* 管理者は、merge で、編集結果を反映するときに、注意を要しますから、管理者が編集結果を反映しやすいように、丁寧に、プル・リクエストのときの説明をしておくのがよいと思います。


### 参考にしたサイト

#### Git - GitHub - RStudio 関連

* [git -- everything is local](https://git-scm.com/about)
  - About、Documentation など
* GitHub Docs: [Hellow World](https://docs.github.com/ja/get-started/quickstart/hello-world)
  - 基本的なことがコンパクトにまとまっている GitHub のサイトです。日本語もサポートしています。
* Introduction to Data Science, by Rafael A. Irizarry
  - [Git and GitHub](http://rafalab.dfci.harvard.edu/dsbook/git.html#git)
  - edX の、データサイエンスのコースの教科書に入っています。よく、まとまっていると思います。原語は英語ですが、Google などの翻訳機能を使っても、十分理解することができると思います。Git と GitHub の概要から、Bookdown パッケージによる、電子書籍の執筆の前までは、基本的に、この教科書を参考にしていますが、それぞれのステップでの、スクリーンショットもたくさん掲載されており、確認がしやすいようになっています。
* [Git-GitHub-RStudio](https://icu-hsuzuki.github.io/myds/techmemo.html#git-github-rstudio): 個人的メモ

#### Bookdown 関連

* The bookdown book: https://bookdown.org/yihui/bookdown/

* The bookdown package reference site: https://pkgs.rstudio.com/bookdown

* How to create a bookdown book in 5 minutes: https://www.youtube.com/watch?v=m5D-yoH416Y

#### 複数アカウント・複数のキー関連

* [Using the same github account from multiple PCs](https://serverfault.com/questions/206907/using-the-same-github-account-from-multiple-pcs)
* [複数のGitHubアカウントを使い分けたい時の設定方法とTips](https://zenn.dev/taichifukumoto/articles/how-to-use-multiple-github-accounts)
* [Adding a new SSH key to your GitHub account](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account)



<!--chapter:end:85-tools.Rmd-->

# Bookdown {#bookdown-original}



## About

This is a _sample_ book written in **Markdown**. You can use anything that Pandoc's Markdown supports; for example, a math equation $a^2 + b^2 = c^2$.

### Usage 

Each **bookdown** chapter is an .Rmd file, and each .Rmd file can contain one (and only one) chapter. A chapter *must* start with a first-level heading: `# A good chapter`, and can contain one (and only one) first-level heading.

Use second-level and higher headings within chapters like: `## A short section` or `### An even shorter section`.

The `index.Rmd` file is required, and is also your first book chapter. It will be the homepage when you render the book.

### Render book

You can render the HTML version of this example book without changing anything:

1. Find the **Build** pane in the RStudio IDE, and

1. Click on **Build Book**, then select your output format, or select "All formats" if you'd like to use multiple formats from the same book source files.

Or build the book from the R console:


```r
bookdown::render_book()
```

To render this example to PDF as a `bookdown::pdf_book`, you'll need to install XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): <https://yihui.org/tinytex/>.

### Preview book

As you work, you may start a local server to live preview this HTML book. This preview will update as you edit the book when you save individual .Rmd files. You can start the server in a work session by using the RStudio add-in "Preview book", or from the R console:


```r
bookdown::serve_book()
```





## Hello bookdown 

All chapters start with a first-level heading followed by your chapter title, like the line above. There should be only one first-level heading (`#`) per .Rmd file.

### A section

All chapter sections start with a second-level (`##`) or higher heading followed by your section title, like the sections above and below here. You can have as many as you want within a chapter.

#### An unnumbered section {-}

Chapters and sections are numbered by default. To un-number a heading, add a `{.unnumbered}` or the shorter `{-}` at the end of the heading, like in this section.


## Cross-references {#cross}

Cross-references make it easier for your readers to find and link to elements in your book.

### Chapters and sub-chapters

There are two steps to cross-reference any heading:

1. Label the heading: `# Hello world {#nice-label}`. 
    - Leave the label off if you like the automated heading generated based on your heading title: for example, `# Hello world` = `# Hello world {#hello-world}`.
    - To label an un-numbered heading, use: `# Hello world {-#nice-label}` or `{# Hello world .unnumbered}`.

1. Next, reference the labeled heading anywhere in the text using `\@ref(nice-label)`; for example, please see Chapter \@ref(cross). 
    - If you prefer text as the link instead of a numbered reference use: [any text you want can go here](#cross).

### Captioned figures and tables

Figures and tables *with captions* can also be cross-referenced from elsewhere in your book using `\@ref(fig:chunk-label)` and `\@ref(tab:chunk-label)`, respectively.

See Figure \@ref(fig:nice-fig).


```r
par(mar = c(4, 4, .1, .1))
plot(pressure, type = 'b', pch = 19)
```

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{90-bookdown_files/figure-latex/nice-fig-1} 

}

\caption{Here is a nice figure!}(\#fig:nice-fig)
\end{figure}

Don't miss Table \@ref(tab:nice-tab).


```r
knitr::kable(
  head(pressure, 10), caption = 'Here is a nice table!',
  booktabs = TRUE
)
```

\begin{table}

\caption{(\#tab:nice-tab)Here is a nice table!}
\centering
\begin{tabular}[t]{rr}
\toprule
temperature & pressure\\
\midrule
0 & 0.0002\\
20 & 0.0012\\
40 & 0.0060\\
60 & 0.0300\\
80 & 0.0900\\
\addlinespace
100 & 0.2700\\
120 & 0.7500\\
140 & 1.8500\\
160 & 4.2000\\
180 & 8.8000\\
\bottomrule
\end{tabular}
\end{table}




## Parts

You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file. 

Add a numbered part: `# (PART) Act one {-}` (followed by `# A chapter`)

Add an unnumbered part: `# (PART\*) Act one {-}` (followed by `# A chapter`)

Add an appendix as a special kind of un-numbered part: `# (APPENDIX) Other stuff {-}` (followed by `# A chapter`). Chapters in an appendix are prepended with letters instead of numbers.

## Footnotes and citations 

### Footnotes

Footnotes are put inside the square brackets after a caret `^[]`. Like this one ^[This is a footnote.]. 

### Citations

Reference items in your bibliography file(s) using `@key`.

For example, we are using the **bookdown** package [@R-bookdown] (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and **knitr** [@xie2015] (this citation was added manually in an external file book.bib). 
Note that the `.bib` files need to be listed in the index.Rmd with the YAML `bibliography` key.


The `bs4_book` theme makes footnotes appear inline when you click on them. In this example book, we added `csl: chicago-fullnote-bibliography.csl` to the `index.Rmd` YAML, and include the `.csl` file. To download a new style, we recommend: https://www.zotero.org/styles/


The RStudio Visual Markdown Editor can also make it easier to insert citations: <https://rstudio.github.io/visual-markdown-editing/#/citations>


## Blocks

### Equations

Here is an equation.

\begin{equation} 
  f\left(k\right) = \binom{n}{k} p^k\left(1-p\right)^{n-k}
  (\#eq:binom)
\end{equation} 

You may refer to using `\@ref(eq:binom)`, like see Equation \@ref(eq:binom).


### Theorems and proofs

Labeled theorems can be referenced in text using `\@ref(thm:tri)`, for example, check out this smart theorem \@ref(thm:tri).

::: {.theorem #tri}
For a right triangle, if $c$ denotes the *length* of the hypotenuse
and $a$ and $b$ denote the lengths of the **other** two sides, we have
$$a^2 + b^2 = c^2$$
:::

Read more here <https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html>.

### Callout blocks


The `bs4_book` theme also includes special callout blocks, like this `.rmdnote`.

::: {.rmdnote}
You can use **markdown** inside a block.


```r
head(beaver1, n = 5)
#>   day time  temp activ
#> 1 346  840 36.33     0
#> 2 346  850 36.34     0
#> 3 346  900 36.35     0
#> 4 346  910 36.42     0
#> 5 346  920 36.55     0
```

:::

It is up to the user to define the appearance of these blocks for LaTeX output. 

You may also use: `.rmdcaution`, `.rmdimportant`, `.rmdtip`, or `.rmdwarning` as the block name.


The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html


## Sharing your book

### Publishing

HTML books can be published online, see: https://bookdown.org/yihui/bookdown/publishing.html

### 404 pages

By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If you'd like to customize your 404 page instead of using the default, you may add either a `_404.Rmd` or `_404.md` file to your project root and use code and/or Markdown syntax.

### Metadata for sharing

Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the `index.Rmd` YAML. To setup, set the `url` for your book and the path to your `cover-image` file. Your book's `title` and `description` are also used.


This `bs4_book` provides enhanced metadata for social sharing, so that each chapter shared will have a unique description, auto-generated based on the content.

Specify your book's source repository on GitHub as the `repo` in the `_output.yml` file, which allows users to view each chapter's source file or suggest an edit. Read more about the features of this output format here:

https://pkgs.rstudio.com/bookdown/reference/bs4_book.html

Or use:


```r
?bookdown::bs4_book
```






<!--chapter:end:90-bookdown.Rmd-->

# To Do リスト {#todo-list}

この文書について

01. はじめに

  - 1.1 データサイエンスとは
    - 1.1.1 なぜ、データサイエンスが最近注目されているのか
    - 1.1.2 なぜ、一人ひとりが、データサイエンスを、学ぶ必要があるのでしょうか
    - 1.1.3 AI の活用
  - 1.2 「データサイエンスを始めましょう」の特徴
    - 1.2.1 学習者として想定しているのは
    - 1.2.2 オープン・パブリックデータの活用
    - 1.2.3 世界のデータをみること
    - 1.2.4 目標としていること
  - 1.3 学習方法について
  - 1.4 参考

02. 学ぶ内容　

  - 2.1 データサイエンス入門
  - 2.2 第一部　パブリックデータ
  - 2.3 第二部　基本
  - 2.4 第三部　国際機関などのデータの活用
  - 2.5 第四部　探索的データ分析 Exploratory Data Analysis
  - 2.6 第五部　分析例
  - 2.7 付録
  
03. はじめてのデータサイエンス

  - 3.1 データサイエンスの実際
  - 3.2 R のパッケージを活用
    - 3.2.1 準備 Setup
    - 3.2.2 データ取得 Import data
    - 3.2.3 データ構造の確認
    - 3.2.4 必要に応じて整形 Transform data
    - 3.2.5 視覚化 data visualization
    - 3.2.6 データの理解 Understand data
    - 3.2.7 さまざまな視覚化
  - 3.3 練習
  - 3.4 プロジェクト
  - 3.5 まとめ

04. 世界開発指標

  - 4.1 世界銀行（World Bank）
    - 4.1.1 世界銀行オープンデータ
    - 4.1.2 データカタログ
    - 4.1.3 世界開発指標（WDI）
    - 4.1.4 オープンデータの定義（Open Data Defined）
  - 4.2 世界開発指標（WDI）
    - 4.2.1 世界のさまざまな課題
    - 4.2.2 ダッシュボード・データの取得・データコード
  - 4.3 世界銀行以外の国際機関のパブリックデータ
  - 4.4 持続的開発目標（SDGs） データ
  - 4.5 課題

PART I PUBLIC DATA

11. Public Data

  - 5.1 オープンデータ
    - 5.1.1 Open Government Data Toolkit: Open Data Defined
  - 5.2 日本から世界を見る
  - 5.3 世界銀行（World Bank）
    - 5.3.1 世界開発指数（World Development Indicator (WDI)）
    - 5.3.2 World Bank: WDI - World Development Indicaters
    - 5.3.3 世界開発指標（World Development Indicator）
    - 5.3.4 例
  - 5.4 世界のさまざまな課題から見る
  - 5.5 OECD
  - 5.6 UN Data
  - 5.7 Our World in Data
  - 5.8 Eurostat

PART II BASICS

21. R Studio で R

  - 6.1 はじめに
  - 6.2 R と R Studio
  - 6.3 R と R Studio のインストール
    - 6.3.1 R のインストール
    - 6.3.2 R Studio の インストール
    - 6.3.3 動作確認
    - 6.3.4 トラブル・シューティング（１）
  - 6.4 クラウド - Posit Cloud
    - 6.4.1 クラウドサービス　How to Start Posit Cloud
    - 6.4.2 PositCloud Shared Project
    - 6.4.3 Posit Primers and Cheat Sheet
  - 6.5 R のその他の利用方法
  - 6.5.1 Google colab で R
  - 6.5.2 CoCalc で R と RMarkdown

22. R Markdown

  - 7.1 Reproducible and Literate Programming
    - 7.1.1 目的、問いなど
    - 7.1.2 データについて
    - 7.1.3 コードについて
    - 7.1.4 グラフについて
    - 7.1.5 まとめ：R Markdown の目的
  - 7.2 準備：パッケージのインストール
  - 7.3 R Notebook
  - 7.4 日本語のテンプレート
  - 7.5 R Markdown いくつかの Output
  - 7.6 YouTube Video - rmarkdown
    -7.6.1 RMarkdown で PDF を作成するときの注意

23. R Basics

  - 8.1 プロジェクト - Project
  - 8.2 コンソールで実行 - Run in Console
    - 8.2.1 最初の四つ
    - 8.2.2 アサインメント、ヘルプ
    - 8.2.3 おすすめ
    - 8.2.4 練習
  - 8.3 RStudio について
    - 8.3.1 四つの窓枠とタブ Four Panes and Tabs
  - 8.4 R Script 実行記録
    - 8.4.1 R Script の作成
    - 8.4.2 R Script による実行
    - 8.4.3 練習
    - 8.4.4 Tips
  - 8.5 パッケージ - Packages
    - 8.5.1 パッケージのインストール
    - 8.5.2 備考
  - 8.6 練習問題 Posit Primers
    - 8.6.1 最初の演習　The Basics – r4ds: Explore, I
  - 8.7 参考文献 References
  - 8.8 YouTube Video - getstarted

PART III INSTITUTIONAL DATA

31. World Bank

  - 9.1 World Development Indicator (WDI)
    - 9.1.1 指標 Indicators (WDI)
    - 9.1.2 指標 WDI (World Development Indicators)
    - 9.1.3 指標 のコード、WDI code を探してみよう
    - 9.1.4 指標 WDIの例
    - 9.1.5 練習 1. - 調べてみたい WDI 指標とそのコード
  - 9.2 WDI パッケージ
    - 9.2.1 指標 WDI 検索
    - 9.2.2 指標 WDI データのダウンロード
  - 9.3 可視化 Visualization
    - 9.3.1 グラフ 1
    - 9.3.2 グラフ 2
    - 9.3.3 テンプレート Templates
  -9.4 課題　Assignment

PART IV EDA

41. 探索的データ解析

- 10.1 探索的データ解析 (EDA)とは
- 10.2 探索的データ解析 (EDA) の一例
    - 10.2.1 データの取得と読み込み - Data Import
    - 10.2.2 データ変形・整形 - Data Transformation
    - 10.2.3 可視化 Data Visualization
    - 10.2.4 データモデリング Data Modeling

PART V EXAMPLES

51. Example 1

APPENDIX

81. 日本語の扱いについて

  - A.1 日本語・中国語・韓国語
    - A.1.1 パッケージをロード
  - A.2 Base R でタイトルに日本語
  - A.3 列名や、データに日本語
  - A.4 kable で表示
  - A.5 ggplot でグラフを作成
  - A.6 備考：
  - A.7 参考：日本語の表示について
    - A.7.1 データファイルの読み込み
    - A.7.2 図の中のテキスト
    - A.7.3 R Markdown の出力
    - A.7.4 bookdown
    - A.7.5 参考としたもの

85. IT ツール

  - B.1 Git と GitHub
    - B.1.1 概要
    - B.1.2 はじめかた
    - B.1.3 GitHub にあるリモート・リポジトリ（Remote Repo）から始める場合
    - B.1.4 自分のコンピュータのリポジトリ（Local Repo）から始める場合
    - B.1.5 GitHub Pages について
    - B.1.6 Bookdown パッケージによる、電子書籍の執筆
    - B.1.7 大きなファイルに関すること
    - B.1.8 複数のコンピュータから利用する方法
    - B.1.9 複数のアカウントを一つのコンピュータから利用する方法
    - B.1.10 共同作業をする場合
    - B.1.11 参考にしたサイト

90. Bookdown
95. To do list

<!--chapter:end:95-todo-list.Rmd-->

