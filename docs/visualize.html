<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 18 視覚化（Visualize） | データサイエンスをはじめましょう - Data Science for All -</title>

    <meta name="author" content="鈴木寛（Hirosi Suzuki）" />
  
   <meta name="description" content="<p>This is a lecture note using the bookdown package to write a book in Japanese.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 18 視覚化（Visualize） | データサイエンスをはじめましょう - Data Science for All -" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://icu-hsuzuki.github.io/ds4aj/" />
  
  <meta property="og:description" content="<p>This is a lecture note using the bookdown package to write a book in Japanese.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 視覚化（Visualize） | データサイエンスをはじめましょう - Data Science for All -" />
  
  <meta name="twitter:description" content="<p>This is a lecture note using the bookdown package to write a book in Japanese.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">データサイエンスをはじめましょう<br />
- Data Science for All -</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="visualize" class="section level1" number="18">
<h1><span class="header-section-number">Chapter 18</span> 視覚化（Visualize）</h1>
<div id="基本的なこと" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> 基本的なこと</h2>
<p>R では、簡単に、グラフを描画できますが、質の高いグラフを作成するには、<code>ggplot2</code> パッケージを用いたものが標準となっています。<code>ggplot2</code> は、<code>tidyverse</code> パッケージの一部ですので、<code>tidyverse</code> パッケージをインストール、使えるように、<code>library(tidyverse)</code> として読み込んであれば、そのまま使うことができます。</p>
<p>サイト：<a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a> パッケージサイト：<a href="https://CRAN.R-project.org/package=ggplot2" class="uri">https://CRAN.R-project.org/package=ggplot2</a></p>
<div id="ggplot2-概要-1" class="section level3" number="18.1.1">
<h3><span class="header-section-number">18.1.1</span> ggplot2 概要</h3>
<blockquote>
<p>ggplot2 is a system for declaratively creating graphics, based on The Grammar of Graphics. You provide the data, tell ggplot2 how to map variables to aesthetics, what graphical primitives to use, and it takes care of the details.</p>
<p>ggplot2は、グラフィックスの生成に関する「Grammar of Graphics（グラフィックスの文法）」に基づいて、宣言的にグラフを作成するためのシステムです。データを提供し、変数を視覚的要素にマッピングする方法や、どのようなグラフィカルな基本要素を使用するかをggplot2に伝えると、詳細な部分はggplot2 が処理してくれます。</p>
</blockquote>
</div>
<div id="基本的な例" class="section level3" number="18.1.2">
<h3><span class="header-section-number">18.1.2</span> 基本的な例</h3>
<div id="tidyverse-の読み込み" class="section level4" number="18.1.2.1">
<h4><span class="header-section-number">18.1.2.1</span> <code>tidyverse</code> の読み込み</h4>
<p>タイトルに日本語を使う場合があるときは、<code>install.packages('showtext')</code> で、<code>showtext</code> パッケージをインストールして、下のように設定してください。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="visualize.html#cb89-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-2"><a href="visualize.html#cb89-2" tabindex="-1"></a><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span id="cb89-3"><a href="visualize.html#cb89-3" tabindex="-1"></a><span class="co">#&gt; ✔ dplyr     1.1.2     ✔ readr     2.1.4</span></span>
<span id="cb89-4"><a href="visualize.html#cb89-4" tabindex="-1"></a><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.0</span></span>
<span id="cb89-5"><a href="visualize.html#cb89-5" tabindex="-1"></a><span class="co">#&gt; ✔ ggplot2   3.4.2     ✔ tibble    3.2.1</span></span>
<span id="cb89-6"><a href="visualize.html#cb89-6" tabindex="-1"></a><span class="co">#&gt; ✔ lubridate 1.9.2     ✔ tidyr     1.3.0</span></span>
<span id="cb89-7"><a href="visualize.html#cb89-7" tabindex="-1"></a><span class="co">#&gt; ✔ purrr     1.0.1     </span></span>
<span id="cb89-8"><a href="visualize.html#cb89-8" tabindex="-1"></a><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb89-9"><a href="visualize.html#cb89-9" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span id="cb89-10"><a href="visualize.html#cb89-10" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span id="cb89-11"><a href="visualize.html#cb89-11" tabindex="-1"></a><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span id="cb89-12"><a href="visualize.html#cb89-12" tabindex="-1"></a><span class="fu">library</span>(showtext) </span>
<span id="cb89-13"><a href="visualize.html#cb89-13" tabindex="-1"></a><span class="co">#&gt; Loading required package: sysfonts</span></span>
<span id="cb89-14"><a href="visualize.html#cb89-14" tabindex="-1"></a><span class="co">#&gt; Loading required package: showtextdb</span></span>
<span id="cb89-15"><a href="visualize.html#cb89-15" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span></code></pre></div>
<p><code>ggplot2</code> に含まれている、<code>mpg</code> データを使って、簡単な、散布図と、箱ひげ図を描いてみます。<code>mpg</code> の変数などについては、Help で調べてください。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="visualize.html#cb90-1" tabindex="-1"></a><span class="fu">str</span>(mpg)</span>
<span id="cb90-2"><a href="visualize.html#cb90-2" tabindex="-1"></a><span class="co">#&gt; tibble [234 × 11] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb90-3"><a href="visualize.html#cb90-3" tabindex="-1"></a><span class="co">#&gt;  $ manufacturer: chr [1:234] &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ...</span></span>
<span id="cb90-4"><a href="visualize.html#cb90-4" tabindex="-1"></a><span class="co">#&gt;  $ model       : chr [1:234] &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ...</span></span>
<span id="cb90-5"><a href="visualize.html#cb90-5" tabindex="-1"></a><span class="co">#&gt;  $ displ       : num [1:234] 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...</span></span>
<span id="cb90-6"><a href="visualize.html#cb90-6" tabindex="-1"></a><span class="co">#&gt;  $ year        : int [1:234] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...</span></span>
<span id="cb90-7"><a href="visualize.html#cb90-7" tabindex="-1"></a><span class="co">#&gt;  $ cyl         : int [1:234] 4 4 4 4 6 6 6 4 4 4 ...</span></span>
<span id="cb90-8"><a href="visualize.html#cb90-8" tabindex="-1"></a><span class="co">#&gt;  $ trans       : chr [1:234] &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ...</span></span>
<span id="cb90-9"><a href="visualize.html#cb90-9" tabindex="-1"></a><span class="co">#&gt;  $ drv         : chr [1:234] &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ...</span></span>
<span id="cb90-10"><a href="visualize.html#cb90-10" tabindex="-1"></a><span class="co">#&gt;  $ cty         : int [1:234] 18 21 20 21 16 18 18 18 16 20 ...</span></span>
<span id="cb90-11"><a href="visualize.html#cb90-11" tabindex="-1"></a><span class="co">#&gt;  $ hwy         : int [1:234] 29 29 31 30 26 26 27 26 25 28 ...</span></span>
<span id="cb90-12"><a href="visualize.html#cb90-12" tabindex="-1"></a><span class="co">#&gt;  $ fl          : chr [1:234] &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ...</span></span>
<span id="cb90-13"><a href="visualize.html#cb90-13" tabindex="-1"></a><span class="co">#&gt;  $ class       : chr [1:234] &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ...</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="visualize.html#cb91-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="visualize.html#cb92-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li><p><code>data = mpg</code> でデータを指定します。</p></li>
<li><p>どのようなグラフにするか、幾何関数（Geometric Function）を指定します。散布図では、<code>geom_pont()</code> 、箱ひげ図では、<code>geom_boxplot()</code> です。</p></li>
<li><p>x 軸、y 軸などに対応する変数の写像（mapping）を指定します。</p>
<ul>
<li><p>散布図では、<code>dspl</code> （displacemnt エンジンの排気量（単位 リットル））を x 軸に、<code>hwy</code> 高速道路で１ガロンで走れる距離（単位 マイル）を y 軸に割り当てています。</p></li>
<li><p>箱ひげ図では、<code>class</code> 車の型式を、x 軸に、<code>hwy</code> 高速道路で１ガロンで走れる距離（単位 マイル）を y 軸に割り当てています。</p></li>
</ul></li>
</ol>
<p>記号的に書くと、下のようになっています。</p>
<p><code>ggplot(data = &lt;DATA&gt;) + &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))</code></p>
</div>
</div>
</div>
<div id="散布図scatter-plot" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> 散布図（Scatter Plot）</h2>
<p>散布図は、データの二つの変数（列） を x と y に対応させる、最も基本的なグラフです。最初に試すべきグラフだともいうことができます。<code>mapping =</code> は省略することができます。</p>
<pre><code>ggplot(data = &lt;data&gt;, aes(x = &lt;column name for x&gt;, y = &lt;column name for y&gt;)) +
  geom_point()</code></pre>
<pre><code>ggplot(data = df_iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point()</code></pre>
<p>変形（Transform）のときにつかった、<code>iris</code> データを使います。</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="visualize.html#cb95-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="visualize.html#cb95-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="ラベル-labels" class="section level3" number="18.2.1">
<h3><span class="header-section-number">18.2.1</span> ラベル <a href="https://ggplot2.tidyverse.org/reference/labs.html">Labels</a></h3>
<p>グラフの表題や、x 軸、y 軸のラベルをつけるには <code>labs()</code> を使います。</p>
<pre><code>ggplot(data = &lt;data&gt;, aes(x = &lt;column name for x&gt;, y = &lt;column name for y&gt;)) +
  geom_point() +
  labs(title = &quot;Title&quot;, x = &quot;Label for x&quot;, y = &quot;Label for y&quot;)</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="visualize.html#cb97-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb97-2"><a href="visualize.html#cb97-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb97-3"><a href="visualize.html#cb97-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Scatter Plot of Sepal Data of Iris&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Sepal Length&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sepal Width&quot;</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="visualize.html#cb98-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb98-2"><a href="visualize.html#cb98-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb98-3"><a href="visualize.html#cb98-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;菖蒲の萼の長さと幅についての散布図&quot;</span>, <span class="at">x =</span> <span class="st">&quot;萼の長さ&quot;</span>, <span class="at">y =</span> <span class="st">&quot;萼の幅&quot;</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>このように、日本語をタイトルや、ラベルに使うことも可能ですが、以後は、データに日本語が含まれていない場合には、そのまま表示します。</p>
</div>
<div id="色付き-colors" class="section level3" number="18.2.2">
<h3><span class="header-section-number">18.2.2</span> 色付き <a href="https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html">Colors</a></h3>
<p>菖蒲（iris）のデータは、Species 列に、三種類の菖蒲の名前が含まれていました。それぞれに、違う色で表示してみましょう。それには、x 軸、y 軸に対応する変数を指定したように、<code>color = Species</code> と指定します。</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="visualize.html#cb99-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb99-2"><a href="visualize.html#cb99-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="形状-shapes" class="section level3" number="18.2.3">
<h3><span class="header-section-number">18.2.3</span> 形状 <a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html">Shapes</a></h3>
<p>色ではなく、形で Species を区別することも可能です。</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="visualize.html#cb100-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb100-2"><a href="visualize.html#cb100-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>色と、形、両方を同時に使うことも可能です。</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="visualize.html#cb101-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width, <span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="visualize.html#cb101-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="箱ひげ図-boxplot" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> 箱ひげ図 <a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">Boxplot</a></h2>
<p>The boxplot compactly displays the distribution of a continuous variable.</p>
<p>箱ひげ図は、連続な値をとる変数の分布を簡潔な表示でみることができるグラフです。箱や、線の長さ、外れ値の表示なども、正確に決まっていますので、次のビデオをみてください。英語ですが、わかりやすく、まとまっていると思います。</p>
<p><a href="https://vimeo.com/222358034" class="uri">https://vimeo.com/222358034</a></p>
<p>Transcript ボタンから、スクリプトを表示することもできます。</p>
<p>例のように、それぞれのグループごとに箱ひげ図を表示することもできますが、その場合は、文字データや、離散的な数値データ（いくつかの飛び飛びの値をとる変数）を使います。x と y を入れ替えれば、横向きになります。</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="visualize.html#cb102-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="visualize.html#cb102-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="visualize.html#cb103-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">y =</span> Species, <span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb103-2"><a href="visualize.html#cb103-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>color を指定すると、枠に色がつき、fill を指定すると、箱の中が塗り潰されます。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="visualize.html#cb104-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb104-2"><a href="visualize.html#cb104-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="visualize.html#cb105-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb105-2"><a href="visualize.html#cb105-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div id="ヒストグラム-histogram" class="section level3" number="18.3.1">
<h3><span class="header-section-number">18.3.1</span> ヒストグラム <a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">Histogram</a></h3>
<p>Visualize the distribution of a single continuous variable by dividing the x axis into bins and counting the number of observations in each bin. Histograms (geom_histogram()) display the counts with bars; frequency polygons (<code>geom_freqpoly()</code>) display the counts with lines. Frequency polygons are more suitable when you want to compare the distribution across the levels of a categorical variable.</p>
<p>単一の連続変数の分布を可視化するために、x軸をビンに分割し、各ビン内の観測値の数を数えます。ヒストグラム（geom_histogram()）は、棒で数を表示します。一方、頻度多角形（geom_freqpoly()）は、数を線で表示します。頻度多角形は、カテゴリ変数のレベル間の分布を比較したい場合により適しています。</p>
<p>説明ビデオです。<a href="https://vimeo.com/221607341" class="uri">https://vimeo.com/221607341</a></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="visualize.html#cb106-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb106-2"><a href="visualize.html#cb106-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb106-3"><a href="visualize.html#cb106-3" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span id="cb106-4"><a href="visualize.html#cb106-4" tabindex="-1"></a><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>枠（bins）を幾つに分けるか、または枠の幅を指定するようにとのメッセージが表示されます。</p>
<p>枠（bins）の数を変更するには <code>bins =</code> <code>&lt;number&gt;</code>　を使います。幅を指定するときは、<code>binwidth = &lt;number&gt;</code> とします。</p>
<p>最初の例では、枠の個数を（初期設定では30になっているものを）10個とし、二つ目の例では、幅を1にしています。</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="visualize.html#cb107-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb107-2"><a href="visualize.html#cb107-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="visualize.html#cb108-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb108-2"><a href="visualize.html#cb108-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>頻度多角形（geom_freqpoly()）を使うと以下のようになります。Species ごとに比べたり、色をつけたりもできます。</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="visualize.html#cb109-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb109-2"><a href="visualize.html#cb109-2" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>()</span>
<span id="cb109-3"><a href="visualize.html#cb109-3" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span id="cb109-4"><a href="visualize.html#cb109-4" tabindex="-1"></a><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="visualize.html#cb110-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb110-2"><a href="visualize.html#cb110-2" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>滑らかな曲線にするときは、density plot を使います。alpha は透明度で 0 から 1 の値で指定します。数が小さい方が薄くなります。color で線の色もあわせて設定することも可能です。いろいろと試してみてください。</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="visualize.html#cb111-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb111-2"><a href="visualize.html#cb111-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="線形モデル-data-modeling" class="section level3" number="18.3.2">
<h3><span class="header-section-number">18.3.2</span> 線形モデル Data Modeling</h3>
<p>回帰直線を加えたり、他の近似曲線を加えることも可能です。グラフとしても直感的理解を助けますが、統計的な扱いについては、Modeling で説明します。</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="visualize.html#cb112-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb112-2"><a href="visualize.html#cb112-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-3"><a href="visualize.html#cb112-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="visualize.html#cb113-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb113-2"><a href="visualize.html#cb113-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-3"><a href="visualize.html#cb113-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
</div>
<div id="例-パッケージ-gapminder-を使って" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> 例　パッケージ Gapminder を使って</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="visualize.html#cb114-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb114-2"><a href="visualize.html#cb114-2" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb114-3"><a href="visualize.html#cb114-3" tabindex="-1"></a><span class="fu">library</span>(WDI)</span></code></pre></div>
<p>すでに、<code>dplyr</code> をつかった変形で確認しましたが、簡単に、データを見ておきましょう。</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="visualize.html#cb115-1" tabindex="-1"></a>df_gm <span class="ot">&lt;-</span> gapminder</span>
<span id="cb115-2"><a href="visualize.html#cb115-2" tabindex="-1"></a>df_gm <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb115-3"><a href="visualize.html#cb115-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 6</span></span>
<span id="cb115-4"><a href="visualize.html#cb115-4" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb115-5"><a href="visualize.html#cb115-5" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb115-6"><a href="visualize.html#cb115-6" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb115-7"><a href="visualize.html#cb115-7" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb115-8"><a href="visualize.html#cb115-8" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb115-9"><a href="visualize.html#cb115-9" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb115-10"><a href="visualize.html#cb115-10" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb115-11"><a href="visualize.html#cb115-11" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb115-12"><a href="visualize.html#cb115-12" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.</span></span>
<span id="cb115-13"><a href="visualize.html#cb115-13" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.</span></span>
<span id="cb115-14"><a href="visualize.html#cb115-14" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.</span></span>
<span id="cb115-15"><a href="visualize.html#cb115-15" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.</span></span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="visualize.html#cb116-1" tabindex="-1"></a><span class="fu">glimpse</span>(df_gm)</span>
<span id="cb116-2"><a href="visualize.html#cb116-2" tabindex="-1"></a><span class="co">#&gt; Rows: 1,704</span></span>
<span id="cb116-3"><a href="visualize.html#cb116-3" tabindex="-1"></a><span class="co">#&gt; Columns: 6</span></span>
<span id="cb116-4"><a href="visualize.html#cb116-4" tabindex="-1"></a><span class="co">#&gt; $ country   &lt;fct&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanist…</span></span>
<span id="cb116-5"><a href="visualize.html#cb116-5" tabindex="-1"></a><span class="co">#&gt; $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia…</span></span>
<span id="cb116-6"><a href="visualize.html#cb116-6" tabindex="-1"></a><span class="co">#&gt; $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982…</span></span>
<span id="cb116-7"><a href="visualize.html#cb116-7" tabindex="-1"></a><span class="co">#&gt; $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, …</span></span>
<span id="cb116-8"><a href="visualize.html#cb116-8" tabindex="-1"></a><span class="co">#&gt; $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13…</span></span>
<span id="cb116-9"><a href="visualize.html#cb116-9" tabindex="-1"></a><span class="co">#&gt; $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, …</span></span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="visualize.html#cb117-1" tabindex="-1"></a><span class="fu">summary</span>(df_gm)</span>
<span id="cb117-2"><a href="visualize.html#cb117-2" tabindex="-1"></a><span class="co">#&gt;         country        continent        year     </span></span>
<span id="cb117-3"><a href="visualize.html#cb117-3" tabindex="-1"></a><span class="co">#&gt;  Afghanistan:  12   Africa  :624   Min.   :1952  </span></span>
<span id="cb117-4"><a href="visualize.html#cb117-4" tabindex="-1"></a><span class="co">#&gt;  Albania    :  12   Americas:300   1st Qu.:1966  </span></span>
<span id="cb117-5"><a href="visualize.html#cb117-5" tabindex="-1"></a><span class="co">#&gt;  Algeria    :  12   Asia    :396   Median :1980  </span></span>
<span id="cb117-6"><a href="visualize.html#cb117-6" tabindex="-1"></a><span class="co">#&gt;  Angola     :  12   Europe  :360   Mean   :1980  </span></span>
<span id="cb117-7"><a href="visualize.html#cb117-7" tabindex="-1"></a><span class="co">#&gt;  Argentina  :  12   Oceania : 24   3rd Qu.:1993  </span></span>
<span id="cb117-8"><a href="visualize.html#cb117-8" tabindex="-1"></a><span class="co">#&gt;  Australia  :  12                  Max.   :2007  </span></span>
<span id="cb117-9"><a href="visualize.html#cb117-9" tabindex="-1"></a><span class="co">#&gt;  (Other)    :1632                                </span></span>
<span id="cb117-10"><a href="visualize.html#cb117-10" tabindex="-1"></a><span class="co">#&gt;     lifeExp           pop              gdpPercap       </span></span>
<span id="cb117-11"><a href="visualize.html#cb117-11" tabindex="-1"></a><span class="co">#&gt;  Min.   :23.60   Min.   :6.001e+04   Min.   :   241.2  </span></span>
<span id="cb117-12"><a href="visualize.html#cb117-12" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:48.20   1st Qu.:2.794e+06   1st Qu.:  1202.1  </span></span>
<span id="cb117-13"><a href="visualize.html#cb117-13" tabindex="-1"></a><span class="co">#&gt;  Median :60.71   Median :7.024e+06   Median :  3531.8  </span></span>
<span id="cb117-14"><a href="visualize.html#cb117-14" tabindex="-1"></a><span class="co">#&gt;  Mean   :59.47   Mean   :2.960e+07   Mean   :  7215.3  </span></span>
<span id="cb117-15"><a href="visualize.html#cb117-15" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:70.85   3rd Qu.:1.959e+07   3rd Qu.:  9325.5  </span></span>
<span id="cb117-16"><a href="visualize.html#cb117-16" tabindex="-1"></a><span class="co">#&gt;  Max.   :82.60   Max.   :1.319e+09   Max.   :113523.1  </span></span>
<span id="cb117-17"><a href="visualize.html#cb117-17" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<div id="tidyverseggplot" class="section level4" number="18.4.0.1">
<h4><span class="header-section-number">18.4.0.1</span> Tidyverse::ggplot</h4>
<div id="first-try---with-failures" class="section level5" number="18.4.0.1.1">
<h5><span class="header-section-number">18.4.0.1.1</span> First Try - with failures</h5>
<p>You will encounter similar failures. We list three of them.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="visualize.html#cb118-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_gm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>There are lots of data in each year: 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …. Can you tell how many years are in the data? The following command shows different years in the data.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="visualize.html#cb119-1" tabindex="-1"></a><span class="fu">unique</span>(df_gm<span class="sc">$</span>year)</span>
<span id="cb119-2"><a href="visualize.html#cb119-2" tabindex="-1"></a><span class="co">#&gt;  [1] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002</span></span>
<span id="cb119-3"><a href="visualize.html#cb119-3" tabindex="-1"></a><span class="co">#&gt; [12] 2007</span></span></code></pre></div>
<p>You can guess it from the data summary above. Can you imagine how many countries are in the data? 142? Anyhow, too many points are on each year.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="visualize.html#cb120-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_gm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Now, you can guess the reason why you had this output. This is often called a saw-tooth.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="visualize.html#cb121-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_gm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb121-2"><a href="visualize.html#cb121-2" tabindex="-1"></a><span class="co">#&gt; Warning: Continuous x aesthetic</span></span>
<span id="cb121-3"><a href="visualize.html#cb121-3" tabindex="-1"></a><span class="co">#&gt; ℹ did you forget `aes(group = ...)`?</span></span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Can you see what the problem is? The <code>year</code> is a numerical variable in integer.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="visualize.html#cb122-1" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">pull</span>(df_gm, year)) <span class="co"># same as typeof(df$year)</span></span>
<span id="cb122-2"><a href="visualize.html#cb122-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;integer&quot;</span></span></code></pre></div>
<p>The following looks better.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="visualize.html#cb123-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_gm, <span class="fu">aes</span>(<span class="at">y =</span> lifeExp, <span class="at">group =</span> year)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="box-plot" class="section level5" number="18.4.0.1.2">
<h5><span class="header-section-number">18.4.0.1.2</span> Box Plot</h5>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="visualize.html#cb124-1" tabindex="-1"></a><span class="fu">ggplot</span>(df_gm, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as_factor</span>(year), <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>You can use <code>fill</code> and <code>color</code> for the box plot. Try and check the difference.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="visualize.html#cb125-1" tabindex="-1"></a>df_gm <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1952</span>, <span class="dv">1987</span>, <span class="dv">2007</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="visualize.html#cb125-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as_factor</span>(year), <span class="at">y =</span> lifeExp, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb125-3"><a href="visualize.html#cb125-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>The following are examples of line graphs. Please see the differences.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="visualize.html#cb126-1" tabindex="-1"></a>df_lifeExp <span class="ot">&lt;-</span> df_gm <span class="sc">%&gt;%</span> </span>
<span id="cb126-2"><a href="visualize.html#cb126-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="visualize.html#cb126-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_lifeExp =</span> <span class="fu">mean</span>(lifeExp), <span class="at">median_lifeExp =</span> <span class="fu">median</span>(lifeExp), <span class="at">max_lifeExp =</span> <span class="fu">max</span>(lifeExp), <span class="at">min_lifeExp =</span> <span class="fu">min</span>(lifeExp), <span class="at">.groups =</span> <span class="st">&quot;keep&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="visualize.html#cb127-1" tabindex="-1"></a>df_lifeExp <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb127-2"><a href="visualize.html#cb127-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="visualize.html#cb128-1" tabindex="-1"></a>df_lifeExp <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_lifeExp, <span class="at">color =</span> continent, <span class="at">linetype =</span> continent)) <span class="sc">+</span></span>
<span id="cb128-2"><a href="visualize.html#cb128-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="visualize.html#cb129-1" tabindex="-1"></a>df_lifeExp <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb129-2"><a href="visualize.html#cb129-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span> </span>
<span id="cb129-3"><a href="visualize.html#cb129-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> median_lifeExp, <span class="at">linetype =</span> continent))</span></code></pre></div>
<p><img src="26-visualize_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
</div>
<div id="original-data-wdi" class="section level3" number="18.4.1">
<h3><span class="header-section-number">18.4.1</span> Original Data? WDI?</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="visualize.html#cb130-1" tabindex="-1"></a>df_gm <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb130-2"><a href="visualize.html#cb130-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 6</span></span>
<span id="cb130-3"><a href="visualize.html#cb130-3" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb130-4"><a href="visualize.html#cb130-4" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb130-5"><a href="visualize.html#cb130-5" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb130-6"><a href="visualize.html#cb130-6" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb130-7"><a href="visualize.html#cb130-7" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb130-8"><a href="visualize.html#cb130-8" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb130-9"><a href="visualize.html#cb130-9" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb130-10"><a href="visualize.html#cb130-10" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb130-11"><a href="visualize.html#cb130-11" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.</span></span>
<span id="cb130-12"><a href="visualize.html#cb130-12" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.</span></span>
<span id="cb130-13"><a href="visualize.html#cb130-13" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.</span></span>
<span id="cb130-14"><a href="visualize.html#cb130-14" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.</span></span></code></pre></div>
<div id="wdi-1" class="section level4" number="18.4.1.1">
<h4><span class="header-section-number">18.4.1.1</span> WDI</h4>
<ul>
<li>SP.DYN.LE00.IN: Life expectancy at birth, total (years)</li>
<li>NY.GDP.PCAP.KD: GDP per capita (constant 2015 US$)</li>
<li>SP.POP.TOTL: Population, total</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="visualize.html#cb131-1" tabindex="-1"></a>df_wdi <span class="ot">&lt;-</span> <span class="fu">WDI</span>(</span>
<span id="cb131-2"><a href="visualize.html#cb131-2" tabindex="-1"></a>  <span class="at">country =</span> <span class="st">&quot;all&quot;</span>, </span>
<span id="cb131-3"><a href="visualize.html#cb131-3" tabindex="-1"></a>  <span class="at">indicator =</span> <span class="fu">c</span>(<span class="at">lifeExp =</span> <span class="st">&quot;SP.DYN.LE00.IN&quot;</span>, <span class="at">pop =</span> <span class="st">&quot;SP.POP.TOTL&quot;</span>, <span class="at">gdpPercap =</span> <span class="st">&quot;NY.GDP.PCAP.KD&quot;</span>)</span>
<span id="cb131-4"><a href="visualize.html#cb131-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt; Rows: 16758 Columns: 7
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: &quot;,&quot;
#&gt; chr (3): country, iso2c, iso3c
#&gt; dbl (4): year, lifeExp, pop, gdpPercap
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="visualize.html#cb133-1" tabindex="-1"></a>df_wdi <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb133-2"><a href="visualize.html#cb133-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 7</span></span>
<span id="cb133-3"><a href="visualize.html#cb133-3" tabindex="-1"></a><span class="co">#&gt;    country     iso2c iso3c  year lifeExp      pop gdpPercap</span></span>
<span id="cb133-4"><a href="visualize.html#cb133-4" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb133-5"><a href="visualize.html#cb133-5" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan AF    AFG    1960    32.5  8622466        NA</span></span>
<span id="cb133-6"><a href="visualize.html#cb133-6" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan AF    AFG    1961    33.1  8790140        NA</span></span>
<span id="cb133-7"><a href="visualize.html#cb133-7" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan AF    AFG    1962    33.5  8969047        NA</span></span>
<span id="cb133-8"><a href="visualize.html#cb133-8" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan AF    AFG    1963    34.0  9157465        NA</span></span>
<span id="cb133-9"><a href="visualize.html#cb133-9" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan AF    AFG    1964    34.5  9355514        NA</span></span>
<span id="cb133-10"><a href="visualize.html#cb133-10" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan AF    AFG    1965    35.0  9565147        NA</span></span>
<span id="cb133-11"><a href="visualize.html#cb133-11" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan AF    AFG    1966    35.5  9783147        NA</span></span>
<span id="cb133-12"><a href="visualize.html#cb133-12" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan AF    AFG    1967    35.9 10010030        NA</span></span>
<span id="cb133-13"><a href="visualize.html#cb133-13" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan AF    AFG    1968    36.4 10247780        NA</span></span>
<span id="cb133-14"><a href="visualize.html#cb133-14" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan AF    AFG    1969    36.9 10494489        NA</span></span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="visualize.html#cb134-1" tabindex="-1"></a>df_wdi_extra <span class="ot">&lt;-</span> <span class="fu">WDI</span>(</span>
<span id="cb134-2"><a href="visualize.html#cb134-2" tabindex="-1"></a>  <span class="at">country =</span> <span class="st">&quot;all&quot;</span>, </span>
<span id="cb134-3"><a href="visualize.html#cb134-3" tabindex="-1"></a>  <span class="at">indicator =</span> <span class="fu">c</span>(<span class="at">lifeExp =</span> <span class="st">&quot;SP.DYN.LE00.IN&quot;</span>, <span class="at">pop =</span> <span class="st">&quot;SP.POP.TOTL&quot;</span>, <span class="at">gdpPercap =</span> <span class="st">&quot;NY.GDP.PCAP.KD&quot;</span>), </span>
<span id="cb134-4"><a href="visualize.html#cb134-4" tabindex="-1"></a>  <span class="at">extra =</span> <span class="cn">TRUE</span></span>
<span id="cb134-5"><a href="visualize.html#cb134-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt; Rows: 16758 Columns: 15
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: &quot;,&quot;
#&gt; chr  (7): country, iso2c, iso3c, region, capital, income...
#&gt; dbl  (6): year, lifeExp, pop, gdpPercap, longitude, lati...
#&gt; lgl  (1): status
#&gt; date (1): lastupdated
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="visualize.html#cb136-1" tabindex="-1"></a>df_wdi_extra</span>
<span id="cb136-2"><a href="visualize.html#cb136-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 16,758 × 15</span></span>
<span id="cb136-3"><a href="visualize.html#cb136-3" tabindex="-1"></a><span class="co">#&gt;    country     iso2c iso3c  year status lastupdated lifeExp</span></span>
<span id="cb136-4"><a href="visualize.html#cb136-4" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;  &lt;date&gt;        &lt;dbl&gt;</span></span>
<span id="cb136-5"><a href="visualize.html#cb136-5" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan AF    AFG    2014 NA     2023-07-25     62.5</span></span>
<span id="cb136-6"><a href="visualize.html#cb136-6" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan AF    AFG    2012 NA     2023-07-25     61.9</span></span>
<span id="cb136-7"><a href="visualize.html#cb136-7" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan AF    AFG    2009 NA     2023-07-25     60.4</span></span>
<span id="cb136-8"><a href="visualize.html#cb136-8" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan AF    AFG    2013 NA     2023-07-25     62.4</span></span>
<span id="cb136-9"><a href="visualize.html#cb136-9" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan AF    AFG    1971 NA     2023-07-25     37.9</span></span>
<span id="cb136-10"><a href="visualize.html#cb136-10" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan AF    AFG    2015 NA     2023-07-25     62.7</span></span>
<span id="cb136-11"><a href="visualize.html#cb136-11" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan AF    AFG    1969 NA     2023-07-25     36.9</span></span>
<span id="cb136-12"><a href="visualize.html#cb136-12" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan AF    AFG    2010 NA     2023-07-25     60.9</span></span>
<span id="cb136-13"><a href="visualize.html#cb136-13" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan AF    AFG    2011 NA     2023-07-25     61.4</span></span>
<span id="cb136-14"><a href="visualize.html#cb136-14" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan AF    AFG    2008 NA     2023-07-25     59.9</span></span>
<span id="cb136-15"><a href="visualize.html#cb136-15" tabindex="-1"></a><span class="co">#&gt; # ℹ 16,748 more rows</span></span>
<span id="cb136-16"><a href="visualize.html#cb136-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 8 more variables: pop &lt;dbl&gt;, gdpPercap &lt;dbl&gt;,</span></span>
<span id="cb136-17"><a href="visualize.html#cb136-17" tabindex="-1"></a><span class="co">#&gt; #   region &lt;chr&gt;, capital &lt;chr&gt;, longitude &lt;dbl&gt;,</span></span>
<span id="cb136-18"><a href="visualize.html#cb136-18" tabindex="-1"></a><span class="co">#&gt; #   latitude &lt;dbl&gt;, income &lt;chr&gt;, lending &lt;chr&gt;</span></span></code></pre></div>
<p>違いはわかりましたか。同じような変数についてのデータですが、WDI からダウンロードした実際のデータの場合には、練習用のデータとは、違った困難がいくつもあります。それを、少しず見ていきながら、現実世界のデータを扱えるようにしていきましょう。</p>
</div>
</div>
</div>
<div id="コメント" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> コメント</h2>
<div id="参考文献-1" class="section level3" number="18.5.1">
<h3><span class="header-section-number">18.5.1</span> 参考文献</h3>
<ul>
<li><p>Cheat Sheet in RStudio: <a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a></p>
<ul>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/rstudio-ide.pdf">RStudio IED</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/main/base-r.pdf">Base R Cheat Sheet</a></li>
</ul></li>
<li><p>‘Quick R’ by DataCamp: <a href="https://www.statmethods.net/management" class="uri">https://www.statmethods.net/management</a></p></li>
<li><p><a href="https://cran.rstudio.com">An Introduction to R</a></p></li>
</ul>
</div>
</div>
<div id="練習-4" class="section level2" number="18.6">
<h2><span class="header-section-number">18.6</span> 練習</h2>
<div id="posit-primers-httpsposit.cloudlearnprimers" class="section level3" number="18.6.1">
<h3><span class="header-section-number">18.6.1</span> Posit Primers <a href="https://posit.cloud/learn/primers" class="uri">https://posit.cloud/learn/primers</a></h3>
<ol style="list-style-type: decimal">
<li>The Basics – <a href="https://r4ds.had.co.nz/explore-intro.html#explore-intro">r4ds: Explore, I</a></li>
</ol>
<ul>
<li><a href="https://rstudio.cloud/learn/primers/1.1">Visualization Basics</a></li>
<li><a href="https://rstudio.cloud/learn/primers/1.2">Programming Basics</a></li>
</ul>

</div>
</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>データサイエンスをはじめましょう<br />
- Data Science for All -</strong>" was written by 鈴木寛（Hirosi Suzuki）. It was last built on 2023-09-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
